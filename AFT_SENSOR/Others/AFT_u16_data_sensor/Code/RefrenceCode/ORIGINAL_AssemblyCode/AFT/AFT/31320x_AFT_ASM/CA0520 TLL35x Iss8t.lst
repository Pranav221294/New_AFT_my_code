MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001         TITLE     "PA240-16F1823 (c) 1/3/2011 P.R.GORTON"
                      00002         LIST      C=130,N=60
                      00003 
                      00004 ;*****************************************************************************;
                      00005 ; This program is protected as an unpublished work under the Copyright Act of ;
                      00006 ; 1975 & the Computer Program Act of 1980. It may not be copied or disclosed  ;
                      00007 ; to any third party without the express permission in writing of the author. ;
                      00008 ;*****************************************************************************;
                      00009 
  00000000            00010 SETFORTEST      EQU     0
  00000001            00011 SWAPPROBEPINS   EQU     1       ;0 = no change, 1 = swap pins
                      00012 
                      00013 ;Saved as : PA240 - 16F1823 V8m.asm
                      00014 ;Device/Oscillator : 16F1823/Ext.Osc 20MHz
                      00015 ;Last update : 20/10/11
                      00016 
                      00017 ;Notes: #1 normal PWM slowed to 4.88KHz
                      00018 ;#2 extra bits to allow manual testing of D.Resistive output from MPLab with PICkit3. REM out for norm
                            al use.
                      00019 ;V4 - CCPR1L set to zero in setup
                      00020 ;V5 - Use pulse frequency modulation for digistal resistive output ###3
                      00021 ;V6 - Level alarm output added ###4. OP pin not designated yet
                      00022 ;CV6 - For revision C of PCB - pins altered ###5
                      00023 ;CV7 - Use advanced setting for count and interval between samples ###6
                      00024 ;###7 use alarm OP to indicate calibration state
                      00025 ;CV8 start of conversion for 2 probe ###8
                      00026 ;###A correction
                      00027 ;Version 8b ###B calculated divisor y = mx -c (pointer at cal send out as zero).
                      00028 ;Version 8c ###C for use with 0V08 diagnostic software.
                      00029 ;Divisor at calibration now stored and sent out in diagnostic extrended EEPROM query with m, c & divis
                            or lower limit
                      00030 ;New EEPROM write routine for changing divisor calculation parameters 
                      00031 ;Version 8d - minor correction to send of divisor at calibration ###D
                      00032 ;Version 8e - calculation routines changed - variable names changed to suit 2 probe
                      00033 ;###9 no probe value calculation (P0)
                      00034 ;###10 calibration routines altered
                      00035 ;###11 changes to EE values sent
                      00036 ;temp boo
                      00037 ;Send params now 1 shot
                      00038 
                      00039 ;NOTE: DISABLE GETFALSEDATA FOR REAL TESTING & SET EE CALIBRATION DATA TO 0
                      00040 
                      00041 ;Disable done in version g onwards
                      00042 ;###h Alterations to averaging. If average<div@cal then use div@cal in P1 calcs.
                      00043 
                      00044 ;###m Controlled shift for TMR1U/H/L to speed up acquisition time
                      00045 ;###n no averaging if under 20% of calspan
                      00046 ;###p (no version o) default n changed to 2 from 4
                      00047 ;###q single probe version works like 2 probe version except that divisor is held at 1
                      00048 ;###r change to correct 'under empty' start up error
                      00049 ;when in D RESISTIVE mode the resistance multiplier is sent out instead of PWM
                      00050 ;###s negative check corrected
                      00051 ;###t modifications requested by Dave Burton
                      00052 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE  2
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00053 ;NOTE: MAKE RESISTIVE PWM SLOW TO CHANGE,
                      00054 
                      00055 
                      00056 ;Use MOVLB for BSR setting & MOVLP fOR PCLATH setting or use BANKSEL 'regname' to select bank & PAGESE
                            L 'routine name' to select page.
                      00057 
                      00058                 IFDEF __12F1822
                      00059         #INCLUDE P12F1822.INC           
                      00060         ENDIF
                      00061 
                      00062                 IFDEF __12L1822
                      00063         #INCLUDE P12LF1822.INC          
                      00064         ENDIF
                      00065 
                      00066                 IFDEF __16F1823
                      00067         #INCLUDE P16F1823.INC           
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC16F1823 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2013 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      01153         LIST
                      00068         ENDIF
                      00069         
                      00070                 IFDEF __16LF1823
                      00071         #INCLUDE P16L1823.INC           
                      00072         ENDIF
                      00073         
                      00074         
                      00075         
                      00076         ERRORLEVEL      1
                      00077 
                      00078 ;    __CONFIG _CONFIG1, _FOSC_ECH & _WDTE_ON & _PWRTE_ON & _MCLRE_ON & _CP_ON & _CPD_OFF & _BOREN_ON &
                             _CLKOUTEN_OFF & _IESO_OFF & _FCMEN_OFF
                      00079 ;    __CONFIG _CONFIG2, _WRT_ALL & _PLLEN_OFF & _STVREN_ON & _BORV_25 & _LVP_OFF
                      00080 
8007   0FA2           00081     __CONFIG _CONFIG1, _FOSC_HS & _WDTE_OFF & _PWRTE_OFF & _MCLRE_OFF & _CP_OFF & _CPD_OFF & _BOREN_ON
                             & _CLKOUTEN_OFF & _IESO_OFF & _FCMEN_OFF
8008   1EFF           00082     __CONFIG _CONFIG2, _WRT_OFF & _PLLEN_OFF & _STVREN_ON & _BORV_LO & _LVP_OFF
                      00083 
                      00084 
                      00085 ;register labels (20-7F + 0AF-0BF)
                      00086 
  00000020            00087 GENSTA0 EQU     20
  00000021            00088 FLASHER EQU     21
  00000022            00089 SWTIMER EQU     22
                      00090 
  00000023            00091 PWML    EQU     23
  00000024            00092 PWMH    EQU     24
  00000025            00093 PWMTEMP EQU     25
                      00094 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE  3
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000026            00095 DIVATCALL       EQU     26
  00000027            00096 DIVATCALH       EQU     27
                      00097 
  00000028            00098 AVDIVL_OVER20   EQU     28
  00000029            00099 AVDIVH_OVER20   EQU     29
                      00100 
  0000002A            00101 P1SPANATCALL    EQU     2A
  0000002B            00102 P1SPANATCALH    EQU     2B
                      00103 
  0000002C            00104 DIVUSEDL        EQU     2C      ;for diagnostics only
  0000002D            00105 DIVUSEDH        EQU     2D      ;for diagnostics only
                      00106 
  0000002F            00107 TEST    EQU     2F      ;for test only
                      00108 
  00000030            00109 TMR1U   EQU     30
  00000031            00110 TMR1UP1 EQU     31
  00000032            00111 TMR1HP1 EQU     32
  00000033            00112 TMR1LP1 EQU     33
  00000034            00113 TMR1UP2 EQU     34
  00000035            00114 TMR1HP2 EQU     35
  00000036            00115 TMR1LP2 EQU     36
  00000037            00116 TMR1UP0 EQU     37
  00000038            00117 TMR1HP0 EQU     38
  00000039            00118 TMR1LP0 EQU     39
                      00119 
  0000003A            00120 P1EMPTYL        EQU     3A
  0000003B            00121 P1EMPTYH        EQU     3B
                      00122 
  0000003C            00123 MULTCOUNT       EQU     3C
                      00124 
  0000003D            00125 TXCOUNT EQU     3D
  0000003E            00126 DELAY   EQU     3E
  0000003F            00127 TXBYTE  EQU     3F
                      00128 
  00000040            00129 AARGB0  EQU     40
  00000041            00130 AARGB1  EQU     41
  00000042            00131 AARGB2  EQU     42
  00000043            00132 AARGB3  EQU     43
                      00133 
  00000044            00134 DIVH    EQU     44
  00000045            00135 DIVL    EQU     45
                      00136 
  00000044            00137 M1H     EQU     44
  00000045            00138 M1L     EQU     45
                      00139 
  00000046            00140 REMB0   EQU     46
  00000047            00141 REMB1   EQU     47
                      00142 
  00000046            00143 M2H     EQU     46
  00000047            00144 M2L     EQU     47
                      00145 
  00000048            00146 MATHSTEMP       EQU     48
  00000049            00147 LOOPCOUNT       EQU     49
  0000004A            00148 OLOOPCOUNT      EQU     4A
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE  4
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00149 
  0000004B            00150 OPSPANHI        EQU     4B
  0000004C            00151 OPSPANLO        EQU     4C
  0000004D            00152 OPOFFSETHI      EQU     4D
  0000004E            00153 OPOFFSETLO      EQU     4E
  0000004F            00154 OPALARM EQU     4F
                      00155 
  00000050            00156 P2EMPTYL        EQU     50
  00000051            00157 P2EMPTYH        EQU     51
                      00158 
  00000052            00159 ALARMLEVHI      EQU     52
  00000053            00160 ALARMLEVLO      EQU     53
  00000054            00161 GENSTA1 EQU     54
                      00162 
  00000055            00163 CALCP1H EQU     55
  00000056            00164 CALCP1L EQU     56
  00000057            00165 CALCP2H EQU     57
  00000058            00166 CALCP2L EQU     58
                      00167 
  00000059            00168 CURRDIVH        EQU     59
  0000005A            00169 CURRDIVL        EQU     5A
  0000005B            00170 AVDIVU  EQU     5B
  0000005C            00171 AVDIVH  EQU     5C
  0000005D            00172 AVDIVL  EQU     5D
  0000005E            00173 AVREGU  EQU     5E
  0000005F            00174 AVREGH  EQU     5F
  00000060            00175 AVREGL  EQU     60
                      00176 
  00000061            00177 P0DFH   EQU     61
  00000062            00178 P0DFL   EQU     62
  00000063            00179 P0EMPTYL        EQU     63
  00000064            00180 P0EMPTYH        EQU     64
  00000065            00181 P1DFL   EQU     65
  00000066            00182 P1DFH   EQU     66
  00000067            00183 P2DFL   EQU     67
  00000068            00184 P2DFH   EQU     68
  00000069            00185 NAVCOUNT        EQU     69
  0000006A            00186 M12L    EQU     6A
  0000006B            00187 M12H    EQU     6B
  0000006C            00188 PROBE1H EQU     6C
  0000006D            00189 PROBE1L EQU     6D
                      00190 
  0000006E            00191 DIVATCAL97L     EQU     6E
  0000006F            00192 DIVATCAL97H     EQU     6F
                      00193 
                      00194 
                      00195 ;accessible from all banks (70-7F)
                      00196 
  00000070            00197 TASKFLAGS       equ     70
  00000071            00198 RXREG   EQU     71
  00000072            00199 RXTXCOUNT       EQU     72
  00000073            00200 FLAGS232        EQU     73
  00000074            00201 EEWRADDRESS     EQU     74
  00000075            00202 CALSTATUS       EQU     75
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE  5
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000076            00203 TYPE    EQU     76
                      00204 
  00000077            00205 ADVANCED        EQU     77
  00000078            00206 OPTCOUNT        EQU     78
                      00207 
  0000007E            00208 TEMPHI  EQU     7E
  0000007F            00209 TEMPLO  EQU     7F
                      00210 
                      00211 ;bank 1
                      00212 
  000000A0            00213 TIMEL   EQU     0A0
  000000A1            00214 TIMEH   EQU     0A1
  000000A2            00215 TIMEU   EQU     0A2
  000000A3            00216 TIMEUU  EQU     0A3
                      00217 
                      00218 ;definitions
                      00219 
                      00220 
                      00221 #DEFINE _C      STATUS,C
                      00222 
                      00223 #DEFINE ENABLEINT       INTCON,7
                      00224 
                      00225 #DEFINE INTDONE GENSTA0,0
                      00226 #DEFINE LCALWAIT        GENSTA0,1
                      00227 #DEFINE LCJUSTDONE      GENSTA0,2
                      00228 #DEFINE HCJUSTDONE      GENSTA0,3
                      00229 #DEFINE FAULT   GENSTA0,4
                      00230 #DEFINE DRESISTIVE      GENSTA0,5
                      00231 #DEFINE COMMSBEENON     GENSTA0,6
                      00232 #DEFINE OPREVERSE       GENSTA0,7       ;OP falls as level rises
                      00233 
                      00234 #DEFINE ALARMOPFLAG     GENSTA1,0       ;DO NOT MOVE!!!!
                      00235 #DEFINE ALARMONatHI     GENSTA1,1
                      00236 #DEFINE DRIFTNEG        GENSTA1,2
                      00237 #DEFINE SAVEFLAG        GENSTA1,3
                      00238 #DEFINE CDIVISLOW       GENSTA1,4       ;current division below div@cal
                      00239 #DEFINE OVER20PCCSPAN   GENSTA1,5
                      00240 #DEFINE SAVEINDICATOR   GENSTA1,6
                      00241 
                      00242 #DEFINE EMPTYCAL        CALSTATUS,0
                      00243 #DEFINE SPANCAL CALSTATUS,1
                      00244 
                      00245 #DEFINE ALARMOP PORTC,4 ;was PORTA,1 ###5
                      00246 
                      00247         IF      (SWAPPROBEPINS==0)
                      00248 #DEFINE ENPROBE PORTC,2 ;was 4 ###5
                      00249 #DEFINE ENREF_P2        PORTC,3
                      00250         ELSE
                      00251 #DEFINE ENPROBE PORTC,3
                      00252 #DEFINE ENREF_P2        PORTC,2
                      00253         ENDIF
                      00254 
                      00255 #DEFINE WRITE232        FLAGS232,0
                      00256 #DEFINE READ232 FLAGS232,1      
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE  6
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00257 #DEFINE GOTADDR FLAGS232,2
                      00258 
                      00259 #DEFINE GETTINGP0       TASKFLAGS,0
                      00260 #DEFINE GETTINGP1       TASKFLAGS,1
                      00261 #DEFINE GETTINGP2       TASKFLAGS,2
                      00262 #DEFINE T0COUNTING      TASKFLAGS,3
                      00263 #DEFINE T0WAITSTART     TASKFLAGS,4
                      00264 #DEFINE SENDPARAMS      TASKFLAGS,5
                      00265 
                      00266 #DEFINE TWOPROBE        ADVANCED,7
                      00267 
                      00268 ;constants
                      00269 
                      00270 
  000F4240            00271 boo     equ     .1000000
                      00272 
                      00273 ;BANK0 REGISTER SETTING
                      00274 
  000000C0            00275 INTCONset       EQU     B'11000000'
  00000001            00276 T1CONset        EQU     B'00000001'
  00000000            00277 T1GCONset       EQU     B'0'
  00000000            00278 PR2set  EQU     B'0'
  00000004            00279 T2CONsetPS1     EQU     B'00000100'             ;prescale 1, postscale 1
  00000005            00280 T2CONsetPS4     EQU     B'00000101'             ;prescale 4, postscale 1
  00000006            00281 T2CONsetPS16    EQU     B'00000110'             ;prescale 16, postscale 1
  00000007            00282 T2CONsetPS64    EQU     B'00000111'             ;prescale 64, postscale 1
  00000000            00283 CPSCON0set      EQU     B'0'
  00000000            00284 CPSCON1set      EQU     B'0'
                      00285 
                      00286 ;BANK1 REGISTER SETTING
                      00287 
  000000FE            00288 TRISAset        EQU             B'11111110'
                      00289 
  000000C3            00290 TRISCset        EQU     B'11000011'
                      00291 
  00000001            00292 PIE1set EQU     B'00000001'
  00000000            00293 PIE2set EQU     B'0'
                      00294 
  00000060            00295 OPTsetPS2       EQU     B'01100000'             ;pull up on. TMR0 PS=2
  00000061            00296 OPTsetPS4       EQU     B'01100001'             ;pull up on. TMR0 PS=4
  00000062            00297 OPTsetPS8       EQU     B'01100010'             ;pull up on. TMR0 PS=8
  00000063            00298 OPTsetPS16      EQU     B'01100011'             ;pull up on. TMR0 PS=16
  00000064            00299 OPTsetPS32      EQU     B'01100100'             ;pull up on. TMR0 PS=32
  00000065            00300 OPTsetPS64      EQU     B'01100101'             ;pull up on. TMR0 PS=64
  00000066            00301 OPTsetPS128     EQU     B'01100110'             ;pull up on. TMR0 PS=128
  00000067            00302 OPTsetPS512     EQU     B'01100111'             ;pull up on. TMR0 PS=256
                      00303 
  00000060            00304 OPTsetT0wait    EQU     B'01100000'             ;pull up on. TMR0 PS=2
  00000010            00305 PCONset EQU     B'00010000'             ;BOR enabled
  0000001C            00306 WDTCONset       EQU     B'00011100'             ;1:2^19 (16S)
                      00307 
  00000070            00308 OSCCONset       EQU     B'01110000'             ;8MHz
                      00309 
  00000000            00310 ADCON0set       EQU     B'0'
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE  7
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000011            00311 ADCON0setRV     EQU     B'00010001'
  000000A0            00312 ADCON1set       EQU     B'10100000'
                      00313 
                      00314 ;BANK2 REGISTER SETTING
                      00315 
  00000000            00316 CM1CON0set      EQU     B'0'
  00000000            00317 CM1CON1set      EQU     B'0'
  00000000            00318 CM2CON0set      EQU     B'0'
  00000000            00319 CM2CON1set      EQU     B'0'
                      00320 
  00000000            00321 BORCONset       EQU     B'0'
  00000000            00322 FVRCONset       EQU     B'0'
  00000000            00323 DACCON0set      EQU     B'0'
  00000000            00324 DACCON1set      EQU     B'0'
  00000000            00325 SRCON0set       EQU     B'0'
  00000000            00326 SRCON1set       EQU     B'0'
                      00327 
  00000084            00328 APFCONset       EQU     B'10000100'
                      00329 
                      00330 
                      00331 ;BANK3 REGISTER SETTING
                      00332 
  00000000            00333 ANSELAset       EQU     B'0'
                      00334         
  00000001            00335 ANSELCset       EQU     B'00000001'
                      00336 
  00000000            00337 EECON1set       EQU     B'0'
  00000000            00338 EECON2set       EQU     B'0'
                      00339 
  00000008            00340 SPBRGLset       EQU     LOW .520
  00000002            00341 SPBRGHset       EQU     HIGH .520
                      00342 
  00000090            00343 RCSTAset        EQU     B'10010000'
  00000024            00344 TXSTAset        EQU     B'00100100'
  00000008            00345 BAUDCONset      EQU     B'00001000'
                      00346 
                      00347 ;BANK4 REGISTER SETTING
                      00348 
  00000003            00349 WPUAset EQU     B'00000011'
                      00350 
  00000000            00351 WPUCset EQU     B'0'
                      00352 
  00000000            00353 SSP1ADDset      EQU     B'0'
  00000000            00354 SSP1MSKset      EQU     B'0'
                      00355 
  00000000            00356 SSP1STATset     EQU     B'0'
  00000000            00357 SSP1CON1set     EQU     B'0'
  00000000            00358 SSP1CON2set     EQU     B'0'
  00000000            00359 SSP1CON3set     EQU     B'0'
                      00360 
                      00361 ;BANK5 REGISTER SETTING
                      00362 
  0000000C            00363 CCP1CONset      EQU     B'00001100'
  00000000            00364 PWM1CONset      EQU     B'0'
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE  8
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000000            00365 CCP1AScon       EQU     B'0'
  00000001            00366 PSTR1CONset     EQU     B'00000001'
                      00367 
                      00368 ;BANK6 REGISTER SETTING
                      00369 
                      00370 ;BANK7 REGISTER SETTING
                      00371 
  00000000            00372 IOCAPset        EQU     B'0'
  00000000            00373 IOCANset        EQU     B'0'
                      00374 
  00000000            00375 CLRKRCON        EQU     B'0'
                      00376 
  00000000            00377 MDCONset        EQU     B'0'
  00000000            00378 MDSRCset        EQU     B'0'
  00000000            00379 MDCARLset       EQU     B'0'
  00000000            00380 MDCARHset       EQU     B'0'
                      00381 
                      00382 ;general constants
                      00383 
  00000000            00384 LSB     EQU     .0
  00000007            00385 MSB             EQU             .7
                      00386 
                      00387         IF      (SWAPPROBEPINS==0)
                      00388 enP1    EQU     B'00000100'
                      00389 enref_P2        EQU     B'00001000'
                      00390         ELSE
  00000008            00391 enP1    EQU     B'00001000'
  00000004            00392 enref_P2        EQU     B'00000100'
                      00393         ENDIF
                      00394 
  00000001            00395 emptydone       EQU     B'00000001'
  00000003            00396 spandone        EQU     B'00000011'
                      00397 
  00000000            00398 lowoffset       EQU     .0
  00000000            00399 minpwm  EQU     .0
  00000000            00400 uncalpwm        EQU     .0      ;.512
  00000004            00401 tmr1shift       EQU     .4
                      00402 
  00000006            00403 ADwait  EQU     .6      ;uSec @ 20MHz
                      00404 
                      00405 ;fudge factors
                      00406 
  00000166            00407 defp1df EQU     .358    ;1.40 x 2^8 ###t was 1.45
  0000010D            00408 defp2df EQU     .269    ;1.05 x 2^8
  00000002            00409 defaultn        EQU     .2
                      00410 
  0000E666            00411 const1          EQU     .58982  ;(14.4 x 2^12) ###t was 13
  0000711F            00412 const2  EQU     .28959  ;(7.07 x 2^12)rounded up ###t was 4.726
  000064D0            00413 const3  EQU     .25808  ;(6.3 x 2^12)rounded up ###t was 7.43
                      00414 
  00000010            00415 onepdivH        EQU     HIGH .4096      ;2^12
  00000000            00416 onepdivL        EQU     LOW .4096
                      00417 
                      00418 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE  9
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00419 ;EE Addresses
                      00420 
  00000001            00421 calstatus       EQU     .1
  00000002            00422 P1emptyL        EQU     .2
  00000003            00423 P1emptyH        EQU     .3
  00000004            00424 P2emptyL        EQU     .4
  00000005            00425 P2emptyH        EQU     .5
  00000006            00426 P0emptyL        EQU     .6
  00000007            00427 P0emptyH        EQU     .7
                      00428 
  00000008            00429 P1fullL EQU     .8
  00000009            00430 P1fullH EQU     .9
  0000000A            00431 P2fullL EQU     .10
  0000000B            00432 P2fullH EQU     .11
                      00433 
  0000000C            00434 caldiv12L       EQU     .12
  0000000D            00435 caldiv12H       EQU     .13
                      00436 
  0000000E            00437 P1calspanL      EQU     .14
  0000000F            00438 P1calspanH      EQU     .15
                      00439 
  00000010            00440 m12L    EQU     .16
  00000011            00441 m12H    EQU     .17
                      00442 
  00000012            00443 currdiv12L      EQU     .18
  00000013            00444 currdiv12H      EQU     .19
                      00445 
  00000023            00446 type    EQU     .35
  00000024            00447 OPspanH EQU     .36
  00000025            00448 OPspanL EQU     .37
  00000026            00449 OPminoffsetH    EQU     .38
  00000027            00450 OPminoffsetL    EQU     .39
  00000028            00451 OPalarmH        EQU     .40
  00000029            00452 OPalarmL        EQU     .41
  0000002A            00453 advanced        EQU     .42
                      00454 
  00000032            00455 P1dfL   EQU     .50
  00000033            00456 P1dfH   EQU     .51
  00000034            00457 P2dfL   EQU     .52
  00000035            00458 P2dfH   EQU     .53
  00000036            00459 n_av    EQU     .54
                      00460 
                      00461 
                      00462 
                      00463 ;power up entry *************************************************************
                      00464 
0000                  00465         ORG     00
                      00466 
                      00467         PAGESEL         CSTART
                      00468         PAGESEL CSTART
0000   2CA3           00469         GOTO            CSTART  ; When using debug header, first inst.
                      00470                                 ; may be passed over by ICD2.
0001   2CA3           00471         GOTO            CSTART
                      00472 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 10
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00473 
                      00474 ;interrupt vector ***********************************************************
                      00475 
                      00476 ; Note the 16F1826/27 family automatically handles context restoration for 
                      00477 ; W, STATUS, BSR, FSR, and PCLATH
                      00478 
0004                  00479         ORG       04
                      00480         
0004   0020           00481         BANKSEL 0       
0005   19F0           00482         BTFSC   T0COUNTING
0006   1D0B           00483         BTFSS   INTCON,TMR0IF
0007   2819           00484         GOTO    NOTT0INT        
0008   1018           00485         BCF     T1CON,TMR1ON    ;stop timer     
                      00486 
0009   1811           00487         BTFSC   PIR1,TMR1IF     ;check for overflow
000A   0AB0           00488         INCF    TMR1U   
000B   11F0           00489         BCF     T0COUNTING
                      00490 
000C   128B           00491         BCF     INTCON,TMR0IE   ;disable interrupt      ;###m moved
000D   247C           00492         CALL    ADDTOTIMEp                      ;###m moved
                      00493 
000E   2470           00494         CALL    TIMESHIFT                       ;###m new
                      00495 
000F   18F0           00496         BTFSC   GETTINGP1
0010   2345           00497         CALL    TRANSFERP1
0011   1970           00498         BTFSC   GETTINGP2
0012   2334           00499         CALL    TRANSFERP2
0013   1870           00500         BTFSC   GETTINGP0
0014   2354           00501         CALL    TRANSFERP0
                      00502 
                      00503 ;       BCF     INTCON,TMR0IE   ;disable interrupt      ;###m
                      00504 ;       CALL    ADDTOTIMEp                      ;###m
                      00505                 
0015   1C11           00506         BTFSS   PIR1,TMR1IF
0016   2882           00507         GOTO    INTENDNOFLAG
0017   1011           00508         BCF     PIR1,TMR1IF
0018   287F           00509         GOTO    INTEND
                      00510 
0019   1011           00511 NOTT0INT        BCF     PIR1,TMR1IF
001A   19F0           00512         BTFSC   T0COUNTING
001B   0AB0           00513         INCF    TMR1U
001C   1DF0           00514         BTFSS   T0COUNTING
001D   2497           00515         CALL    ADDTOTIMEt
                      00516         
001E   08F2           00517 COMMSTIMEOUT    TSTF    RXTXCOUNT
001F   1D03           00518         SKPZ
0020   03F2           00519         DECF    RXTXCOUNT
                      00520 
0021   1A91           00521 COMMTEST        BTFSC   PIR1,RCIF
0022   283D           00522         GOTO    DOCOMMS
                      00523 
0023   1E70           00524         BTFSS   T0WAITSTART     ;ready to start cycle?
0024   287F           00525         GOTO    INTEND  ;no
                      00526         
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 11
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0025   1018           00527 T0SYNCH BCF     T1CON,TMR1ON            ;stop TMR1
0026   0196           00528         CLRF    TMR1L
0027   0197           00529         CLRF    TMR1H
0028   01B0           00530         CLRF    TMR1U
                      00531 
0029   3095           00532         MOVLW   LOW OPTION_REG  ;for INDF0
002A   0084           00533         MOVWF   FSR0L
002B   3000           00534         MOVLW   HIGH OPTION_REG
002C   0085           00535         MOVWF   FSR0H
                      00536 
002D   3060           00537         MOVLW   OPTsetT0wait
002E   0080           00538         MOVWF   INDF0
                      00539         
002F   30FF           00540         MOVLW   0FF
0030   0095           00541         MOVWF   TMR0
0031   110B           00542         BCF     INTCON,TMR0IF
0032   1D0B           00543         BTFSS   INTCON,T0IF
0033   2832           00544         GOTO    ($-1)   ;loop until rollover
                      00545 ;       MOVLW   OPTset  ;ready
0034   0878           00546         MOVFW   OPTCOUNT        ;###6
0035   0195           00547         CLRF    TMR0    ;clear timer
0036   0080           00548         MOVWF   INDF0   ;change prescale
0037   1418           00549         BSF     T1CON,TMR1ON    ;start TMR1
0038   110B           00550         BCF     INTCON,TMR0IF   ;clear flag
0039   168B           00551         BSF     INTCON,TMR0IE   ;enable interrupt
003A   1270           00552         BCF     T0WAITSTART     ;signal wait over
003B   15F0           00553         BSF     T0COUNTING      ;signal T0 running
003C   287F           00554         GOTO    INTEND  ;exit
                      00555 
003D   1720           00556 DOCOMMS BSF     COMMSBEENON     ;signal comms activity - no PWM update
                      00557 
003E   0023           00558         BANKSEL RCREG
003F   0819           00559         MOVFW   RCREG
0040   0020           00560         BANKSEL 0
0041   00F1           00561         MOVWF   RXREG
0042   12F0           00562         BCF     SENDPARAMS      ;flag off
                      00563 
0043   08F2           00564         TSTF    RXTXCOUNT
0044   1D03 2866      00565         BNZ     PROCESS232
0046   01F3           00566         CLRF    FLAGS232
                      00567 
0047   0871           00568 WRITECHECK      MOVFW   RXREG
0048   3AAA           00569         XORLW   .170    ;is it 170 (write)
0049   1D03 2851      00570         BNZ     READCHECK
004B   0971           00571 WRITESTART      COMF    RXREG,W
004C   2098           00572         CALL    SENDTXW ;send back inverted
004D   1473           00573         BSF     WRITE232
004E   300B           00574         MOVLW   .11
004F   00F2           00575         MOVWF   RXTXCOUNT
0050   287F           00576         GOTO    INTEND
                      00577 
0051   0871           00578 READCHECK       MOVFW   RXREG
0052   3A55           00579         XORLW   .85     ;is it 85 (read)
0053   1D03 285B      00580         BNZ     DIAGNCHECK
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 12
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0055   0971           00581 READSTART       COMF    RXREG,W
0056   2098           00582         CALL    SENDTXW ;send back inverted
0057   14F3           00583         BSF     READ232
0058   300B           00584         MOVLW   .11     ;WAS 11
0059   00F2           00585         MOVWF   RXTXCOUNT
005A   287F           00586         GOTO    INTEND
                      00587 
005B   0871           00588 DIAGNCHECK      MOVFW   RXREG
005C   3AA5           00589         XORLW   0A5     ;is it 0A5 (get P1/P2/PWM)
005D   1D03 2861      00590         BNZ     GETEESTORE
005F   16F0           00591         BSF     SENDPARAMS      ;flag to send at every update   
0060   287F           00592         GOTO    INTEND
                      00593 
0061   0871           00594 GETEESTORE      MOVFW   RXREG
0062   3A5A           00595         XORLW   05A     ;is it 05A (get EEstore)
0063   1903           00596         SKPNZ
0064   209E           00597         CALL    SENDEESTORE
0065   287F           00598         GOTO    INTEND
                      00599 
0066   3005           00600 PROCESS232      MOVLW   .5      ;was 5
0067   00F2           00601         MOVWF   RXTXCOUNT
                      00602 
0068   1873           00603         BTFSC   WRITE232
0069   286E           00604         GOTO    WRITE232DO
006A   0871           00605 READ232DO       MOVFW   RXREG   ;address
006B   2150           00606         CALL    EEREADADRW
006C   2098           00607         CALL    SENDTXW ;send back data
006D   287F           00608         GOTO    INTEND
                      00609 
                      00610 
006E   1973           00611 WRITE232DO      BTFSC   GOTADDR
006F   2877           00612         GOTO    WRITE232DOa
0070   0871           00613         MOVFW   RXREG
0071   00F4           00614         MOVWF   EEWRADDRESS
0072   0971           00615         COMF    RXREG,W
0073   2098           00616         CALL    SENDTXW ;send address back inverted     
                      00617         ;DECF   RXREG,W ;allows use of EEWRITEWNEXT
                      00618         ;BANKSEL        EEADRL
                      00619         ;MOVLW  .31
                      00620         ;MOVWF  EEADRL
0074   0020           00621         BANKSEL 0
0075   1573           00622         BSF     GOTADDR
0076   287F           00623         GOTO    INTEND
                      00624 
0077   0871           00625 WRITE232DOa     MOVFW   RXREG
0078   2160           00626         CALL    EEWRITEW
0079   0023           00627         BANKSEL EEDATL
007A   0993           00628         COMF    EEDATL  ;invert for test to see if it's restored
007B   0020           00629         BANKSEL 0
                      00630         
007C   2152           00631         CALL    EEREADSAME
007D   2098           00632         CALL    SENDTXW ;send EE data back
007E   0AF4           00633         INCF    EEWRADDRESS     ;next
                      00634 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 13
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007F                  00635 MAININT
                      00636         
                      00637         
                      00638         
007F   0AA1           00639 INTEND  INCF    FLASHER
0080   0020           00640         BANKSEL 0
0081   1420           00641         BSF     INTDONE
0082   1418           00642 INTENDNOFLAG    BSF     T1CON,TMR1ON    ;make sure timer running        
0083   0009           00643         RETFIE  
                      00644         
                      00645 
                      00646 ;tables/vectors *************************************************************
                      00647 
0084   0877           00648 COUNTTABLE      MOVFW   ADVANCED        ;all ###6
0085   3907           00649         ANDLW   B'00000111'
0086   0782           00650         ADDWF   PCL
0087   3460           00651         RETLW   OPTsetPS2
0088   3461           00652         RETLW   OPTsetPS4
0089   3462           00653         RETLW   OPTsetPS8
008A   3463           00654         RETLW   OPTsetPS16
008B   3464           00655         RETLW   OPTsetPS32
008C   3465           00656         RETLW   OPTsetPS64
008D   3466           00657         RETLW   OPTsetPS128
008E   3467           00658         RETLW   OPTsetPS512
                      00659 
008F   0E77           00660 INTERVALTABLE   SWAPF   ADVANCED,W      ;all ###6
0090   3903           00661         ANDLW   B'00000011'
0091   0782           00662         ADDWF   PCL
0092   341F           00663         RETLW   B'00011111'
0093   343F           00664         RETLW   B'00111111'
0094   347F           00665         RETLW   B'01111111'
0095   34FF           00666         RETLW   B'11111111'
                      00667 
                      00668 ;subroutines ****************************************************************
                      00669 
0096   1EF0           00670 TESTSENDTXW     BTFSS   SENDPARAMS
0097   0008           00671         RETURN
                      00672 
0098   1E11           00673 SENDTXW BTFSS   PIR1,TXIF       ;high if empty
0099   2898           00674         GOTO    ($-1)   ;loop is not empty
009A   0023           00675         BANKSEL TXREG
009B   009A           00676         MOVWF   TXREG
009C   0020           00677         BANKSEL 0
009D   0008           00678         RETURN
                      00679 
009E   3001           00680 SENDEESTORE     MOVLW   calstatus       ;###11 additions/notes
009F   2150           00681         CALL    EEREADADRW
00A0   2098           00682         CALL    SENDTXW ;calstat
00A1   214E           00683         CALL    EEREADNEXT
00A2   2098           00684         CALL    SENDTXW ;p1ecalL
00A3   214E           00685         CALL    EEREADNEXT
00A4   2098           00686         CALL    SENDTXW ;p1ecalH
00A5   214E           00687         CALL    EEREADNEXT
00A6   2098           00688         CALL    SENDTXW ;p2ecalL
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 14
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00A7   214E           00689         CALL    EEREADNEXT
00A8   2098           00690         CALL    SENDTXW ;p2ecalH
00A9   214E           00691         CALL    EEREADNEXT
00AA   2098           00692         CALL    SENDTXW ;p0calL
00AB   214E           00693         CALL    EEREADNEXT
00AC   2098           00694         CALL    SENDTXW ;p0calH
00AD   214E           00695         CALL    EEREADNEXT
00AE   2098           00696         CALL    SENDTXW ;p1fcalL
00AF   214E           00697         CALL    EEREADNEXT
00B0   2098           00698         CALL    SENDTXW ;p1fcalH
00B1   214E           00699         CALL    EEREADNEXT
00B2   2098           00700         CALL    SENDTXW ;p2fcalL
00B3   214E           00701         CALL    EEREADNEXT
00B4   2098           00702         CALL    SENDTXW ;p2fcalH        
00B5   214E           00703         CALL    EEREADNEXT      
00B6   2098           00704         CALL    SENDTXW ;divcalL
00B7   214E           00705         CALL    EEREADNEXT      
00B8   2098           00706         CALL    SENDTXW ;divcalH
00B9   214E           00707         CALL    EEREADNEXT      
00BA   2098           00708         CALL    SENDTXW ;spancalL
00BB   214E           00709         CALL    EEREADNEXT      
00BC   2098           00710         CALL    SENDTXW ;spancalH
                      00711 
00BD   3032           00712         MOVLW   P1dfL   ;sends five bytes of calculation parameters
00BE   2150           00713         CALL    EEREADADRW
00BF   2098           00714         CALL    SENDTXW ;p1dfL
00C0   214E           00715         CALL    EEREADNEXT
00C1   2098           00716         CALL    SENDTXW ;p1dfH
00C2   214E           00717         CALL    EEREADNEXT
00C3   2098           00718         CALL    SENDTXW ;p2dfL
00C4   214E           00719         CALL    EEREADNEXT
00C5   2098           00720         CALL    SENDTXW ;p2dfH
00C6   214E           00721         CALL    EEREADNEXT
00C7   2098           00722         CALL    SENDTXW ;n
                      00723         
00C8   3012           00724         MOVLW   currdiv12L
00C9   2150           00725         CALL    EEREADADRW
00CA   2098           00726         CALL    SENDTXW ;currdiv12L
00CB   214E           00727         CALL    EEREADNEXT
00CC   2098           00728         CALL    SENDTXW ;currdiv12H
                      00729                 
00CD   0008           00730         RETURN
                      00731         
00CE   3004           00732 T2SETUP MOVLW   T2CONsetPS1
00CF   1A76           00733         BTFSC   TYPE,4  ;ResD1
00D0   3005           00734         MOVLW   T2CONsetPS4
00D1   1AF6           00735         BTFSC   TYPE,5  ;ResD2
00D2   3006           00736         MOVLW   T2CONsetPS16
00D3   1B76           00737         BTFSC   TYPE,6  ;ResD3
00D4   3007           00738         MOVLW   T2CONsetPS64
00D5   009C           00739         MOVWF   T2CON   ;setup T2
00D6   0008           00740         RETURN
                      00741 
00D7                  00742 SETUP
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 15
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00D7   0020           00743 SETUPB0 MOVLB   0       ;set bank 0
00D8   30C0           00744         MOVLW   INTCONset       
00D9   008B           00745         MOVWF   INTCON
00DA   3001           00746         MOVLW   T1CONset        
00DB   0098           00747         MOVWF   T1CON   
00DC   3000           00748         MOVLW   T1GCONset       
00DD   0099           00749         MOVWF   T1GCON  
00DE   3000           00750         MOVLW   PR2set  
00DF   009B           00751         MOVWF   PR2     
                      00752 ;       MOVLW   T2CONsetPS4     ;#1     
00E0   3000           00753         MOVLW   0
00E1   009C           00754         MOVWF   T2CON   
00E2   3000           00755         MOVLW   CPSCON0set      
00E3   009E           00756         MOVWF   CPSCON0 
00E4   3000           00757         MOVLW   CPSCON1set      
00E5   009F           00758         MOVWF   CPSCON1 
                      00759 
                      00760 
00E6   0021           00761 SETUPB1 MOVLB   .1      ;bank 1
00E7   30FE           00762         MOVLW   TRISAset        
00E8   008C           00763         MOVWF   TRISA
                      00764 
                      00765         IFDEF __16F1823
00E9   30C3           00766         MOVLW   TRISCset 
00EA   008E           00767         MOVWF   TRISC
                      00768         ENDIF
                      00769         
                      00770         IFDEF __16LF1823
                      00771         MOVLW   TRISCset 
                      00772         MOVWF   TRISC
                      00773         ENDIF
                      00774                 
00EB   3001           00775         MOVLW   PIE1set
00EC   0091           00776         MOVWF   PIE1
00ED   3000           00777         MOVLW   PIE2set
00EE   0092           00778         MOVWF   PIE2
                      00779 
00EF   3065           00780         MOVLW   OPTsetPS64      
00F0   0095           00781         MOVWF   OPTION_REG
                      00782         
00F1   3010           00783         MOVLW   PCONset
00F2   0096           00784         MOVWF   PCON
00F3   301C           00785         MOVLW   WDTCONset
00F4   0097           00786         MOVWF   WDTCON
00F5   3070           00787         MOVLW   OSCCONset
00F6   0099           00788         MOVWF   OSCCON
00F7   3000           00789         MOVLW   ADCON0set
00F8   009D           00790         MOVWF   ADCON0
00F9   30A0           00791         MOVLW   ADCON1set
00FA   009E           00792         MOVWF   ADCON1
                      00793 
                      00794 
00FB   0022           00795 SETUPB2 MOVLB   .2      ;bank 2 
00FC   3000           00796         MOVLW   CM1CON0set
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 16
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00FD   0091           00797         MOVWF   CM1CON0
00FE   3000           00798         MOVLW   CM1CON1set
00FF   0092           00799         MOVWF   CM1CON1 
                      00800         
                      00801         IFDEF __16F1823
0100   3000           00802         MOVLW   CM2CON0set      
0101   0093           00803         MOVWF   CM2CON0
0102   3000           00804         MOVLW   CM2CON1set
0103   0094           00805         MOVWF   CM2CON1
                      00806         ENDIF
                      00807 
                      00808         IFDEF __16LF1823
                      00809         MOVLW   CM2CON0set      
                      00810         MOVWF   CM2CON0
                      00811         MOVLW   CM2CON1set
                      00812         MOVWF   CM2CON1
                      00813         ENDIF
                      00814 
0104   3000           00815         MOVLW   BORCONset
0105   0096           00816         MOVWF   BORCON
0106   3000           00817         MOVLW   FVRCONset
0107   0097           00818         MOVWF   FVRCON
0108   3000           00819         MOVLW   DACCON0set
0109   0098           00820         MOVWF   DACCON0
010A   3000           00821         MOVLW   DACCON1set
010B   0099           00822         MOVWF   DACCON1
010C   3000           00823         MOVLW   SRCON0set
010D   009A           00824         MOVWF   SRCON0
010E   3000           00825         MOVLW   SRCON1set
010F   009B           00826         MOVWF   SRCON1
                      00827         
0110   3084           00828         MOVLW   APFCONset
0111   009D           00829         MOVWF   APFCON
                      00830         
0112   0023           00831 SETUPB3 MOVLB   .3      ;bank 3
0113   3000           00832         MOVLW   ANSELAset
0114   008C           00833         MOVWF   ANSELA
                      00834 
                      00835         IFDEF __16F1823
0115   3001           00836         MOVLW   ANSELCset
0116   008E           00837         MOVWF   ANSELC
                      00838         ENDIF
                      00839 
                      00840         IFDEF __16LF1823
                      00841         MOVLW   ANSELCset
                      00842         MOVWF   ANSELC
                      00843         ENDIF
                      00844 
0117   3000           00845         MOVLW   EECON1set
0118   0095           00846         MOVWF   EECON1
0119   3000           00847         MOVLW   EECON2set
011A   0096           00848         MOVWF   EECON2
011B   3008           00849         MOVLW   SPBRGLset
011C   009B           00850         MOVWF   SPBRGL
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 17
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

011D   3002           00851         MOVLW   SPBRGHset
011E   009C           00852         MOVWF   SPBRGH
011F   3090           00853         MOVLW   RCSTAset
0120   009D           00854         MOVWF   RCSTA
0121   3024           00855         MOVLW   TXSTAset
0122   009E           00856         MOVWF   TXSTA
0123   3008           00857         MOVLW   BAUDCONset
0124   009F           00858         MOVWF   BAUDCON
                      00859 
0125   0024           00860 SETUPB4 MOVLB   .4      ;bank 4
0126   3003           00861         MOVLW   WPUAset
0127   008C           00862         MOVWF   WPUA
                      00863 
                      00864         IFDEF __16F1823
0128   3000           00865         MOVLW   WPUCset
0129   008E           00866         MOVWF   WPUC
                      00867         ENDIF
                      00868         
                      00869         IFDEF __16LF1823
                      00870         MOVLW   WPUCset
                      00871         MOVWF   WPUC
                      00872         ENDIF
                      00873 
                      00874 
012A   3000           00875         MOVLW   SSP1ADDset
012B   0092           00876         MOVWF   SSP1ADD
012C   3000           00877         MOVLW   SSP1MSKset
012D   0093           00878         MOVWF   SSP1MSK
                      00879 
012E   3000           00880         MOVLW   SSP1STATset
012F   0094           00881         MOVWF   SSP1STAT
0130   3000           00882         MOVLW   SSP1CON1set
0131   0095           00883         MOVWF   SSP1CON1
0132   3000           00884         MOVLW   SSP1CON2set
0133   0096           00885         MOVWF   SSP1CON2
0134   3000           00886         MOVLW   SSP1CON3set
0135   0097           00887         MOVWF   SSP1CON3
                      00888 
                      00889 
0136   0025           00890 SETUPB5 MOVLB   .5      ;bank 5
0137   0191           00891         CLRF    CCPR1L
0138   300C           00892         MOVLW   CCP1CONset
0139   0093           00893         MOVWF   CCP1CON
013A   3000           00894         MOVLW   PWM1CONset
013B   0094           00895         MOVWF   PWM1CON
013C   3000           00896         MOVLW   CCP1AScon
013D   0095           00897         MOVWF   CCP1AS
013E   3001           00898         MOVLW   PSTR1CONset
013F   0096           00899         MOVWF   PSTR1CON
0140   0191           00900                 CLRF    CCPR1L
                      00901 ;no SETUPB6     
                      00902 
0141   0027           00903 SETUPB7 MOVLB   .7      ;bank 7
0142   3000           00904         MOVLW   IOCAPset
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 18
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0143   0091           00905         MOVWF   IOCAP
0144   3000           00906         MOVLW   IOCANset
0145   0092           00907         MOVWF   IOCAN
                      00908 
0146   0020           00909         MOVLB   0       ;bank 0
0147   0008           00910         RETURN
                      00911 
0148   0196           00912 INITMR1 CLRF    TMR1L
0149   0197           00913         CLRF    TMR1H
014A   3001           00914         MOVLW   T1CONset
014B   0098           00915         MOVWF   T1CON
014C   1011           00916         BCF     PIR1,TMR1IF
014D   0008           00917         RETURN
                      00918 
014E                  00919 EEREADNEXT      
014E   0023           00920         BANKSEL EEADRL
014F   0A11           00921         INCF    EEADRL,W
0150                  00922 EEREADADRW                      ;get data from EEPROM, addr in W
0150   0023           00923         BANKSEL EEADRL
0151   0091           00924         MOVWF   EEADRL
                      00925         
0152                  00926 EEREADSAME
0152   0023           00927         BANKSEL EECON1
0153   1895           00928         BTFSC   EECON1,WR
0154   2953           00929         GOTO    ($-1)
0155   0193           00930         CLRF    EEDATL  ;
0156   1315           00931         BCF     EECON1,CFGS
0157   1395           00932         BCF     EECON1,EEPGD
0158   1415           00933         BSF     EECON1,RD
0159   0813           00934         MOVFW   EEDATL  ;result in W
015A   0020           00935         BANKSEL 0
015B   0008           00936         RETURN
                      00937 
                      00938 
015C                  00939 EEWRITEWNEXT    
015C   0023           00940         BANKSEL EECON1
015D   0093           00941         MOVWF   EEDATL
015E   0A91           00942         INCF    EEADRL
015F   2964           00943         GOTO    EEWRSETUP
                      00944 
0160                  00945 EEWRITEW                        ;data in W, address in EEWRADDRESS
0160   0023           00946         BANKSEL EECON1
0161   0093           00947         MOVWF   EEDATL  
0162   0874           00948         MOVFW   EEWRADDRESS
0163   0091           00949         MOVWF   EEADRL
                      00950 
0164   1895           00951 EEWRSETUP       BTFSC   EECON1,WR
0165   2964           00952         GOTO    ($-1)
0166   1315           00953         BCF     EECON1,CFGS
0167   1395           00954         BCF     EECON1,EEPGD
0168   1515           00955         BSF     EECON1,WREN
                      00956         
0169   1F8B           00957         BTFSS   INTCON,GIE      ;int enabled?
016A   2971           00958         GOTO    EEWRITEMAIN     ;int already off, exit through this
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 19
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00959 
016B   138B           00960         BCF     INTCON,GIE      ;interrupt off
016C   1B8B           00961         BTFSC   INTCON,GIE      ;check
016D   296B           00962         GOTO    ($-2)
016E   2171           00963         CALL    EEWRITEMAIN
016F   178B           00964         BSF     INTCON,GIE      ;interrupt on
0170   0008           00965         RETURN
                      00966 
0171   3055           00967 EEWRITEMAIN     MOVLW   55
0172   0096           00968         MOVWF   EECON2
0173   30AA           00969         MOVLW   0AA
0174   0096           00970         MOVWF   EECON2
0175   1495           00971         BSF     EECON1,WR
0176   1115           00972         BCF     EECON1,WREN
                      00973 
0177   1895           00974         BTFSC   EECON1,WR
0178   2977           00975         GOTO    ($-1)
                      00976 
0179   0020           00977         BANKSEL 0
017A   0008           00978         RETURN
                      00979 
017B   0E23           00980 PWMSET  SWAPF   PWML,W
017C   3930           00981         ANDLW   B'00110000'
017D   00A5           00982         MOVWF   PWMTEMP ;store lower bits in correct position
017E   0CA4           00983         RRF     PWMH
017F   0CA3           00984         RRF     PWML
0180   0CA4           00985         RRF     PWMH
0181   0C23           00986         RRF     PWML,W  ;MS 8-bits in W
0182   0025           00987         BANKSEL CCPR1L
0183   0091           00988         MOVWF   CCPR1L
0184   0020           00989         BANKSEL 0
0185   0825           00990         MOVFW   PWMTEMP
0186   0025           00991         BANKSEL CCP1CON
0187   1213           00992         BCF     CCP1CON,4
0188   1293           00993         BCF     CCP1CON,5
0189   0493           00994         IORWF   CCP1CON
018A   0020           00995         BANKSEL 0
018B   0008           00996         RETURN
                      00997 
018C   01C4           00998 CALCPERCENT     CLRF    M1H     ;all ###4
018D   3064           00999         MOVLW   .100
018E   00C5           01000         MOVWF   M1L
018F   21C2           01001         CALL    CALCMAIN
0190   1BC3           01002         BTFSC   AARGB3,7        ;negative? ###s
0191   01C3           01003         CLRF    AARGB3  ;yes, value 0   ###j here
                      01004 
                      01005 
0192   3028           01006 CALCPERCENTa    MOVLW   OPalarmH        ;get alarm parameters
0193   2150           01007         CALL    EEREADADRW
0194   00D2           01008         MOVWF   ALARMLEVHI
0195   214E           01009         CALL    EEREADNEXT
0196   00D3           01010         MOVWF   ALARMLEVLO
                      01011 
0197   10D4           01012         BCF     ALARMONatHI     ;extract alarm flag
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 20
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0198   1BD2           01013         BTFSC   ALARMLEVHI,7
0199   14D4           01014         BSF     ALARMONatHI
                      01015 
019A   307F           01016         MOVLW   B'01111111'
019B   05D2           01017         ANDWF   ALARMLEVHI      ;remove alarm flag
                      01018 
019C   0843           01019 SETALOPFLAG     MOVFW   AARGB3
019D   0252           01020         SUBWF   ALARMLEVHI,W
019E   1C03           01021         SKPC
019F   1454           01022         BSF     ALARMOPFLAG
                      01023         
01A0   0853           01024         MOVFW   ALARMLEVLO
01A1   0243           01025         SUBWF   AARGB3,W
01A2   1C03           01026         SKPC
01A3   1054           01027         BCF     ALARMOPFLAG     
                      01028 
01A4   1CD4           01029         BTFSS   ALARMONatHI
01A5   29AB           01030         GOTO    SETALARMOPLO
                      01031 
01A6   1854           01032 SETALARMOPHI    BTFSC   ALARMOPFLAG     ;###5 here
01A7   160E           01033         BSF     ALARMOP
01A8   1C54           01034         BTFSS   ALARMOPFLAG
01A9   120E           01035         BCF     ALARMOP ;###5 to here
01AA   0008           01036         RETURN
                      01037         
01AB   1854           01038 SETALARMOPLO    BTFSC   ALARMOPFLAG     ;###5 here
01AC   120E           01039         BCF     ALARMOP
01AD   1C54           01040         BTFSS   ALARMOPFLAG
01AE   160E           01041         BSF     ALARMOP ;###5 to here
01AF   0008           01042         RETURN
                      01043 
                      01044                 
                      01045 ;**********************************************************************
                      01046 ;(CAP RESULT x  OPSPAN)/SPAN 
                      01047 ;Multiplication by output span in PWM terms
                      01048 
                      01049 
                      01050 ;CALCULATE      ###r    
01B0   3024           01051 GETOPPARAM      MOVLW   OPspanH ;get op parameters
01B1   2150           01052         CALL    EEREADADRW
01B2   00CB           01053         MOVWF   OPSPANHI
                      01054 
01B3   13A0           01055         BCF     OPREVERSE       ;extract reverse flag
01B4   1BCB           01056         BTFSC   OPSPANHI,7
01B5   17A0           01057         BSF     OPREVERSE
                      01058 
01B6   3007           01059         MOVLW   B'00000111'
01B7   05CB           01060         ANDWF   OPSPANHI        ;remove reverse flag
01B8   084B           01061         MOVFW   OPSPANHI
01B9   00C4           01062         MOVWF           M1H
                      01063 
01BA   214E           01064         CALL    EEREADNEXT
01BB   00CC           01065         MOVWF   OPSPANLO
01BC   00C5           01066         MOVWF           M1L
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 21
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01BD   214E           01067         CALL    EEREADNEXT
01BE   00CD           01068         MOVWF   OPOFFSETHI
01BF   214E           01069         CALL    EEREADNEXT
01C0   00CE           01070         MOVWF   OPOFFSETLO
01C1   0008           01071         RETURN
                      01072         
01C2   086C           01073 CALCMAIN        MOVFW   PROBE1H
01C3   00C6           01074         MOVWF           M2H
01C4   086D           01075         MOVFW   PROBE1L
01C5   00C7           01076         MOVWF           M2L
                      01077 
01C6   2219           01078         CALL            MULT16X16       ;result in AARGB0-4
                      01079 
01C7   082A           01080         MOVFW   P1SPANATCALL    ;get SPAN into divisor
01C8   00C5           01081         MOVWF   DIVL
01C9   082B           01082         MOVFW   P1SPANATCALH
01CA   00C4           01083         MOVWF   DIVH
                      01084                 
01CB   2234           01085         CALL    UDIV3216L       ;result in AARGB3(L) & AARGB2(H)
01CC   0008           01086         RETURN
                      01087 
01CD   084C           01088 SPANCHECK       MOVFW   OPSPANLO                ;MAXSPAN - SPANCALCRESULT
01CE   0243           01089         SUBWF   AARGB3,W        
01CF   084B           01090         MOVFW   OPSPANHI                
01D0   3B42           01091         SUBWFB  AARGB2,W
01D1   1C03           01092         SKPC
01D2   0008           01093         RETURN
                      01094         
01D3   084C           01095 SETMAXSPAN      MOVFW   OPSPANLO        ;if calculated span too great, set to max
01D4   00C3           01096         MOVWF   AARGB3
01D5   084B           01097         MOVFW   OPSPANHI
01D6   00C2           01098         MOVWF   AARGB2
01D7   0008           01099         RETURN
                      01100 
                      01101 ;16-Bit subtract with valid carry-out (zero flag invalid after subtraction)
                      01102 
01D8   0843           01103 REVERSEPWM      MOVFW   AARGB3  ;DEST = DEST-SOURCE
01D9   024C           01104         SUBWF   OPSPANLO,W      ;
01DA   00C3           01105         MOVWF   AARGB3  ;return to AARG
01DB   0842           01106         MOVFW   AARGB2  ;
01DC   1C03           01107         SKPC            ;
01DD   0A42           01108         INCF    AARGB2,W        ;was INCFSZ
01DE   024B           01109         SUBWF   OPSPANHI,W
01DF   00C2           01110         MOVWF   AARGB2  ;return to AARG
01E0   0008           01111         RETURN
                      01112 
                      01113 ;*******************************************************************
                      01114 
                      01115 ;Primes average with stored average
                      01116 
01E1   3036           01117 AVPRIME MOVLW   n_av
01E2   2150           01118         CALL    EEREADADRW
01E3   00E9           01119         MOVWF   NAVCOUNT
01E4   00C9           01120         MOVWF   LOOPCOUNT
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 22
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01E5   01DE           01121         CLRF    AVREGU
                      01122 
01E6   3012           01123         MOVLW   currdiv12L
01E7   2150           01124         CALL    EEREADADRW
01E8   00E0           01125         MOVWF   AVREGL
01E9   00DA           01126         MOVWF   CURRDIVL
01EA   00A8           01127         MOVWF   AVDIVL_OVER20   ;###j
                      01128 
01EB   214E           01129         CALL    EEREADNEXT
01EC   00DF           01130         MOVWF   AVREGH
01ED   00D9           01131         MOVWF   CURRDIVH
01EE   00A9           01132         MOVWF   AVDIVH_OVER20   ;###j
                      01133 
01EF   1003           01134 PRIMELOOP       CLRC    
01F0   0DE0           01135         RLF     AVREGL
01F1   0DDF           01136         RLF     AVREGH
01F2   0DDE           01137         RLF     AVREGU
01F3   0BC9           01138         DECFSZ  LOOPCOUNT
01F4   29EF           01139         GOTO    PRIMELOOP
01F5   0008           01140         RETURN
                      01141 
                      01142 ;*******************************************************************
                      01143 
                      01144 ;16 BIT WINDOW AVERAGE with window controlled by n_av (2 to 8)
                      01145 
01F6   0869           01146 EXTRACTAVDIV    MOVFW   NAVCOUNT        ;###h alterations made
01F7   00C9           01147         MOVWF   LOOPCOUNT
                      01148 
01F8   085E           01149         MOVFW   AVREGU
01F9   00DB           01150         MOVWF   AVDIVU
01FA   085F           01151         MOVFW   AVREGH
01FB   00DC           01152         MOVWF   AVDIVH
01FC   0860           01153         MOVFW   AVREGL
01FD   00DD           01154         MOVWF   AVDIVL
                      01155 
01FE   1003           01156 EXTRACTLOOP     CLRC
01FF   0CDB           01157         RRF     AVDIVU
0200   0CDC           01158         RRF     AVDIVH
0201   0CDD           01159         RRF     AVDIVL  ;divide by 2
0202   0BC9           01160         DECFSZ  LOOPCOUNT
0203   29FE           01161         GOTO    EXTRACTLOOP
0204   0008           01162         RETURN
                      01163         
0205   21F6           01164 DOAVERAGE       CALL    EXTRACTAVDIV
                      01165 
                      01166         
0206   1ED4           01167 TRANSIFOVER20   BTFSS   OVER20PCCSPAN   ;###j - over 20% of spancal?    
0207   2A0C           01168         GOTO    DOAVERAGEa      ;no, move on
0208   085D           01169         MOVFW   AVDIVL
0209   00A8           01170         MOVWF   AVDIVL_OVER20
020A   085C           01171         MOVFW   AVDIVH
020B   00A9           01172         MOVWF   AVDIVH_OVER20
                      01173         
020C   085A           01174 DOAVERAGEa      MOVFW   CURRDIVL        ;add in new
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 23
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

020D   07E0           01175         ADDWF   AVREGL
020E   0859           01176         MOVFW   CURRDIVH
                      01177         
020F   3DDF           01178         ADDWFC  AVREGH
0210   0103           01179         CLRW
0211   3DDE           01180         ADDWFC  AVREGU
                      01181 
0212   085D           01182         MOVFW   AVDIVL  ;subtract old
0213   02E0           01183         SUBWF   AVREGL
0214   085C           01184         MOVFW   AVDIVH
0215   3BDF           01185         SUBWFB  AVREGH
0216   085B           01186         MOVFW   AVDIVU
0217   3BDE           01187         SUBWFB  AVREGU
                      01188         
0218   0008           01189         RETURN
                      01190 
                      01191                 
                      01192 ;*******************************************************************
                      01193 
                      01194 ;16x16 FIXED POINT MULTIPLICATION ROUTINE (PM: 26, DM: 11)
                      01195 ;Input:  fixed point arguments in M1H/L and M2H/L
                      01196 ;Output: AARG0-4 (AARGB0 is most significant byte)
                      01197 
                      01198 
0219   01C0           01199 MULT16X16       CLRF    AARGB0
021A   01C1           01200         CLRF    AARGB1
021B   01C2           01201         CLRF    AARGB2
021C   01C3           01202         CLRF    AARGB3
                      01203         
021D   3010           01204         MOVLW   .16
021E   00CA           01205         MOVWF   OLOOPCOUNT
                      01206         
021F   0DC5           01207 MULT16X16LOOP   RLF     M1L
0220   0DC4           01208         RLF     M1H
0221   1C03 2A2B      01209         BNC     ROTATE32
                      01210 
0223   0847           01211 ADDM2TOTOTAL    MOVFW   M2L
0224   07C3           01212         ADDWF   AARGB3
0225   0846           01213         MOVFW   M2H
0226   3DC2           01214         ADDWFC  AARGB2
0227   0103           01215         CLRW    
0228   3DC1           01216         ADDWFC  AARGB1
0229   0103           01217         CLRW    
022A   3DC0           01218         ADDWFC  AARGB0
                      01219 
022B   0BCA           01220 ROTATE32        DECFSZ  OLOOPCOUNT
022C   2A2E           01221         GOTO    ROTATE32a
022D   0008           01222         RETURN
                      01223 
022E   1003           01224 ROTATE32a       CLRC
022F   0DC3           01225         RLF     AARGB3
0230   0DC2           01226         RLF     AARGB2
0231   0DC1           01227         RLF     AARGB1
0232   0DC0           01228         RLF     AARGB0
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 24
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0233   2A1F           01229         GOTO    MULT16X16LOOP
                      01230         
                      01231 
                      01232 ;start of division *********************************************************************
                      01233 
                      01234 ;32/16 FIXED POINT DIVIDE ROUTINE (PM: 68, DM: 11)
                      01235 ;Input:  fixed point arguments in AARG and DIVH/L (AARGB0 is most significant byte)
                      01236 ;Output: quotient AARG/DIV followed by remainder in REM
                      01237 
                      01238 ;AARGB0-3 can be anywhere in data memory but must be in one bank and in the order shown
                      01239 
0234   0844           01240 UDIV3216L       MOVFW   DIVH            ;test & exit if zero divisor
0235   0445           01241         IORWF   DIVL,W
0236   1903           01242         SKPNZ
0237   0008           01243         RETURN
                      01244 
0238   01C6           01245         CLRF    REMB0
0239   01C7           01246         CLRF    REMB1
                      01247 
023A   3000           01248         MOVLW   HIGH AARGB0             ;set up address pointer
023B   0085           01249         MOVWF   FSR0H
023C   3040           01250         MOVLW   LOW AARGB0
023D   0084           01251         MOVWF   FSR0L
                      01252 
023E   01C8           01253         CLRF    MATHSTEMP
023F   0D00           01254         RLF     INDF0,W         ;#0
0240   0DC7           01255         RLF     REMB1
0241   0845           01256         MOVFW   DIVL
                      01257 
0242   226B           01258         CALL    SUB1
                      01259 
0243   0D80           01260         RLF     INDF0           ;#0
                      01261 
0244   3004           01262         MOVLW   .4
0245   00CA           01263         MOVWF   OLOOPCOUNT              ;set outer loop
                      01264 
0246   3007           01265 INNERLOOP       MOVLW           7
0247   00C9           01266         MOVWF           LOOPCOUNT
                      01267 
0248   2265           01268 LOOPU3216A      CALL    ROTATE1         ;###X
0249   1C00           01269         BTFSS   INDF0,LSB               ;#0
024A   2A4D           01270         GOTO    UADD3216A
                      01271 
024B   226B           01272         CALL    SUB1
024C   2A4E           01273         GOTO    UOK3216A
                      01274 
024D   2271           01275 UADD3216A       CALL    ADD1
                      01276         
024E   0D80           01277 UOK3216A        RLF     INDF0           ;#0
                      01278 
024F   0BC9           01279               DECFSZ    LOOPCOUNT
0250   2A48           01280         GOTO    LOOPU3216A
                      01281 
0251   0B4A           01282         DECFSZ  OLOOPCOUNT,W            ;if last part of loop, miss next part
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 25
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0252   2A54           01283         GOTO    INCPOINTER
0253   2A60           01284         GOTO    LASTPART
                      01285 
0254   0A84           01286 INCPOINTER      INCF    FSR0L           ;point to next byte
                      01287 
0255   2265           01288         CALL    ROTATE1
0256   0384           01289         DECF    FSR0L           ;back to previous
                      01290                 
0257   1C00           01291         BTFSS   INDF0,LSB               ;#0
0258   2A5B           01292         GOTO    UADD3216B
                      01293 
0259   226B           01294         CALL    SUB1
025A   2A5C           01295         GOTO    UOK3216B
                      01296 
025B   2271           01297 UADD3216B       CALL    ADD1
                      01298         
025C   0A84           01299 UOK3216B        INCF    FSR0L
025D   0D80           01300         RLF     INDF0           ;##1
                      01301 
025E   0BCA           01302         DECFSZ  OLOOPCOUNT
025F   2A46           01303         GOTO    INNERLOOP
                      01304 
0260   1800           01305 LASTPART        BTFSC   INDF0,LSB               ;####3
0261   0008           01306         RETURN
0262   0845           01307         MOVF    DIVL,W
0263   2271           01308         CALL    ADD1            ;with extra un-needed bits
0264   0008           01309         RETURN
                      01310 
                      01311 ;division subroutines
                      01312 
0265   0D00           01313 ROTATE1         RLF     INDF0,W         ;#0
0266   0DC7           01314                 RLF     REMB1
0267   0DC6           01315         RLF     REMB0
0268   0DC8           01316         RLF     MATHSTEMP
0269   0845           01317         MOVFW   DIVL
026A   0008           01318         RETURN
                      01319 
026B   02C7           01320 SUB1    SUBWF   REMB1
026C   0844           01321         MOVFW   DIVH
026D   3BC6           01322         SUBWFB  REMB0
026E   0103           01323         CLRW
026F   3BC8           01324         SUBWFB  MATHSTEMP
0270   0008           01325         RETURN
                      01326 
                      01327 
0271   07C7           01328 ADD1    ADDWF   REMB1
0272   0844           01329         MOVFW   DIVH
0273   3DC6           01330         ADDWFC  REMB0
0274   0103           01331         CLRW
0275   3DC8           01332         ADDWFC  MATHSTEMP
0276   0008           01333         RETURN
                      01334 
                      01335         
                      01336 ;end of division ***********************************************************************
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 26
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01337 
                      01338 
0277   3002           01339 MT_DF_M_N_DVC   MOVLW   P1emptyL        ;get stored empty values
0278   2150           01340         CALL    EEREADADRW
0279   00BA           01341         MOVWF   P1EMPTYL
027A   214E           01342         CALL    EEREADNEXT
027B   00BB           01343         MOVWF   P1EMPTYH        
                      01344 ;       BTFSS   TWOPROBE        ;###8 HERE
                      01345 ;       RETURN          ;miss next if single probe
                      01346 
027C   214E           01347         CALL    EEREADNEXT
027D   00D0           01348         MOVWF   P2EMPTYL
027E   214E           01349         CALL    EEREADNEXT
027F   00D1           01350         MOVWF   P2EMPTYH
                      01351 
0280   214E           01352         CALL    EEREADNEXT
0281   00E3           01353         MOVWF   P0EMPTYL
0282   214E           01354         CALL    EEREADNEXT
0283   00E4           01355         MOVWF   P0EMPTYH
                      01356 
0284   3032           01357         MOVLW   P1dfL   ;get stored drift values 
0285   2150           01358         CALL    EEREADADRW
0286   00E5           01359         MOVWF   P1DFL
0287   214E           01360         CALL    EEREADNEXT
0288   00E6           01361         MOVWF   P1DFH
0289   214E           01362         CALL    EEREADNEXT
028A   00E7           01363         MOVWF   P2DFL
028B   214E           01364         CALL    EEREADNEXT
028C   00E8           01365         MOVWF   P2DFH
                      01366 
028D   3010           01367         MOVLW   m12L    ;get M value
028E   2150           01368         CALL    EEREADADRW
028F   00EA           01369         MOVWF   M12L
0290   214E           01370         CALL    EEREADNEXT
0291   00EB           01371         MOVWF   M12H
                      01372 
0292   3036           01373         MOVLW   n_av    
0293   2150           01374         CALL    EEREADADRW
0294   00E9           01375         MOVWF   NAVCOUNT
                      01376         
0295   300C           01377         MOVLW   caldiv12L       ;get div @ cal value
0296   2150           01378         CALL    EEREADADRW
0297   00A6           01379         MOVWF   DIVATCALL
0298   214E           01380         CALL    EEREADNEXT
0299   00A7           01381         MOVWF   DIVATCALH       
029A   214E           01382         CALL    EEREADNEXT      ;###j here
029B   00AA           01383         MOVWF   P1SPANATCALL
029C   214E           01384         CALL    EEREADNEXT
029D   00AB           01385         MOVWF   P1SPANATCALH    ;###j to here   
029E   0008           01386         RETURN          ;###8 to here
                      01387 
029F   01A3           01388 GETSPANCAL      CLRF    PWML
02A0   01A4           01389         CLRF    PWMH
02A1   217B           01390         CALL    PWMSET
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 27
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01391 
                      01392 ;       CLRF    EEWRADDRESS     ;###10
                      01393 
02A2   160E           01394 GETHIGHLEVEL    BSF     ALARMOP ;###7
                      01395         ;CALL   GETCOMPPROBE    ;###10
02A3   232B           01396         CALL    GETP2
02A4   233C           01397         CALL    GETP1
                      01398 
                      01399         IF (SETFORTEST==1)
                      01400         CALL    GETFALSEDATA
                      01401         ENDIF
                      01402 
02A5   3008           01403 SAVEP12FULL     MOVLW   P1fullL ;store full values
02A6   00F4           01404         MOVWF   EEWRADDRESS
02A7   0832           01405         MOVFW   TMR1HP1
02A8   2160           01406         CALL    EEWRITEW
02A9   0831           01407         MOVFW   TMR1UP1
02AA   215C           01408         CALL    EEWRITEWNEXT
02AB   0835           01409         MOVFW   TMR1HP2
02AC   215C           01410         CALL    EEWRITEWNEXT
02AD   0834           01411         MOVFW   TMR1UP2
02AE   215C           01412         CALL    EEWRITEWNEXT    ;###10 to here
                      01413 
                      01414 
02AF   2277           01415 GETLOWLEVEL     CALL    MT_DF_M_N_DVC
                      01416 
                      01417 ;###q   BTFSS   TWOPROBE
                      01418 ;###q   GOTO    ONEPSPANCAL
                      01419 
02B0   083A           01420 RAWP1SPANCAL    MOVFW   P1EMPTYL        ;P1 RAW SPAN = P1-P1EMPTY 
02B1   02B2           01421         SUBWF   TMR1HP1 ;
02B2   083B           01422         MOVFW   P1EMPTYH        ;
02B3   3BB1           01423         SUBWFB  TMR1UP1
                      01424 
02B4   0850           01425 RAWP2SPANCAL    MOVFW   P2EMPTYL        ;P2 RAW SPAN = P2-P2EMPTY 
02B5   02B5           01426         SUBWF   TMR1HP2 ;
02B6   0851           01427         MOVFW   P2EMPTYH        ;
02B7   3BB4           01428         SUBWFB  TMR1UP2
                      01429 
                      01430 ;Calculate M12 = ((const1) - (((const2) x P1 RAW SPAN)/P2 RAW SPAN))
                      01431 ;where const1 = (13 x 2^12) and const2 = (4.726 x 2^12)
                      01432 
02B8   0832           01433 M12CAL  MOVFW   TMR1HP1
02B9   00C5           01434         MOVWF   M1L
02BA   0831           01435         MOVFW   TMR1UP1
02BB   00C4           01436         MOVWF   M1H     ;P1 RAW SPAN to M1
                      01437         
02BC   301F           01438         MOVLW   LOW const2
02BD   00C7           01439         MOVWF   M2L
02BE   3071           01440         MOVLW   HIGH const2
02BF   00C6           01441         MOVWF   M2H     ;const2 to M2
                      01442         
02C0   2219           01443         CALL    MULT16X16       ;multiply
                      01444 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 28
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02C1   0835           01445         MOVFW   TMR1HP2
02C2   00C5           01446         MOVWF   DIVL
02C3   0834           01447         MOVFW   TMR1UP2
02C4   00C4           01448         MOVWF   DIVH    ;P2 RAW SPAN to DIV
                      01449         
02C5   2234           01450         CALL    UDIV3216L       ;divide - result in lower 2 bytes of AARG       
                      01451 
02C6   30E6           01452         MOVLW   HIGH const1
02C7   00C6           01453         MOVWF   M2H
02C8   3066           01454         MOVLW   LOW const1
02C9   00C7           01455         MOVWF   M2L     ;const1 in M2H
                      01456 
02CA   0843           01457         MOVFW   AARGB3
02CB   02C7           01458         SUBWF   M2L
02CC   0842           01459         MOVFW   AARGB2
02CD   3BC6           01460         SUBWFB  M2H     ;const1-result in M2
                      01461 
02CE   3010           01462 STOREM12        MOVLW   m12L
02CF   00F4           01463         MOVWF   EEWRADDRESS
02D0   0847           01464         MOVFW   M2L
02D1   2160           01465         CALL    EEWRITEW
02D2   0846           01466         MOVFW   M2H
02D3   215C           01467         CALL    EEWRITEWNEXT
                      01468 
02D4   0832           01469 CALCDIVATCAL    MOVFW   TMR1HP1
02D5   00C5           01470         MOVWF   M1L
02D6   0831           01471         MOVFW   TMR1UP1
02D7   00C4           01472         MOVWF   M1H     ;P1 RAW SPAN to M1 (M12 still in M2)            
                      01473 
02D8   2219           01474         CALL    MULT16X16       ;RAW P1 SPAN x M12 result in AARG
                      01475 
02D9   0835           01476         MOVFW   TMR1HP2
02DA   00C5           01477         MOVWF   DIVL
02DB   0834           01478         MOVFW   TMR1UP2
02DC   00C4           01479         MOVWF   DIVH    ;P2 RAW SPAN to DIV
                      01480         
02DD   2234           01481         CALL    UDIV3216L       ;((RAW P1 SPAN x M12)/RAW P2 SPAN) - result in lower 2 bytes of AARG  
                              
                      01482 
02DE   30D0           01483         MOVLW   LOW const3      ;subtract const3 (7.43 x 2^12)= div@cal
02DF   02C3           01484         SUBWF   AARGB3
02E0   3064           01485         MOVLW   HIGH const3
02E1   3BC2           01486         SUBWFB  AARGB2
                      01487         
02E2   300C           01488 STOREDIVATCAL   MOVLW   caldiv12L
02E3   00F4           01489         MOVWF   EEWRADDRESS
02E4   3000           01490         MOVLW   onepdivL        ;###q
02E5   1BF7           01491         BTFSC   TWOPROBE        ;###q
02E6   0843           01492         MOVFW   AARGB3
02E7   00DA           01493         MOVWF   CURRDIVL
02E8   00A6           01494         MOVWF   DIVATCALL
02E9   2160           01495         CALL    EEWRITEW
02EA   3010           01496         MOVLW   onepdivH        ;###q
02EB   1BF7           01497         BTFSC   TWOPROBE        ;###q
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 29
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02EC   0842           01498         MOVFW   AARGB2
02ED   00D9           01499         MOVWF   CURRDIVH
02EE   00A7           01500         MOVWF   DIVATCALH
02EF   215C           01501         CALL    EEWRITEWNEXT    ;store div@cal x 2^12   
                      01502 
02F0   2324           01503         CALL    STOREAVDIV
                      01504 
02F1   0832           01505 CALCP1SPAN      MOVFW   TMR1HP1
02F2   00C5           01506         MOVWF   M1L
02F3   0831           01507         MOVFW   TMR1UP1
02F4   00C4           01508         MOVWF   M1H     ;P1 RAW SPAN to M1      
                      01509 
02F5   01C7           01510         CLRF    M2L
02F6   3010           01511         MOVLW   HIGH .4096
02F7   00C6           01512         MOVWF   M2H     ;2^12 to M2
                      01513         
02F8   2219           01514         CALL    MULT16X16
                      01515 
                      01516 ;       MOVLW   caldiv12L
                      01517 ;       CALL    EEREADADRW
02F9   0826           01518         MOVFW   DIVATCALL
02FA   00C5           01519         MOVWF   DIVL    ;###h was remmed
                      01520 ;       CALL    EEREADNEXT
02FB   0827           01521         MOVFW   DIVATCALH
02FC   00C4           01522         MOVWF   DIVH
                      01523         
02FD   2234           01524         CALL    UDIV3216L       ;P1 SPAN = (2^12 x P1 RAW SPAN)/CALDIV12
                      01525 
02FE   300E           01526 STOREP1SPAN     MOVLW   P1calspanL
02FF   00F4           01527         MOVWF   EEWRADDRESS
0300   0843           01528         MOVFW   AARGB3
0301   2160           01529         CALL    EEWRITEW
0302   0842           01530         MOVFW   AARGB2
0303   215C           01531         CALL    EEWRITEWNEXT    ;store P1 SPAN@cal
                      01532         
0304   3001           01533 SAVESPANEND     MOVLW   calstatus
0305   00F4           01534         MOVWF   EEWRADDRESS
0306   3003           01535         MOVLW   spandone
0307   00F5           01536         MOVWF   CALSTATUS
0308   2160           01537         CALL    EEWRITEW
                      01538                         
0309   120E           01539 SAVESPANENDa    BCF     ALARMOP ;###7
030A   01A1           01540         CLRF    FLASHER ;###7 ensure wait
030B   0AA1           01541         INCF    FLASHER ;###7 before main
030C   0008           01542         RETURN
                      01543 
                      01544 ;###q here
                      01545 ;ONEPSPANCAL    MOVFW   P1EMPTYL        ;P1 RAW SPAN = P1-P1EMPTY 
                      01546 ;       SUBWF   TMR1HP1 ;
                      01547 ;       MOVFW   P1EMPTYH        ;
                      01548 ;       SUBWFB  TMR1UP1
                      01549 
                      01550 ;STORERAWSPAN   MOVLW   P1calspanL      ;use same location as 2-probe
                      01551 ;       MOVWF   EEWRADDRESS
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 30
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01552 ;       MOVFW   TMR1HP1
                      01553 ;       CALL    EEWRITEW
                      01554 ;       MOVFW   TMR1UP1
                      01555 ;       CALL    EEWRITEWNEXT    ;store P1 SPAN@cal
                      01556 
                      01557 ;       GOTO    SAVESPANEND
                      01558 ;###q to here
                      01559 
                      01560 
030D   160E           01561 GETLCAL BSF     ALARMOP ;###7
                      01562         ;CLRF   EEWRADDRESS     ;###10 here
                      01563         ;CALL   GETCOMPPROBE
030E   232B           01564         CALL    GETP2
030F   233C           01565         CALL    GETP1
0310   234D           01566         CALL    GETP0   ;###10 to here
                      01567         
0311   3001           01568 SAVELCAL        MOVLW   calstatus
0312   00F4           01569         MOVWF   EEWRADDRESS     
0313   3001           01570         MOVLW   emptydone
0314   00F5           01571         MOVWF   CALSTATUS
0315   2160           01572         CALL    EEWRITEW
0316   0832           01573         MOVFW   TMR1HP1
0317   215C           01574         CALL    EEWRITEWNEXT
0318   0831           01575         MOVFW   TMR1UP1 ;save P1E
0319   215C           01576         CALL    EEWRITEWNEXT            
                      01577 ;###q   BTFSS   TWOPROBE        ;###8 HERE
                      01578 ;###q   GOTO    SAVELCALa
031A   0835           01579         MOVFW   TMR1HP2
031B   215C           01580         CALL    EEWRITEWNEXT
031C   0834           01581         MOVFW   TMR1UP2 ;save P2E
031D   215C           01582         CALL    EEWRITEWNEXT    ;###8 TO HERE
031E   0838           01583         MOVFW   TMR1HP0 ;###10 here
031F   215C           01584         CALL    EEWRITEWNEXT
0320   0837           01585         MOVFW   TMR1UP0 ;save P0E
0321   215C           01586         CALL    EEWRITEWNEXT    ;###10 to here
                      01587 
0322   120E           01588 SAVELCALa       BCF     ALARMOP ;###7
0323   0008           01589         RETURN
                      01590 
0324   3012           01591 STOREAVDIV      MOVLW   currdiv12L
0325   00F4           01592         MOVWF   EEWRADDRESS
0326   0828           01593         MOVFW   AVDIVL_OVER20
0327   2160           01594         CALL    EEWRITEW
0328   0829           01595         MOVFW   AVDIVH_OVER20
0329   215C           01596         CALL    EEWRITEWNEXT
032A   0008           01597         RETURN
                      01598 
032B   30F3           01599 GETP2   MOVLW   B'11110011'             ;both probes disabled
032C   058E           01600         ANDWF   PORTC
032D   3004           01601         MOVLW   enref_P2                ;set ref/probe2 connection
032E   048E           01602         IORWF   PORTC
032F   1570           01603         BSF     GETTINGP2
0330   1670           01604         BSF     T0WAITSTART
0331   1970           01605         BTFSC   GETTINGP2
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 31
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0332   2B31           01606         GOTO    ($-1)
0333   0008           01607         RETURN  
                      01608         
0334   0816           01609 TRANSFERP2      MOVFW   TMR1L
0335   00B6           01610         MOVWF   TMR1LP2
0336   0817           01611         MOVFW   TMR1H
0337   00B5           01612         MOVWF   TMR1HP2 
0338   0830           01613         MOVFW   TMR1U
0339   00B4           01614         MOVWF   TMR1UP2
033A   1170           01615         BCF     GETTINGP2
033B   0008           01616         RETURN
                      01617 
                      01618 
033C   30F3           01619 GETP1   MOVLW   B'11110011'             ;both probes disabled
033D   058E           01620         ANDWF   PORTC
033E   3008           01621         MOVLW   enP1            ;set probe connection
033F   048E           01622         IORWF   PORTC           
0340   14F0           01623         BSF     GETTINGP1
0341   1670           01624         BSF     T0WAITSTART
0342   18F0           01625         BTFSC   GETTINGP1
0343   2B42           01626         GOTO    ($-1)
0344   0008           01627         RETURN
                      01628 
0345   0816           01629 TRANSFERP1      MOVFW   TMR1L
0346   00B3           01630         MOVWF   TMR1LP1
0347   0817           01631         MOVFW   TMR1H
0348   00B2           01632         MOVWF   TMR1HP1 
0349   0830           01633         MOVFW   TMR1U
034A   00B1           01634         MOVWF   TMR1UP1
034B   10F0           01635         BCF     GETTINGP1
034C   0008           01636         RETURN
                      01637         
034D   30F3           01638 GETP0   MOVLW   B'11110011'     ;###9 here
034E   058E           01639         ANDWF   PORTC   ;both probes de-selected
                      01640                 
034F   1470           01641         BSF     GETTINGP0
0350   1670           01642         BSF     T0WAITSTART
0351   1870           01643         BTFSC   GETTINGP0
0352   2B51           01644         GOTO    ($-1)
0353   0008           01645         RETURN
                      01646 
0354   0816           01647 TRANSFERP0      MOVFW   TMR1L
0355   00B9           01648         MOVWF   TMR1LP0
0356   0817           01649         MOVFW   TMR1H
0357   00B8           01650         MOVWF   TMR1HP0 
0358   0830           01651         MOVFW   TMR1U
0359   00B7           01652         MOVWF   TMR1UP0
035A   1070           01653         BCF     GETTINGP0
035B   0008           01654         RETURN          ;###9 to here
                      01655 
                      01656 
035C   1EF0           01657 SENDDIAGDATA    BTFSS   SENDPARAMS
035D   0008           01658         RETURN
                      01659 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 32
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

035E   0837           01660         MOVFW   TMR1UP0 ;send P0 data
035F   2096           01661         CALL    TESTSENDTXW
0360   0838           01662         MOVFW   TMR1HP0
0361   2096           01663         CALL    TESTSENDTXW
                      01664 ;       MOVFW   TMR1LP0
                      01665 ;       CALL    TESTSENDTXW
                      01666 
0362   0831           01667         MOVFW   TMR1UP1 ;send PROBE1 data
0363   2096           01668         CALL    TESTSENDTXW
0364   0832           01669         MOVFW   TMR1HP1
0365   2096           01670         CALL    TESTSENDTXW
                      01671 ;       MOVFW   TMR1LP1
                      01672 ;       CALL    TESTSENDTXW
                      01673 
0366   0834           01674         MOVFW   TMR1UP2 ;send PROBE2 data
0367   2096           01675         CALL    TESTSENDTXW
0368   0835           01676         MOVFW   TMR1HP2
0369   2096           01677         CALL    TESTSENDTXW
                      01678 ;       MOVFW   TMR1LP2
                      01679 ;       CALL    TESTSENDTXW
                      01680 
036A   0855           01681         MOVFW   CALCP1H ;send CALCP1
036B   2096           01682         CALL    TESTSENDTXW     
036C   0856           01683         MOVFW   CALCP1L
036D   2096           01684         CALL    TESTSENDTXW
                      01685         
036E   0857           01686         MOVFW   CALCP2H ;send CALCP2
036F   2096           01687         CALL    TESTSENDTXW     
0370   0858           01688         MOVFW   CALCP2L
0371   2096           01689         CALL    TESTSENDTXW
                      01690 
0372   0859           01691         MOVFW   CURRDIVH        ;send DIVISOR
0373   2096           01692         CALL    TESTSENDTXW     
0374   085A           01693         MOVFW   CURRDIVL
0375   2096           01694         CALL    TESTSENDTXW
                      01695         
0376   085C           01696         MOVFW   AVDIVH  ;send AVDIV
0377   2096           01697         CALL    TESTSENDTXW     
0378   085D           01698         MOVFW   AVDIVL
0379   2096           01699         CALL    TESTSENDTXW
                      01700 
037A   1EA0           01701         BTFSS   DRESISTIVE      ;### r here
037B   2B84           01702         GOTO    CONVPWMTOSEND
                      01703 
037C   01FE           01704         CLRF    TEMPHI  ;send PR2+1 = R Multiplier
037D   081B           01705         MOVFW   PR2
037E   00FF           01706         MOVWF   TEMPLO
037F   3001           01707         MOVLW   .1
0380   07FF           01708         ADDWF   TEMPLO
0381   0103           01709         CLRW
0382   3DFE           01710         ADDWFC  TEMPHI
                      01711         
0383   2B8F           01712         GOTO    SENDPWM_PR2     ;### to here
                      01713 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 33
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0384                  01714 CONVPWMTOSEND
0384   0025           01715         BANKSEL CCPR1L
0385   3511           01716         LSLF    CCPR1L,W        ;put 10-bit PWM into TEMPLO/HI
0386   00FF           01717         MOVWF   TEMPLO
0387   01FE           01718         CLRF    TEMPHI
0388   0DFE           01719         RLF     TEMPHI
0389   35FF           01720         LSLF    TEMPLO
038A   0DFE           01721         RLF     TEMPHI          
038B   0E13           01722         SWAPF   CCP1CON,W
038C   3903           01723         ANDLW   B'00000011'
038D   04FF           01724         IORWF   TEMPLO
038E   0020           01725         BANKSEL 0
                      01726         
038F   087E           01727 SENDPWM_PR2     MOVFW   TEMPHI  ;send last PWM
0390   2096           01728         CALL    TESTSENDTXW
0391   087F           01729         MOVFW   TEMPLO
0392   2096           01730         CALL    TESTSENDTXW
                      01731 
0393   082D           01732         MOVFW   DIVUSEDH        ;send divisor used in calc ###j
0394   2096           01733         CALL    TESTSENDTXW
0395   082C           01734         MOVFW   DIVUSEDL
0396   2096           01735         CALL    TESTSENDTXW
                      01736 
0397   30FF           01737         MOVLW   0FF
0398   1F54           01738         BTFSS   SAVEINDICATOR
0399   3000           01739         MOVLW   0
039A   2096           01740         CALL    TESTSENDTXW
039B   1354           01741         BCF     SAVEINDICATOR
                      01742         
039C   12F0           01743         BCF     SENDPARAMS      ;one shot only
                      01744         
039D   0008           01745         RETURN
                      01746 
039E   1320           01747 GETCOMPPROBE    BCF     COMMSBEENON     ;clear flag
039F   232B           01748         CALL    GETP2   
03A0   233C           01749         CALL    GETP1
03A1   234D           01750         CALL    GETP0
03A2   0008           01751         RETURN
                      01752 
                      01753         IF (SETFORTEST==1)
                      01754 
                      01755 GETFALSEDATA    MOVLW   HIGH .2320
                      01756         MOVWF   TMR1UP0
                      01757         MOVLW   LOW .2320       ;negative value
                      01758         MOVWF   TMR1HP0
                      01759         
                      01760 INJECT1 BTFSC   TEST,0
                      01761         GOTO    INJECT1B
                      01762         BTFSC   TEST,1
                      01763         GOTO    INJECT1C
                      01764 
                      01765 INJECT1A        MOVLW   HIGH .28354
                      01766         MOVWF   TMR1UP1
                      01767         MOVLW   LOW .28354      ;30568
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 34
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01768         MOVWF   TMR1HP1
                      01769         GOTO    INJECT2
                      01770 
                      01771 INJECT1B        MOVLW   HIGH .34354
                      01772         MOVWF   TMR1UP1
                      01773         MOVLW   LOW .34354      ;30568
                      01774         MOVWF   TMR1HP1
                      01775         GOTO    INJECT2
                      01776         
                      01777 INJECT1C        MOVLW   HIGH .3354
                      01778         MOVWF   TMR1UP1
                      01779         MOVLW   LOW .3354       ;30568
                      01780         MOVWF   TMR1HP1
                      01781 
                      01782 INJECT2 BTFSC   TEST,4
                      01783         GOTO    INJECT2B
                      01784         BTFSC   TEST,5
                      01785         GOTO    INJECT2C
                      01786 
                      01787 INJECT2A        MOVLW   HIGH .29477
                      01788         MOVWF   TMR1UP2
                      01789         MOVLW   LOW .29477      ;31561
                      01790         MOVWF   TMR1HP2
                      01791         RETURN
                      01792 
                      01793 INJECT2B        MOVLW   HIGH .35477
                      01794         MOVWF   TMR1UP2
                      01795         MOVLW   LOW .35477      ;31561
                      01796         MOVWF   TMR1HP2
                      01797         RETURN
                      01798         
                      01799 INJECT2C        MOVLW   HIGH .3477
                      01800         MOVWF   TMR1UP2
                      01801         MOVLW   LOW .3477       ;31561
                      01802         MOVWF   TMR1HP2
                      01803         RETURN
                      01804 
                      01805         ENDIF
                      01806 
03A3                  01807 TWOPROBECALC    
                      01808         IF (SETFORTEST==1)
                      01809         CALL    GETFALSEDATA
                      01810         ENDIF
                      01811 
03A3   0837           01812 ONEPDRIFTCALC   MOVFW   TMR1UP0 ;entry point for one probe calcs
03A4   00E1           01813         MOVWF   P0DFH
03A5   0838           01814         MOVFW   TMR1HP0
03A6   00E2           01815         MOVWF   P0DFL   ;transfer current P0
                      01816         
03A7   1154           01817         BCF     DRIFTNEG        ;clear flag
03A8   0863           01818         MOVFW   P0EMPTYL
03A9   02E2           01819         SUBWF   P0DFL
03AA   0864           01820         MOVFW   P0EMPTYH
03AB   3BE1           01821         SUBWFB  P0DFH   ;P0-P0_empty
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 35
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01822         
03AC   1803           01823         SKPNC           ;no carry indicates negative
03AD   2BB5           01824         GOTO    P1DFCALC
                      01825         
03AE   1554           01826 P0DFNEGATIVE    BSF     DRIFTNEG
03AF   09E2           01827         COMF    P0DFL
03B0   09E1           01828         COMF    P0DFH   ;complement
03B1   3001           01829         MOVLW   .1
03B2   07E2           01830         ADDWF   P0DFL
03B3   0103           01831         CLRW
03B4   3DE1           01832         ADDWFC  P0DFH   ;& add 1
                      01833         
03B5   0865           01834 P1DFCALC        MOVFW   P1DFL   ;constant from EEPROM
03B6   00C5           01835         MOVWF   M1L
03B7   0866           01836         MOVFW   P1DFH
03B8   00C4           01837         MOVWF   M1H
                      01838         
03B9   0862           01839         MOVFW   P0DFL
03BA   00C7           01840         MOVWF   M2L
03BB   0861           01841         MOVFW   P0DFH
03BC   00C6           01842         MOVWF   M2H
                      01843         
03BD   2219           01844         CALL    MULT16X16       ;Result - P1df * 2^8 IN AARGB1(H) & AARGB2(L)
                      01845 
                      01846 ;###q   BTFSS   TWOPROBE
                      01847 ;###q   RETURN          ;exit if one probe
                      01848         
03BE   083A           01849 P1CALC  MOVFW   P1EMPTYL        ;Current probe - empty = CALCPx
03BF   0232           01850         SUBWF   TMR1HP1,W
03C0   00D6           01851         MOVWF   CALCP1L
03C1   083B           01852         MOVFW   P1EMPTYH
03C2   3B31           01853         SUBWFB  TMR1UP1,W
03C3   00D5           01854         MOVWF   CALCP1H
                      01855 
03C4   1803           01856         SKPNC
03C5   2BC9           01857         GOTO    P1CALCa
03C6   01D5           01858         CLRF    CALCP1H ;if -VE set to zero
03C7   01D6           01859         CLRF    CALCP1L
03C8   2BD8           01860         GOTO    P1_20PCCALC     ;###j exit routine
                      01861 
03C9   1D54           01862 P1CALCa BTFSS   DRIFTNEG
03CA   2BD0           01863         GOTO    P1SUBDRIFT
03CB   0842           01864 P1ADDDRIFT      MOVFW   AARGB2
03CC   07D6           01865         ADDWF   CALCP1L
03CD   0841           01866         MOVFW   AARGB1
03CE   3DD5           01867         ADDWFC  CALCP1H
03CF   2BD8           01868         GOTO    P1_20PCCALC     ;###j exit routine
                      01869 
03D0   0842           01870 P1SUBDRIFT      MOVFW   AARGB2
03D1   02D6           01871         SUBWF   CALCP1L
03D2   0841           01872         MOVFW   AARGB1
03D3   3BD5           01873         SUBWFB  CALCP1H 
                      01874 
03D4   1803           01875         SKPNC
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 36
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03D5   2BD8           01876         GOTO    P1_20PCCALC     ;###j
03D6   01D5           01877         CLRF    CALCP1H ;if -VE set to zero
03D7   01D6           01878         CLRF    CALCP1L
                      01879 
03D8   12D4           01880 P1_20PCCALC     BCF     OVER20PCCSPAN   ;###j here
03D9   082A           01881         MOVFW   P1SPANATCALL    ;SPAN@CAL/5 (20%)
03DA   00C3           01882         MOVWF   AARGB3
03DB   082B           01883         MOVFW   P1SPANATCALH
03DC   00C2           01884         MOVWF   AARGB2
03DD   01C1           01885         CLRF    AARGB1
03DE   01C0           01886         CLRF    AARGB0
03DF   01C4           01887         CLRF    DIVH
03E0   3005           01888         MOVLW   .5
03E1   00C5           01889         MOVWF   DIVL    
03E2   2234           01890         CALL    UDIV3216L       ;result in AARGB2/3 (H/L)
03E3   0843           01891         MOVFW   AARGB3  ;subract 20% span from current span
03E4   0256           01892         SUBWF   CALCP1L,W
03E5   0842           01893         MOVFW   AARGB2
03E6   3B55           01894         SUBWFB  CALCP1H,W
03E7   1803           01895         SKPNC
03E8   16D4           01896         BSF     OVER20PCCSPAN   ;###j to here
                      01897 
03E9   0867           01898 P2DFCALC        MOVFW   P2DFL   ;constant from EEPROM
03EA   00C5           01899         MOVWF   M1L
03EB   0868           01900         MOVFW   P2DFH
03EC   00C4           01901         MOVWF   M1H
                      01902         
03ED   0862           01903         MOVFW   P0DFL
03EE   00C7           01904         MOVWF   M2L
03EF   0861           01905         MOVFW   P0DFH
03F0   00C6           01906         MOVWF   M2H
                      01907         
03F1   2219           01908         CALL    MULT16X16       ;Result - P1df/2^8 IN AARGB1(H) & AARGB2(L)
                      01909         
03F2   0850           01910 P2CALC  MOVFW   P2EMPTYL        ;Current probe - empty = CALCPx
03F3   0235           01911         SUBWF   TMR1HP2,W
03F4   00D8           01912         MOVWF   CALCP2L
03F5   0851           01913         MOVFW   P2EMPTYH
03F6   3B34           01914         SUBWFB  TMR1UP2,W
03F7   00D7           01915         MOVWF   CALCP2H
                      01916 
03F8   1803           01917         SKPNC
03F9   2BFD           01918         GOTO    P2CALCa
03FA   01D7           01919         CLRF    CALCP2H ;if -VE set to zero
03FB   01D8           01920         CLRF    CALCP2L
03FC   2C0C           01921         GOTO    P2DFCALCEND     ;exit routine
                      01922 
03FD   1D54           01923 P2CALCa BTFSS   DRIFTNEG
03FE   2C04           01924         GOTO    P2SUBDRIFT
03FF   0842           01925 P2ADDDRIFT      MOVFW   AARGB2
0400   07D8           01926         ADDWF   CALCP2L
0401   0841           01927         MOVFW   AARGB1
0402   3DD7           01928         ADDWFC  CALCP2H
0403   2C0C           01929         GOTO    P2DFCALCEND
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 37
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01930 
0404   0842           01931 P2SUBDRIFT      MOVFW   AARGB2
0405   02D8           01932         SUBWF   CALCP2L
0406   0841           01933         MOVFW   AARGB1
0407   3BD7           01934         SUBWFB  CALCP2H 
                      01935 
0408   1803           01936         SKPNC
0409   2C0C           01937         GOTO    P2DFCALCEND
040A   01D7           01938         CLRF    CALCP2H ;if -VE set to zero
040B   01D8           01939         CLRF    CALCP2L
                      01940 
040C   1FF7           01941 P2DFCALCEND     BTFSS   TWOPROBE        ;###q
040D   2C2A           01942         GOTO    SETCURRDIV      ;###q
040E   0857           01943 P2DFCANCENDa    MOVFW   CALCP2H
040F   0458           01944         IORWF   CALCP2L,W
0410   1D03 2C18      01945         BNZ     CALC_CURRDIV
                      01946 
0412   300C           01947 P2ZERO  MOVLW   caldiv12L       ;if P2 zero, use div@cal
0413   2150           01948         CALL    EEREADADRW
0414   00DA           01949         MOVWF   CURRDIVL
0415   214E           01950         CALL    EEREADNEXT
0416   00D9           01951         MOVWF   CURRDIVH
0417   2C32           01952         GOTO    DIVAVERAGE
                      01953 
0418   0856           01954 CALC_CURRDIV    MOVFW   CALCP1L
0419   00C5           01955         MOVWF   M1L
041A   0855           01956         MOVFW   CALCP1H
041B   00C4           01957         MOVWF   M1H     ;CALCP1 to M1           
                      01958 
041C   086A           01959         MOVFW   M12L
041D   00C7           01960         MOVWF   M2L
041E   086B           01961         MOVFW   M12H
041F   00C6           01962         MOVWF   M2H     ;M12 in M2      
                      01963         
0420   2219           01964         CALL    MULT16X16       ;P1 CALC SPAN x M12 result in AARG
                      01965 
0421   0858           01966         MOVFW   CALCP2L
0422   00C5           01967         MOVWF   DIVL
0423   0857           01968         MOVFW   CALCP2H
0424   00C4           01969         MOVWF   DIVH    ;P2 CALC SPAN to DIV
                      01970         
0425   2234           01971         CALL    UDIV3216L       ;((CALC P1 SPAN x M12)/CALC P2 SPAN) - result in lower 2 bytes of AARG
                              
                      01972 
0426   30D0           01973         MOVLW   LOW const3      ;subtract const3 (7.43 x 2^12)= current div
0427   02C3           01974         SUBWF   AARGB3
0428   3064           01975         MOVLW   HIGH const3
0429   3BC2           01976         SUBWFB  AARGB2
                      01977         
042A   3000           01978 SETCURRDIV      MOVLW   onepdivL        ;###q
042B   1BF7           01979         BTFSC   TWOPROBE        ;###q
042C   0843           01980         MOVFW   AARGB3
042D   00DA           01981         MOVWF   CURRDIVL
                      01982 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 38
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

042E   3010           01983         MOVLW   onepdivH        ;###q
042F   1BF7           01984         BTFSC   TWOPROBE        ;###q
0430   0842           01985         MOVFW   AARGB2
0431   00D9           01986         MOVWF   CURRDIVH        ;move result to current div x 2^12      
                      01987 
0432   1ED4           01988 DIVAVERAGE      BTFSS   OVER20PCCSPAN   ;###h altered routine
0433   2492           01989         CALL    RESETSAVETIME   ;set full delay
0434   1AD4           01990         BTFSC   OVER20PCCSPAN   ;###n
0435   2205           01991         CALL    DOAVERAGE
                      01992                         
0436   0856           01993 CALCNEWP1       MOVFW   CALCP1L
0437   00C5           01994         MOVWF   M1L
0438   0855           01995         MOVFW   CALCP1H
0439   00C4           01996         MOVWF   M1H
                      01997         
043A   3000           01998         MOVLW   LOW .4096
043B   00C7           01999         MOVWF   M2L
043C   3010           02000         MOVLW   HIGH .4096
043D   00C6           02001         MOVWF   M2H
                      02002         
043E   2219           02003         CALL    MULT16X16       ;P1 x 2^12
                      02004 
043F   0826           02005 DIVATCAL97      MOVFW   DIVATCALL       ;transfer ###t here
0440   00EE           02006         MOVWF   DIVATCAL97L
0441   0827           02007         MOVFW   DIVATCALH
0442   00EF           02008         MOVWF   DIVATCAL97H
                      02009 
0443   0CEF           02010         RRF     DIVATCAL97H
0444   0CEE           02011         RRF     DIVATCAL97L
0445   0CEF           02012         RRF     DIVATCAL97H
0446   0CEE           02013         RRF     DIVATCAL97L
0447   0CEF           02014         RRF     DIVATCAL97H
0448   0CEE           02015         RRF     DIVATCAL97L
0449   0CEF           02016         RRF     DIVATCAL97H
044A   0CEE           02017         RRF     DIVATCAL97L
044B   0CEF           02018         RRF     DIVATCAL97H
044C   0CEE           02019         RRF     DIVATCAL97L     ;divide by 32   
044D   3007           02020         MOVLW   B'00000111'
044E   05EF           02021         ANDWF   DIVATCAL97H     ;remove any wrapped round bits
                      02022         
044F   086E           02023         MOVFW   DIVATCAL97L     ;subract from DIVATCAL. Result in DIVATCAL97
0450   0226           02024         SUBWF   DIVATCALL,W
0451   00EE           02025         MOVWF   DIVATCAL97L
0452   086F           02026         MOVFW   DIVATCAL97H     
0453   3B27           02027         SUBWFB  DIVATCALH,W
0454   00EF           02028         MOVWF   DIVATCAL97H     ;###t to here
                      02029 
                      02030 
0455   1254           02031 TESTFORLOWDIV   BCF     CDIVISLOW
0456   086E           02032         MOVFW   DIVATCAL97L             ;###t
0457   0228           02033         SUBWF   AVDIVL_OVER20,W
0458   086F           02034         MOVFW   DIVATCAL97H             ;###t
0459   3B29           02035         SUBWFB  AVDIVH_OVER20,W
045A   1C03           02036         SKPC
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 39
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

045B   1654           02037         BSF     CDIVISLOW               
                      02038 
045C   0828           02039         MOVFW   AVDIVL_OVER20   ;###h alteration ###j altered from just AVDIVL
045D   1A54           02040         BTFSC   CDIVISLOW       ;substitute if current div low
045E   086E           02041         MOVFW   DIVATCAL97L     ;###t
                      02042 
045F   1FF7           02043         BTFSS   TWOPROBE        ;###q
0460   3000           02044         MOVLW   onepdivL        ;###q
                      02045 
0461   00AC           02046         MOVWF   DIVUSEDL
0462   00C5           02047         MOVWF   DIVL
                      02048 
0463   0829           02049         MOVFW   AVDIVH_OVER20   ;###j altered from just AVDIVH  
0464   1A54           02050         BTFSC   CDIVISLOW       ;substitute if current div low
0465   086F           02051         MOVFW   DIVATCAL97H     ;###t
                      02052 
0466   1FF7           02053         BTFSS   TWOPROBE        ;###q
0467   3010           02054         MOVLW   onepdivH        ;###q
                      02055 
0468   00AD           02056         MOVWF   DIVUSEDH
0469   00C4           02057         MOVWF   DIVH
                      02058         
046A   2234           02059         CALL    UDIV3216L       ;divide by av12
                      02060         
046B   0843           02061         MOVFW   AARGB3
046C   00ED           02062         MOVWF   PROBE1L         
046D   0842           02063         MOVFW   AARGB2
046E   00EC           02064         MOVWF   PROBE1H
                      02065                 
046F   0008           02066         RETURN
                      02067 
0470   3004           02068 TIMESHIFT       MOVLW   tmr1shift       ;shift selectively into upper bytes     
0471   00C9           02069         MOVWF   LOOPCOUNT
0472   08C9           02070         TSTF    LOOPCOUNT
0473   1903           02071         SKPNZ
0474   0008           02072         RETURN
                      02073         
0475   1003           02074 TSHIFTLOOP      CLRC
0476   0D96           02075         RLF     TMR1L
0477   0D97           02076         RLF     TMR1H
0478   0DB0           02077         RLF     TMR1U
0479   0BC9           02078         DECFSZ  LOOPCOUNT
047A   2C75           02079         GOTO    TSHIFTLOOP      
047B   0008           02080         RETURN
                      02081 
047C   0185           02082 ADDTOTIMEp      CLRF    FSR0H
047D   30A0           02083         MOVLW   TIMEL
047E   0084           02084         MOVWF   FSR0L
047F   0816           02085         MOVFW   TMR1L
0480   0780           02086         ADDWF   INDF0
0481   0A84           02087         INCF    FSR0L
0482   0817           02088         MOVFW   TMR1H
0483   3D80           02089         ADDWFC  INDF0
0484   0A84           02090         INCF    FSR0L
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 40
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0485   0830           02091         MOVFW   TMR1U
0486   3D80           02092         ADDWFC  INDF0
0487   0A84           02093         INCF    FSR0L
0488   0103           02094         CLRW
0489   3D80           02095         ADDWFC  INDF0
048A   0880           02096         TSTF    INDF0
048B   1903           02097         SKPNZ
048C   15D4           02098         BSF     SAVEFLAG
048D   1DD4           02099         BTFSS   SAVEFLAG        ;may have been set elsewhere
048E   0008           02100         RETURN
048F   2324           02101         CALL    STOREAVDIV
0490   11D4           02102         BCF     SAVEFLAG
0491   1754           02103         BSF     SAVEINDICATOR   ;for diagnostics
0492                  02104 RESETSAVETIME   
0492   0021           02105         BANKSEL TIMEUU
0493   3001           02106         MOVLW   .1
0494   00A3           02107         MOVWF   TIMEUU
0495   0020           02108         BANKSEL 0       
0496   0008           02109         RETURN
                      02110 
0497   0185           02111 ADDTOTIMEt      CLRF    FSR0H
0498   30A2           02112         MOVLW   TIMEU
0499   0084           02113         MOVWF   FSR0L
049A   3001           02114         MOVLW   .1      ;add in 65536
049B   0780           02115         ADDWF   INDF0
049C   0A84           02116         INCF    FSR0L
049D   0103           02117         CLRW
049E   3D80           02118         ADDWFC  INDF0
049F   0880           02119         TSTF    INDF0
04A0   1903           02120         SKPNZ
04A1   15D4           02121         BSF     SAVEFLAG
04A2   0008           02122         RETURN
                      02123         
                      02124 ;cold start *****************************************************************
                      02125 
04A3                  02126 CSTART          
04A3   0021           02127         BANKSEL OSCCON
04A4   3070           02128         MOVLW   OSCCONset
04A5   0099           02129         MOVWF   OSCCON  ;set clock
04A6   0020           02130         BANKSEL PORTA
                      02131         
04A7   018C           02132         CLRF    PORTA
                      02133 
                      02134         IFDEF __16F1823
04A8   018E           02135         CLRF    PORTC
                      02136         ENDIF
                      02137         
                      02138         IFDEF __16LF1823
                      02139         CLRF    PORTC
                      02140         ENDIF
                      02141 
04A9   20D7           02142         CALL    SETUP
04AA   018C           02143         CLRF    PORTA
                      02144 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 41
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02145         IFDEF __16F1823
04AB   018E           02146         CLRF    PORTC
                      02147         ENDIF
                      02148         
                      02149         IFDEF __16LF1823
                      02150         CLRF    PORTC
                      02151         ENDIF
                      02152 
04AC   3020           02153         MOVLW           20                      ;clear registers
04AD   0084           02154         MOVWF           FSR0L
04AE   0185           02155         CLRF    FSR0H
04AF   0103           02156 INITLOOP        CLRW
04B0   001A           02157         MOVWI   FSR0++
                      02158 
04B1   307F           02159         MOVLW           B'01111111'             ;if 0 or 80 reached
04B2   0504           02160         ANDWF           FSR0L,W
04B3   1903           02161         SKPNZ
04B4   1684           02162         BSF     FSR0L,5         ;add 20
04B5   30F0           02163         MOVLW   B'11110000'
04B6   0505           02164         ANDWF   FSR0H,W         ;check for >bank 15
04B7   1903           02165         SKPNZ
04B8   2CAF           02166         GOTO    INITLOOP
                      02167         
04B9   20D7           02168         CALL    SETUP
04BA   0AA1           02169         INCF    FLASHER         ;set timer to 1
04BB   14A0           02170         BSF     LCALWAIT
04BC   2148           02171         CALL    INITMR1 
04BD   30C0           02172         MOVLW   INTCONset
04BE   008B           02173         MOVWF   INTCON
                      02174 
04BF   2492           02175         CALL    RESETSAVETIME
                      02176 
                      02177 ;       MOVLW   calstatus
                      02178 ;       MOVWF   EEWRADDRESS     
                      02179 ;       MOVLW   emptydone
                      02180 ;       CALL    EEWRITEW
                      02181 ;       CALL    EEREADSAME
                      02182 ;       MOVWF   CALSTATUS
                      02183 
                      02184 ;       MOVLW   OPspanH ;get op parameters ###j here (REMMING)
                      02185 ;       CALL    EEREADADRW
                      02186 ;       MOVWF   OPSPANHI
                      02187 
                      02188 ;       BCF     OPREVERSE       ;extract reverse flag
                      02189 ;       BTFSC   OPSPANHI,7
                      02190 ;       BSF     OPREVERSE
                      02191         
                      02192 ;       MOVLW   B'00000011'
                      02193 ;       ANDWF   OPSPANHI        ;remove flag
                      02194         
                      02195 ;       CALL    EEREADNEXT
                      02196 ;       MOVWF   OPSPANLO
                      02197 ;       CALL    EEREADNEXT
                      02198 ;       MOVWF   OPOFFSETHI
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 42
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02199 ;       CALL    EEREADNEXT
                      02200 ;       MOVWF   OPOFFSETLO      ;###j to here
                      02201         
04C0   21E1           02202         CALL    AVPRIME 
                      02203         
04C1   234D           02204         CALL    GETP0
04C2   239E           02205         CALL    GETCOMPPROBE
                      02206 
                      02207 
                      02208 
                      02209 ;main ***********************************************************************
                      02210 
                      02211 
04C3   1C20           02212 IDLE    BTFSS   INTDONE
04C4   2CC3           02213         GOTO    IDLE
04C5   0064           02214         CLRWDT
04C6   1020           02215         BCF     INTDONE 
                      02216  
04C7   3023           02217         MOVLW   type    ;get op parameters
04C8   2150           02218         CALL    EEREADADRW
04C9   00F6           02219         MOVWF   TYPE
                      02220         
04CA   302A           02221         MOVLW   advanced        ;get advanced parameters ###6 HERE
04CB   2150           02222         CALL    EEREADADRW
04CC   00F7           02223         MOVWF   ADVANCED
04CD   2084           02224         CALL    COUNTTABLE
04CE   00F8           02225         MOVWF   OPTCOUNT        ;###6 TO HERE
                      02226 
04CF   20CE           02227         CALL    T2SETUP
                      02228 
04D0   12A0           02229         BCF     DRESISTIVE      ;###3 here
04D1   0876           02230         MOVFW   TYPE    ;resistive?
04D2   3978           02231         ANDLW   B'01111000'
04D3   1D03           02232         SKPZ
04D4   16A0           02233         BSF     DRESISTIVE      ;yes ###3 to here
                      02234 
04D5   3001           02235         MOVLW   calstatus
04D6   2150           02236         CALL    EEREADADRW
04D7   00F5           02237         MOVWF   CALSTATUS
                      02238 
                      02239 
04D8   1CA0           02240 LCWAITTEST      BTFSS   LCALWAIT
04D9   2CE8           02241         GOTO    TESTFORHCAL
                      02242 
04DA   080E           02243 TESTFORLCAL     MOVFW   PORTC           ;###USPVOP
04DB   3902           02244         ANDLW   B'00000010'             ;###USBVOP
                      02245         
04DC   1D03 2CE8      02246         BNZ     TESTFORHCAL             ;if no press, goto HCAL test
04DE   08A1           02247         TSTF    FLASHER
04DF   1D03 2D6C      02248         BNZ     SETUNCALOP              ;if switch pressed & LCAL not done, output uncalibrated level
04E1   230D           02249         CALL    GETLCAL
                      02250 
04E2   3000           02251         MOVLW   LOW minpwm              ;set empty level
04E3   00A3           02252         MOVWF   PWML
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 43
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

04E4   3000           02253         MOVLW   HIGH minpwm
04E5   00A4           02254         MOVWF   PWMH
04E6   217B           02255         CALL    PWMSET
04E7   1520           02256         BSF     LCJUSTDONE              ;avoids HCAL starting from LCAL
                      02257         
                      02258                 
04E8   10A0           02259 TESTFORHCAL     BCF     LCALWAIT        
04E9   1C75           02260         BTFSS   EMPTYCAL
04EA   2D6C           02261         GOTO    SETUNCALOP              ;if LCAL not done
                      02262         
04EB   18F5           02263         BTFSC   SPANCAL
04EC   2CFA           02264         GOTO    RPTHCALTEST
                      02265 
04ED   080E           02266         MOVFW   PORTC           ;###USPVOP
04EE   3902           02267         ANDLW   B'00000010'             ;###USBVOP
                      02268 
04EF   1D03 2CF7      02269         BNZ     CLRJUSTDONE             ;if no press, clear JUSTDONE
04F1   1920           02270         BTFSC   LCJUSTDONE
04F2   2CC3           02271         GOTO    IDLE            ;goto idle if key not released
04F3   0AA2           02272         INCF    SWTIMER
04F4   1BA2           02273         BTFSC   SWTIMER,7
04F5   229F           02274         CALL    GETSPANCAL
04F6   2D65           02275         GOTO    SETMIN          ;maintain minimum
                      02276 
04F7   1120           02277 CLRJUSTDONE     BCF     LCJUSTDONE
04F8   01A2           02278 NOSPANCAL       CLRF    SWTIMER
04F9   2CC3           02279         GOTO    IDLE
                      02280 
04FA   080E           02281 RPTHCALTEST     MOVFW   PORTC           ;###USPVOP
04FB   3902           02282         ANDLW   B'00000010'             ;###USBVOP
                      02283 
04FC   1D03 2D05      02284         BNZ     MAINCLRTMR              ;if no press, goto MAIN         
                      02285         
04FE   0AA2           02286         INCF    SWTIMER
04FF   1FA2           02287         BTFSS   SWTIMER,7
0500   2D6C           02288         GOTO    SETUNCALOP              ;revert to uncalibrated value whilst switch is pressed
0501   1DA0           02289         BTFSS   HCJUSTDONE
0502   229F           02290         CALL    GETSPANCAL
0503   15A0           02291         BSF     HCJUSTDONE
0504   2D07           02292         GOTO    MAIN
                      02293         
0505   01A2           02294 MAINCLRTMR      CLRF    SWTIMER         ;clear if no press #
0506   11A0           02295         BCF     HCJUSTDONE
0507   10A0           02296 MAIN    BCF     LCALWAIT
0508   208F           02297         CALL    INTERVALTABLE           ;use programmed value   ###6
0509   0521           02298         ANDWF   FLASHER,W               ;###6
050A   1D03           02299         SKPZ
050B   2CC3           02300         GOTO    IDLE
050C   239E           02301         CALL    GETCOMPPROBE
050D   1B20           02302         BTFSC   COMMSBEENON
050E   2CC3           02303         GOTO    IDLE    ;no update if comms interrupt
                      02304                         
050F   2277           02305         CALL    MT_DF_M_N_DVC
                      02306 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 44
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02307 ;###q   BTFSS   TWOPROBE        ;###8 HERE
                      02308 ;###q   GOTO    MAINa
                      02309 
0510   23A3           02310         CALL    TWOPROBECALC    
                      02311 
                      02312 ;###q here
                      02313 ;       GOTO    ZEROTEST        ;###8 TO HERE
                      02314 
                      02315 ;MAINa  CALL    ONEPDRIFTCALC ;drift factor in AARGB1(H) & AARGB2(L)    
                      02316 
                      02317 ;       MOVFW   P1EMPTYL        ;Current probe - empty = PROBE1x
                      02318 ;       SUBWF   TMR1HP1,W
                      02319 ;       MOVWF   PROBE1L
                      02320 ;       MOVFW   P1EMPTYH
                      02321 ;       SUBWFB  TMR1UP1,W
                      02322 ;       MOVWF   PROBE1H
                      02323 ;       SKPNC
                      02324 ;       GOTO    ONEP1CALCa
                      02325 ;       GOTO    ZEROANDEXIT     ;if -VE set to zero & #EXIT
                      02326 
                      02327 ;ONEP1CALCa     BTFSS   DRIFTNEG
                      02328 ;       GOTO    P1SUBDRIFT
                      02329 ;P1PLUSDRIFT    MOVFW   AARGB2
                      02330 ;       ADDWF   PROBE1L
                      02331 ;       MOVFW   AARGB1
                      02332 ;       ADDWFC  PROBE1H
                      02333 ;       GOTO    ZEROTEST
                      02334 
                      02335 ;P1MINUSDRIFT   MOVFW   AARGB2
                      02336 ;       SUBWF   PROBE1L
                      02337 ;       MOVFW   AARGB1
                      02338 ;       SUBWFB  PROBE1H 
                      02339 ;       SKPNC
                      02340 ;       GOTO    ZEROTEST
                      02341 
                      02342 ;ZEROANDEXIT    CLRF    PROBE1H ;if -VE set to zero
                      02343 ;       CLRF    PROBE1L         
                      02344 ;###q to here
                      02345 
0511   086D           02346 ZEROTEST        MOVFW   PROBE1L 
0512   046C           02347         IORWF   PROBE1H,W
0513   1D03           02348         SKPZ
0514   2D19           02349         GOTO    SPANCALC
                      02350 
0515   01C3           02351 SETSPANZERO     CLRF    AARGB3
0516   01C2           02352         CLRF    AARGB2
0517   21B0           02353         CALL    GETOPPARAM
0518   2D1C           02354         GOTO    REVCHECK
                      02355 
0519   21B0           02356 SPANCALC        CALL    GETOPPARAM
051A   21C2           02357         CALL    CALCMAIN        ;###r was CALCULATE
051B   21CD           02358         CALL    SPANCHECK
                      02359 
051C   1BA0           02360 REVCHECK        BTFSC   OPREVERSE
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 45
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

051D   21D8           02361         CALL    REVERSEPWM
                      02362 
051E   084E           02363 ADDLOWOFFSET    MOVFW   OPOFFSETLO
051F   07C3           02364         ADDWF   AARGB3
0520   084D           02365         MOVFW   OPOFFSETHI
0521   3DC2           02366         ADDWFC  AARGB2
                      02367 
0522   1AA0           02368         BTFSC   DRESISTIVE
0523   2D36           02369         GOTO    SETDRESPWM
                      02370 
0524   0842           02371         MOVFW   AARGB2
0525   00A4           02372         MOVWF   PWMH
0526   0843           02373         MOVFW   AARGB3
0527   00A3           02374         MOVWF   PWML
                      02375 
                      02376 ;GETEEMAX       CLRF    TEMPHI
                      02377 ;       MOVFW   OPSPANLO
                      02378 ;       MOVWF   TEMPLO
                      02379 ;       MOVFW   OPOFFSETLO
                      02380 ;       ADDWF   TEMPLO
                      02381 ;       SKPNC
                      02382 ;       INCF    TEMPHI
                      02383 
                      02384 ;       MOVFW   OPSPANHI
                      02385 ;       ADDWF   TEMPHI
                      02386 ;       MOVFW   OPOFFSETHI
                      02387 ;       ADDWF   TEMPHI
                      02388 
                      02389 ;MAXTEST        MOVFW   TEMPLO          ;VAR2-VAR1
                      02390 ;       SUBWF   PWML,W          ;Note that Z flag
                      02391 ;       MOVFW   TEMPHI          ;is invalid after
                      02392 ;       SKPC                    ;the subtraction.
                      02393 ;       INCFSZ  TEMPHI,W        
                      02394 ;       SUBWF   PWMH,W
                      02395 ;       SKPC
                      02396 ;       GOTO    ABSMAXTEST
                      02397 
                      02398 ;SETEEMAX       MOVFW   TEMPLO  ;set maximum
                      02399 ;       MOVWF   PWML
                      02400 ;       MOVFW   TEMPHI
                      02401 ;       MOVWF   PWMH
                      02402         
0528   0824           02403 ABSMAXTEST      MOVFW   PWMH    ;check for over 1023
0529   39FC           02404         ANDLW   B'11111100'
052A   1903 2D5E      02405         BZ      SETPWM
052C   30FF           02406 SETABSMAX       MOVLW   0FF     ;set maximum
052D   00A3           02407         MOVWF   PWML
052E   3003           02408         MOVLW   03
052F   00A4           02409         MOVWF   PWMH
0530   217B           02410         CALL    PWMSET
0531   30FE           02411         MOVLW   0FE
0532   009B           02412         MOVWF   PR2
0533   218C           02413         CALL    CALCPERCENT     ;###4
0534   235C           02414         CALL    SENDDIAGDATA
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 46
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0535   2CC3           02415         GOTO            IDLE
                      02416 
0536   08C2           02417 SETDRESPWM      TSTF    AARGB2  ;over 255?
0537   1D03           02418         SKPZ
0538   2D53           02419         GOTO    SETRESMAX       ;yes
                      02420         
0539   0843           02421         MOVFW   AARGB3
053A   39FE           02422         ANDLW   B'11111110'     ;check for 1 or 0
053B   1903           02423         SKPNZ                           ;###r was SKPNZ
053C   2D48           02424         GOTO    SETRESMIN       ;for 1/0
                      02425 
                      02426 ;now do the calculation PWM=int(255/resistance multiplier) where resistance multiplier is
                      02427 ;in ACCb(LO/HI) and needs to be stored for later use in ACCd(LO/HI)
                      02428 
                      02429 ;###3   MOVFW   ACCbLO
                      02430 ;###3   MOVWF   ACCdLO
                      02431 ;###3   MOVWF   ACCaLO  ;for resistive div
                      02432 ;###3   MOVFW   ACCbHI
                      02433 ;###3   MOVWF   ACCdHI  ;store multiplier for later
                      02434         
                      02435 ;###3   CALL    RESISTIVEDIV    ;get PWM for CCPR1L     
                      02436 
                      02437 ;calculate PR2 = (PWM * CCPR1) -1
                      02438 
                      02439 ;###3   CALL    RESISTIVEMULT   ;(PWM * CCPR1)
                      02440 ;###3   DECF    ACCaLO  ;-1
                      02441         
                      02442 
                      02443 ;###3   MOVFW   ACCbLO
                      02444 ;###3   BANKSEL CCPR1L
                      02445 ;###3   MOVWF   CCPR1L
                      02446 ;###3   BCF     CCP1CON,4       ;PWM (1-255) in ACCbLO
                      02447 ;###3   BCF     CCP1CON,5
                      02448 ;###3   BANKSEL 0
                      02449 ;###3   MOVFW   ACCaLO
                      02450 ;###3   BANKSEL PR2
                      02451 ;###3   MOVWF   PR2
                      02452 ;###3   BANKSEL 0
                      02453 
053D   3001           02454         MOVLW   .1      ;###3 HERE
053E   0025           02455         BANKSEL CCPR1L
053F   0091           02456         MOVWF   CCPR1L
0540   1213           02457         BCF     CCP1CON,4       ;PWM (1-255) in AARGB3
0541   1293           02458         BCF     CCP1CON,5
0542   0020           02459         BANKSEL 0
0543   0343           02460         DECF    AARGB3,W
0544   009B           02461         MOVWF   PR2     ;###3 TO HERE
0545   218C           02462         CALL    CALCPERCENT     ;###4
0546   235C           02463         CALL    SENDDIAGDATA
0547   2CC3           02464         GOTO    IDLE
                      02465 
0548   3064           02466 SETRESMIN       MOVLW   .100
0549   0025           02467         BANKSEL CCPR1L
054A   0091           02468         MOVWF   CCPR1L
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 47
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

054B   1213           02469         BCF     CCP1CON,4       ;PWM (1-255) in ACCbLO
054C   1293           02470         BCF     CCP1CON,5
054D   0020           02471         BANKSEL 0
054E   3063           02472         MOVLW   .99
054F   009B           02473         MOVWF   PR2
                      02474 ;       BANKSEL 0
0550   218C           02475         CALL    CALCPERCENT     ;###4
0551   235C           02476         CALL    SENDDIAGDATA
0552   2CC3           02477         GOTO    IDLE
                      02478 
0553   3001           02479 SETRESMAX       MOVLW   .1
0554   0025           02480         BANKSEL CCPR1L
0555   0091           02481         MOVWF   CCPR1L
0556   1213           02482         BCF     CCP1CON,4       ;PWM (1-255) in ACCbLO
0557   1293           02483         BCF     CCP1CON,5
0558   0020           02484         BANKSEL 0
0559   30FF           02485         MOVLW   .255    ;was 254 ###3
055A   009B           02486         MOVWF   PR2
                      02487 ;       BANKSEL 0
055B   218C           02488         CALL    CALCPERCENT     ;###4
055C   235C           02489         CALL    SENDDIAGDATA
055D   2CC3           02490         GOTO    IDLE
                      02491         
                      02492 
                      02493 
055E   217B           02494 SETPWM  CALL    PWMSET  ;normal range
055F   0020           02495         BANKSEL 0
0560   30FF           02496         MOVLW   0FF
0561   009B           02497         MOVWF   PR2
                      02498 ;       BANKSEL 0
0562   218C           02499         CALL    CALCPERCENT     ;###4
0563   235C           02500         CALL    SENDDIAGDATA
0564   2CC3           02501         GOTO            IDLE    
                      02502 
0565   1AA0           02503 SETMIN  BTFSC   DRESISTIVE
0566   2D48           02504         GOTO    SETRESMIN       ;different minimum if resistive
0567   084E           02505         MOVFW   OPOFFSETLO      ;set minimum
0568   00A3           02506         MOVWF   PWML
0569   084D           02507         MOVFW   OPOFFSETHI
056A   00A4           02508         MOVWF   PWMH
056B   2D5E           02509         GOTO    SETPWM
                      02510 
056C   3000           02511 SETUNCALOP      MOVLW   LOW uncalpwm    ;set for test
056D   00A3           02512         MOVWF   PWML
056E   3000           02513         MOVLW   HIGH uncalpwm
056F   00A4           02514         MOVWF   PWMH
0570   2D5E           02515         GOTO    SETPWM
                      02516 
                      02517                 
0571                  02518 GETRVOLTAGE                     ;voltage for resistive op
0571   0021           02519         BANKSEL ADCON0
0572   3011           02520         MOVLW   ADCON0setRV
0573   009D           02521         MOVWF   ADCON0
0574   3006           02522 ADCMAIN MOVLW   ADwait  ;delay in uSec (20MHz)
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 48
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0575   00C9           02523         MOVWF   LOOPCOUNT
0576   2D77           02524 DELAYLOOP       GOTO    ($+1)
0577   0BC9           02525         DECFSZ  LOOPCOUNT
0578   2D76           02526         GOTO    DELAYLOOP
0579   149D           02527         BSF     ADCON0,ADGO     ;start conversion
057A   0063           02528         SLEEP           ;workaround for silicon Iss.6
057B   0000           02529         NOP
057C   1311           02530         BCF     PIE1,ADIE       ;clear interrupt
                      02531 
                      02532 ;       BTFSC   ADCON0,ADGO
                      02533 ;       GOTO    ($-1)
057D   081B           02534         MOVFW   ADRESL
057E   00FF           02535         MOVWF   TEMPLO
057F   081C           02536         MOVFW   ADRESH
0580   00FE           02537         MOVWF   TEMPHI
0581   0020           02538         BANKSEL 0
0582   0008           02539         RETURN
                      02540 
                      02541 ;init eeprom ****************************************************************
                      02542 
                      02543 ; The 12F1822 & 16F1823 have 256 bytes of non-volatile EEPROM, starting at address 0xF000
                      02544  
                      02545 
F000                  02546 DATAEE          ORG  0xF000
                      02547 
                      02548 
  000010CD            02549 simdiv  equ     .4301   ;1.05 x 4096
                      02550 
                      02551 ;       DE      0,03,0EC,0,00,00,37,06,LOW simdiv,HIGH simdiv   ;simulates programmed (LO-HI)for P1 on
                             emulator 8K
                      02552 
                      02553 ;       DE      0,03,92,0B,0A6,0A,37,06,LOW simdiv,HIGH simdiv  ;simulates programmed (LO-HI)for P2 on
                             emulator 8K
                      02554 
                      02555 ;       DE      0,3,.1,1,.2,1,.3,1,.4,1,.5,1,LOW simdiv,HIGH simdiv,.7,1
                      02556 
                      02557         IF (SETFORTEST==1)
                      02558 
                      02559         DE      0,03,75,69,0A,6E,14,09          ;EMPTY CAL
                      02560         DE      68,77,49,7B,4E,10,071,0E,5F,80,4E,10    ;SPANCAL
                      02561 
                      02562         ELSE
                      02563 
F000   0000 0000 0000 02564         DE      0,0,0,0,0,0,0,0,0,0
       0000 0000 0000 
       0000 0000 0000 
       0000 
F00A   0000 0000 0000 02565         DE      0,0,0,0,0,0,0,0,0,0
       0000 0000 0000 
       0000 0000 0000 
       0000 
                      02566         
                      02567         ENDIF
                      02568 
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 49
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

F014   0000 0000 0000 02569         DE      0,0,0,0,0,0,0,0,0,0
       0000 0000 0000 
       0000 0000 0000 
       0000 
                      02570 
F020                  02571         ORG     0xF000 + .32
                      02572 
F020   0000 0000 0000 02573         DE      0,0,0,0,0,0,0,0,0,0
       0000 0000 0000 
       0000 0000 0000 
       0000 
F02A   0000 0000 0000 02574         DE      0,0,0,0,0,0,0,0
       0000 0000 0000 
       0000 0000 
                      02575         
                      02576 ;       DE      0,0,0                   ;DATE
                      02577 ;       DE      .1                      ;TYPE - V=1, I=2, RA=4, RD1=8, RD2=16, RD3=32, RD4=64
                      02578 ;       DE      (HIGH .1000), LOW .1000         ;SPAN (add 128 to high for reverse)     
                      02579 ;       DE      HIGH .0, LOW .0         ;OFFSET MIN - 0V, 4mA
                      02580 
                      02581 ;       DE      (.128 + .75)                    ;ALARM LEVEL H (ON ABOVE 75%)
                      02582 ;       DE      .25                     ;ALARM LEVEL L (25%)    
                      02583 ;       DE      B'10010111'                     ;ADVANCED DATA BITS: 7(2probe=1), 5:4(samp.interval), 
                            0:2(count)
                      02584 
F032                  02585         ORG     0xF000 + .50
                      02586 
F032   0066 0001      02587         DE      LOW defp1df, HIGH defp1df
F034   000D 0001      02588         DE      LOW defp2df, HIGH defp2df
F036   0002           02589         DE      defaultn
                      02590 
                      02591         END
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 50
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

AARGB0                            00000040
AARGB1                            00000041
AARGB2                            00000042
AARGB3                            00000043
ABDEN                             00000000
ABDOVF                            00000007
ABSMAXTEST                        00000528
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACKTIM                            00000007
ADCMAIN                           00000574
ADCON0                            0000009D
ADCON0set                         00000000
ADCON0setRV                       00000011
ADCON1                            0000009E
ADCON1set                         000000A0
ADCS0                             00000004
ADCS1                             00000005
ADCS2                             00000006
ADD1                              00000271
ADDEN                             00000003
ADDLOWOFFSET                      0000051E
ADDM2TOTOTAL                      00000223
ADDTOTIMEp                        0000047C
ADDTOTIMEt                        00000497
ADFM                              00000007
ADFVR0                            00000000
ADFVR1                            00000001
ADGO                              00000001
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADPREF0                           00000000
ADPREF1                           00000001
ADRES                             0000009B
ADRESH                            0000009C
ADRESL                            0000009B
ADVANCED                          00000077
ADwait                            00000006
AHEN                              00000001
ALARMLEVHI                        00000052
ALARMLEVLO                        00000053
ALARMONatHI                       GENSTA1,1
ALARMOP                           PORTC,4
ALARMOPFLAG                       GENSTA1,0
AN0                               00000000
AN1                               00000001
AN2                               00000002
AN3                               00000004
AN4                               00000000
AN5                               00000001
AN6                               00000002
AN7                               00000003
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 51
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

ANSA0                             00000000
ANSA1                             00000001
ANSA2                             00000002
ANSA4                             00000004
ANSC0                             00000000
ANSC1                             00000001
ANSC2                             00000002
ANSC3                             00000003
ANSELA                            0000018C
ANSELAset                         00000000
ANSELC                            0000018E
ANSELCset                         00000001
APFCON                            0000011D
APFCON0                           0000011D
APFCONset                         00000084
AVDIVH                            0000005C
AVDIVH_OVER20                     00000029
AVDIVL                            0000005D
AVDIVL_OVER20                     00000028
AVDIVU                            0000005B
AVPRIME                           000001E1
AVREGH                            0000005F
AVREGL                            00000060
AVREGU                            0000005E
BAUDCON                           0000019F
BAUDCONset                        00000008
BCL1IE                            00000003
BCL1IF                            00000003
BF                                00000000
BOEN                              00000004
BORCON                            00000116
BORCONset                         00000000
BORRDY                            00000000
BRG16                             00000003
BRGH                              00000002
BSR                               00000008
BSR0                              00000000
BSR1                              00000001
BSR2                              00000002
BSR3                              00000003
BSR4                              00000004
BSR_SHAD                          00000FE6
C                                 00000000
C12IN0N                           00000001
C12IN1N                           00000001
C12IN2N                           00000002
C12IN3N                           00000003
C1HYS                             00000001
C1IE                              00000005
C1IF                              00000005
C1INP                             00000000
C1INTN                            00000006
C1INTP                            00000007
C1NCH0                            00000000
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 52
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

C1NCH1                            00000001
C1OE                              00000005
C1ON                              00000007
C1OUT_CM1CON0                     00000006
C1OUT_PORTA                       00000002
C1PCH0                            00000004
C1PCH1                            00000005
C1POL                             00000004
C1SP                              00000002
C1SYNC                            00000000
C2HYS                             00000001
C2IE                              00000006
C2IF                              00000006
C2INP                             00000000
C2INTN                            00000006
C2INTP                            00000007
C2NCH0                            00000000
C2NCH1                            00000001
C2OE                              00000005
C2ON                              00000007
C2OUT_CM2CON0                     00000006
C2OUT_PORTC                       00000004
C2PCH0                            00000004
C2PCH1                            00000005
C2POL                             00000004
C2SP                              00000002
C2SYNC                            00000000
CALCDIVATCAL                      000002D4
CALCMAIN                          000001C2
CALCNEWP1                         00000436
CALCP1H                           00000055
CALCP1L                           00000056
CALCP1SPAN                        000002F1
CALCP2H                           00000057
CALCP2L                           00000058
CALCPERCENT                       0000018C
CALCPERCENTa                      00000192
CALC_CURRDIV                      00000418
CALSTATUS                         00000075
CCP1                              00000005
CCP1AS                            00000295
CCP1AS0                           00000004
CCP1AS1                           00000005
CCP1AS2                           00000006
CCP1ASE                           00000007
CCP1AScon                         00000000
CCP1CON                           00000293
CCP1CONset                        0000000C
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 53
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

CCP1SEL                           00000000
CCPR1H                            00000292
CCPR1L                            00000291
CDAFVR0                           00000002
CDAFVR1                           00000003
CDIVISLOW                         GENSTA1,4
CFGS                              00000006
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CHS4                              00000006
CKE                               00000006
CKP                               00000004
CK_PORTA                          00000000
CK_PORTC                          00000004
CLKIN                             00000005
CLKOUT                            00000004
CLKR                              00000004
CLKRCON                           0000039A
CLKRDC0                           00000003
CLKRDC1                           00000004
CLKRDIV0                          00000000
CLKRDIV1                          00000001
CLKRDIV2                          00000002
CLKREN                            00000007
CLKROE                            00000006
CLKRSLR                           00000005
CLRJUSTDONE                       000004F7
CLRKRCON                          00000000
CM1CON0                           00000111
CM1CON0set                        00000000
CM1CON1                           00000112
CM1CON1set                        00000000
CM2CON0                           00000113
CM2CON0set                        00000000
CM2CON1                           00000114
CM2CON1set                        00000000
CMOUT                             00000115
COMMSBEENON                       GENSTA0,6
COMMSTIMEOUT                      0000001E
COMMTEST                          00000021
CONVPWMTOSEND                     00000384
COUNTTABLE                        00000084
CPS0                              00000000
CPS1                              00000001
CPS2                              00000002
CPS3                              00000004
CPS4                              00000000
CPS5                              00000001
CPS6                              00000002
CPS7                              00000003
CPSCH0                            00000000
CPSCH1                            00000001
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 54
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

CPSCH2                            00000002
CPSCH3                            00000003
CPSCON0                           0000001E
CPSCON0set                        00000000
CPSCON1                           0000001F
CPSCON1set                        00000000
CPSON                             00000007
CPSOUT                            00000001
CPSRM                             00000006
CPSRNG0                           00000002
CPSRNG1                           00000003
CREN                              00000004
CSRC                              00000007
CSTART                            000004A3
CURRDIVH                          00000059
CURRDIVL                          0000005A
C_SHAD                            00000000
DACCON0                           00000118
DACCON0set                        00000000
DACCON1                           00000119
DACCON1set                        00000000
DACEN                             00000007
DACLPS                            00000006
DACOE                             00000005
DACOUT                            00000000
DACPSS0                           00000002
DACPSS1                           00000003
DACR0                             00000000
DACR1                             00000001
DACR2                             00000002
DACR3                             00000003
DACR4                             00000004
DATAEE                            0000F000
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC_SHAD                           00000001
DELAY                             0000003E
DELAYLOOP                         00000576
DHEN                              00000000
DIAGNCHECK                        0000005B
DIVATCAL97                        0000043F
DIVATCAL97H                       0000006F
DIVATCAL97L                       0000006E
DIVATCALH                         00000027
DIVATCALL                         00000026
DIVAVERAGE                        00000432
DIVH                              00000044
DIVL                              00000045
DIVUSEDH                          0000002D
DIVUSEDL                          0000002C
DOAVERAGE                         00000205
DOAVERAGEa                        0000020C
DOCOMMS                           0000003D
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 55
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

DRESISTIVE                        GENSTA0,5
DRIFTNEG                          GENSTA1,2
DT_PORTA                          00000001
DT_PORTC                          00000005
D_NOT_A                           00000005
ECCP1AS                           00000295
EEADR                             00000191
EEADRH                            00000192
EEADRL                            00000191
EECON1                            00000195
EECON1set                         00000000
EECON2                            00000196
EECON2set                         00000000
EEDAT                             00000193
EEDATH                            00000194
EEDATL                            00000193
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
EEREADADRW                        00000150
EEREADNEXT                        0000014E
EEREADSAME                        00000152
EEWRADDRESS                       00000074
EEWRITEMAIN                       00000171
EEWRITEW                          00000160
EEWRITEWNEXT                      0000015C
EEWRSETUP                         00000164
EMPTYCAL                          CALSTATUS,0
ENABLEINT                         INTCON,7
ENPROBE                           PORTC,3
ENREF_P2                          PORTC,2
EXTRACTAVDIV                      000001F6
EXTRACTLOOP                       000001FE
F                                 00000001
FAULT                             GENSTA0,4
FERR                              00000002
FLAGS232                          00000073
FLASHER                           00000021
FLT0                              00000002
FREE                              00000004
FSR0                              00000004
FSR0H                             00000005
FSR0H_SHAD                        00000FE9
FSR0L                             00000004
FSR0L_SHAD                        00000FE8
FSR1                              00000006
FSR1H                             00000007
FSR1H_SHAD                        00000FEB
FSR1L                             00000006
FSR1L_SHAD                        00000FEA
FVRCON                            00000117
FVRCONset                         00000000
FVREN                             00000007
FVRRDY                            00000006
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 56
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

GCEN                              00000007
GENSTA0                           00000020
GENSTA1                           00000054
GETCOMPPROBE                      0000039E
GETEESTORE                        00000061
GETHIGHLEVEL                      000002A2
GETLCAL                           0000030D
GETLOWLEVEL                       000002AF
GETOPPARAM                        000001B0
GETP0                             0000034D
GETP1                             0000033C
GETP2                             0000032B
GETRVOLTAGE                       00000571
GETSPANCAL                        0000029F
GETTINGP0                         TASKFLAGS,0
GETTINGP1                         TASKFLAGS,1
GETTINGP2                         TASKFLAGS,2
GIE                               00000007
GO                                00000001
GOTADDR                           FLAGS232,2
GO_NOT_DONE                       00000001
HCJUSTDONE                        GENSTA0,3
HFIOFL                            00000003
HFIOFR                            00000004
HFIOFS                            00000000
IDLE                              000004C3
INCPOINTER                        00000254
INDF0                             00000000
INDF1                             00000001
INITLOOP                          000004AF
INITMR1                           00000148
INNERLOOP                         00000246
INTCON                            0000000B
INTCONset                         000000C0
INTDONE                           GENSTA0,0
INTE                              00000004
INTEDG                            00000006
INTEND                            0000007F
INTENDNOFLAG                      00000082
INTERVALTABLE                     0000008F
INTF                              00000001
IOCAF                             00000393
IOCAF0                            00000000
IOCAF1                            00000001
IOCAF2                            00000002
IOCAF3                            00000003
IOCAF4                            00000004
IOCAF5                            00000005
IOCAN                             00000392
IOCAN0                            00000000
IOCAN1                            00000001
IOCAN2                            00000002
IOCAN3                            00000003
IOCAN4                            00000004
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 57
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

IOCAN5                            00000005
IOCANset                          00000000
IOCAP                             00000391
IOCAP0                            00000000
IOCAP1                            00000001
IOCAP2                            00000002
IOCAP3                            00000003
IOCAP4                            00000004
IOCAP5                            00000005
IOCAPset                          00000000
IOCIE                             00000003
IOCIF                             00000000
IRCF0                             00000003
IRCF1                             00000004
IRCF2                             00000005
IRCF3                             00000006
LASTPART                          00000260
LATA                              0000010C
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA4                             00000004
LATA5                             00000005
LATC                              0000010E
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC3                             00000003
LATC4                             00000004
LATC5                             00000005
LCALWAIT                          GENSTA0,1
LCJUSTDONE                        GENSTA0,2
LCWAITTEST                        000004D8
LFIOFR                            00000001
LOOPCOUNT                         00000049
LOOPU3216A                        00000248
LSB                               00000000
LWLO                              00000005
M12CAL                            000002B8
M12H                              0000006B
M12L                              0000006A
M1H                               00000044
M1L                               00000045
M2H                               00000046
M2L                               00000047
MAIN                              00000507
MAINCLRTMR                        00000505
MAININT                           0000007F
MATHSTEMP                         00000048
MC1OUT                            00000000
MC2OUT                            00000001
MDBIT                             00000000
MDCARH                            0000039F
MDCARHset                         00000000
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 58
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

MDCARL                            0000039E
MDCARLset                         00000000
MDCH0                             00000000
MDCH1                             00000001
MDCH2                             00000002
MDCH3                             00000003
MDCHODIS                          00000007
MDCHPOL                           00000006
MDCHSYNC                          00000005
MDCIN1                            00000002
MDCIN2                            00000005
MDCL0                             00000000
MDCL1                             00000001
MDCL2                             00000002
MDCL3                             00000003
MDCLODIS                          00000007
MDCLPOL                           00000006
MDCLSYNC                          00000005
MDCON                             0000039C
MDCONset                          00000000
MDEN                              00000007
MDMIN                             00000003
MDMS0                             00000000
MDMS1                             00000001
MDMS2                             00000002
MDMS3                             00000003
MDMSODIS                          00000007
MDOE                              00000006
MDOPOL                            00000004
MDOUT_MDCON                       00000003
MDOUT_PORTC                       00000004
MDSLR                             00000005
MDSRC                             0000039D
MDSRCset                          00000000
MFIOFR                            00000002
MSB                               00000007
MT_DF_M_N_DVC                     00000277
MULT16X16                         00000219
MULT16X16LOOP                     0000021F
MULTCOUNT                         0000003C
NAVCOUNT                          00000069
NOSPANCAL                         000004F8
NOTT0INT                          00000019
NOT_BOR                           00000000
NOT_DONE                          00000001
NOT_MCLR                          00000003
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RI                            00000002
NOT_RMCLR                         00000003
NOT_SS                            00000003
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_WPUEN                         00000007
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 59
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

OERR                              00000001
OLOOPCOUNT                        0000004A
ONEPDRIFTCALC                     000003A3
OPALARM                           0000004F
OPOFFSETHI                        0000004D
OPOFFSETLO                        0000004E
OPREVERSE                         GENSTA0,7
OPSPANHI                          0000004B
OPSPANLO                          0000004C
OPTCOUNT                          00000078
OPTION_REG                        00000095
OPTsetPS128                       00000066
OPTsetPS16                        00000063
OPTsetPS2                         00000060
OPTsetPS32                        00000064
OPTsetPS4                         00000061
OPTsetPS512                       00000067
OPTsetPS64                        00000065
OPTsetPS8                         00000062
OPTsetT0wait                      00000060
OPalarmH                          00000028
OPalarmL                          00000029
OPminoffsetH                      00000026
OPminoffsetL                      00000027
OPspanH                           00000024
OPspanL                           00000025
OSC1                              00000005
OSC2                              00000004
OSCCON                            00000099
OSCCONset                         00000070
OSCSTAT                           0000009A
OSCTUNE                           00000098
OSFIE                             00000007
OSFIF                             00000007
OSTS                              00000005
OVER20PCCSPAN                     GENSTA1,5
P                                 00000004
P0DFH                             00000061
P0DFL                             00000062
P0DFNEGATIVE                      000003AE
P0EMPTYH                          00000064
P0EMPTYL                          00000063
P0emptyH                          00000007
P0emptyL                          00000006
P1A                               00000005
P1ADDDRIFT                        000003CB
P1B                               00000004
P1BSEL                            00000001
P1C                               00000003
P1CALC                            000003BE
P1CALCa                           000003C9
P1D                               00000002
P1DC0                             00000000
P1DC1                             00000001
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 60
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

P1DC2                             00000002
P1DC3                             00000003
P1DC4                             00000004
P1DC5                             00000005
P1DC6                             00000006
P1DFCALC                          000003B5
P1DFH                             00000066
P1DFL                             00000065
P1EMPTYH                          0000003B
P1EMPTYL                          0000003A
P1M0                              00000006
P1M1                              00000007
P1RSEN                            00000007
P1SPANATCALH                      0000002B
P1SPANATCALL                      0000002A
P1SUBDRIFT                        000003D0
P1_20PCCALC                       000003D8
P1calspanH                        0000000F
P1calspanL                        0000000E
P1dfH                             00000033
P1dfL                             00000032
P1emptyH                          00000003
P1emptyL                          00000002
P1fullH                           00000009
P1fullL                           00000008
P2ADDDRIFT                        000003FF
P2CALC                            000003F2
P2CALCa                           000003FD
P2DFCALC                          000003E9
P2DFCALCEND                       0000040C
P2DFCANCENDa                      0000040E
P2DFH                             00000068
P2DFL                             00000067
P2EMPTYH                          00000051
P2EMPTYL                          00000050
P2SUBDRIFT                        00000404
P2ZERO                            00000412
P2dfH                             00000035
P2dfL                             00000034
P2emptyH                          00000005
P2emptyL                          00000004
P2fullH                           0000000B
P2fullL                           0000000A
PCIE                              00000006
PCL                               00000002
PCLATH                            0000000A
PCLATH_SHAD                       00000FE7
PCON                              00000096
PCONset                           00000010
PEIE                              00000006
PEN                               00000002
PIE1                              00000091
PIE1set                           00000001
PIE2                              00000092
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 61
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

PIE2set                           00000000
PIR1                              00000011
PIR2                              00000012
PLLR                              00000006
PORTA                             0000000C
PORTC                             0000000E
PR2                               0000001B
PR2set                            00000000
PRIMELOOP                         000001EF
PROBE1H                           0000006C
PROBE1L                           0000006D
PROCESS232                        00000066
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSS1AC0                           00000002
PSS1AC1                           00000003
PSS1BD0                           00000000
PSS1BD1                           00000001
PSTR1CON                          00000296
PSTR1CONset                       00000001
PWM1CON                           00000294
PWM1CONset                        00000000
PWMH                              00000024
PWML                              00000023
PWMSET                            0000017B
PWMTEMP                           00000025
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RAWP1SPANCAL                      000002B0
RAWP2SPANCAL                      000002B4
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RCEN                              00000003
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCREG                             00000199
RCSTA                             0000019D
RCSTAset                          00000090
RD                                00000000
READ232                           FLAGS232,1
READ232DO                         0000006A
READCHECK                         00000051
READSTART                         00000055
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 62
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

REMB0                             00000046
REMB1                             00000047
RESETSAVETIME                     00000492
REVCHECK                          0000051C
REVERSEPWM                        000001D8
ROTATE1                           00000265
ROTATE32                          0000022B
ROTATE32a                         0000022E
RPTHCALTEST                       000004FA
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
RXDTSEL                           00000007
RXREG                             00000071
RXTXCOUNT                         00000072
RX_PORTA                          00000001
RX_PORTC                          00000005
R_NOT_W                           00000002
S                                 00000003
SAVEFLAG                          GENSTA1,3
SAVEINDICATOR                     GENSTA1,6
SAVELCAL                          00000311
SAVELCALa                         00000322
SAVEP12FULL                       000002A5
SAVESPANEND                       00000304
SAVESPANENDa                      00000309
SBCDE                             00000002
SBOREN                            00000007
SCIE                              00000005
SCK                               00000000
SCKP                              00000004
SCL                               00000000
SCS0                              00000000
SCS1                              00000001
SDA                               00000001
SDAHT                             00000003
SDI                               00000001
SDO1SEL                           00000006
SDOSEL                            00000006
SDO_PORTA                         00000004
SDO_PORTC                         00000002
SEN                               00000000
SENDB                             00000003
SENDDIAGDATA                      0000035C
SENDEESTORE                       0000009E
SENDPARAMS                        TASKFLAGS,5
SENDPWM_PR2                       0000038F
SENDTXW                           00000098
SETABSMAX                         0000052C
SETALARMOPHI                      000001A6
SETALARMOPLO                      000001AB
SETALOPFLAG                       0000019C
SETCURRDIV                        0000042A
SETDRESPWM                        00000536
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 63
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

SETFORTEST                        00000000
SETMAXSPAN                        000001D3
SETMIN                            00000565
SETPWM                            0000055E
SETRESMAX                         00000553
SETRESMIN                         00000548
SETSPANZERO                       00000515
SETUNCALOP                        0000056C
SETUP                             000000D7
SETUPB0                           000000D7
SETUPB1                           000000E6
SETUPB2                           000000FB
SETUPB3                           00000112
SETUPB4                           00000125
SETUPB5                           00000136
SETUPB7                           00000141
SMP                               00000007
SPANCAL                           CALSTATUS,1
SPANCALC                          00000519
SPANCHECK                         000001CD
SPBRG                             0000019B
SPBRGH                            0000019C
SPBRGHset                         00000002
SPBRGL                            0000019B
SPBRGLset                         00000008
SPEN                              00000007
SPLLEN                            00000007
SRCLK0                            00000004
SRCLK1                            00000005
SRCLK2                            00000006
SRCON0                            0000011A
SRCON0set                         00000000
SRCON1                            0000011B
SRCON1set                         00000000
SREN                              00000005
SRI                               00000001
SRLEN                             00000007
SRNQ                              00000004
SRNQEN                            00000002
SRPR                              00000000
SRPS                              00000001
SRQ                               00000002
SRQEN                             00000003
SRRC1E                            00000000
SRRC2E                            00000001
SRRCKE                            00000002
SRRPE                             00000003
SRSC1E                            00000004
SRSC2E                            00000005
SRSCKE                            00000006
SRSPE                             00000007
SS1SEL                            00000005
SSP1ADD                           00000212
SSP1ADDset                        00000000
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 64
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

SSP1BUF                           00000211
SSP1CON1                          00000215
SSP1CON1set                       00000000
SSP1CON2                          00000216
SSP1CON2set                       00000000
SSP1CON3                          00000217
SSP1CON3set                       00000000
SSP1IE                            00000003
SSP1IF                            00000003
SSP1MSK                           00000213
SSP1MSKset                        00000000
SSP1STAT                          00000214
SSP1STATset                       00000000
SSPADD                            00000212
SSPBUF                            00000211
SSPCON                            00000215
SSPCON1                           00000215
SSPCON2                           00000216
SSPCON3                           00000217
SSPEN                             00000005
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPMSK                            00000213
SSPOV                             00000006
SSPSTAT                           00000214
SSSEL                             00000005
STATUS                            00000003
STATUS_SHAD                       00000FE4
STKOVF                            00000007
STKPTR                            00000FED
STKUNF                            00000006
STOREAVDIV                        00000324
STOREDIVATCAL                     000002E2
STOREM12                          000002CE
STOREP1SPAN                       000002FE
STR1A                             00000000
STR1B                             00000001
STR1C                             00000002
STR1D                             00000003
STR1SYNC                          00000004
SUB1                              0000026B
SWAPPROBEPINS                     00000001
SWDTEN                            00000000
SWTIMER                           00000022
SYNC                              00000004
T0CKI                             00000002
T0COUNTING                        TASKFLAGS,3
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T0SYNCH                           00000025
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 65
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

T0WAITSTART                       TASKFLAGS,4
T0XCS                             00000000
T1CKI                             00000005
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000018
T1CONset                          00000001
T1GCON                            00000019
T1GCONset                         00000000
T1GGO                             00000003
T1GGO_NOT_DONE                    00000003
T1GPOL                            00000006
T1GSEL                            00000003
T1GSPM                            00000004
T1GSS0                            00000000
T1GSS1                            00000001
T1GTM                             00000005
T1GVAL                            00000002
T1OSCEN                           00000003
T1OSCR                            00000007
T1OSI                             00000005
T1OSO                             00000004
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             0000001C
T2CONsetPS1                       00000004
T2CONsetPS16                      00000006
T2CONsetPS4                       00000005
T2CONsetPS64                      00000007
T2OUTPS0                          00000003
T2OUTPS1                          00000004
T2OUTPS2                          00000005
T2OUTPS3                          00000006
T2SETUP                           000000CE
TASKFLAGS                         00000070
TEMPHI                            0000007E
TEMPLO                            0000007F
TEST                              0000002F
TESTFORHCAL                       000004E8
TESTFORLCAL                       000004DA
TESTFORLOWDIV                     00000455
TESTSENDTXW                       00000096
TIMEH                             000000A1
TIMEL                             000000A0
TIMESHIFT                         00000470
TIMEU                             000000A2
TIMEUU                            000000A3
TMR0                              00000015
TMR0CS                            00000005
TMR0IE                            00000005
TMR0IF                            00000002
TMR0SE                            00000004
TMR1                              00000016
TMR1CS0                           00000006
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 66
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

TMR1CS1                           00000007
TMR1GE                            00000007
TMR1GIE                           00000007
TMR1GIF                           00000007
TMR1H                             00000017
TMR1HP0                           00000038
TMR1HP1                           00000032
TMR1HP2                           00000035
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             00000016
TMR1LP0                           00000039
TMR1LP1                           00000033
TMR1LP2                           00000036
TMR1ON                            00000000
TMR1U                             00000030
TMR1UP0                           00000037
TMR1UP1                           00000031
TMR1UP2                           00000034
TMR2                              0000001A
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOSH                              00000FEF
TOSL                              00000FEE
TRANSFERP0                        00000354
TRANSFERP1                        00000345
TRANSFERP2                        00000334
TRANSIFOVER20                     00000206
TRISA                             0000008C
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISAset                          000000FE
TRISC                             0000008E
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISCset                          000000C3
TRMT                              00000001
TSEN                              00000005
TSHIFTLOOP                        00000475
TSRNG                             00000004
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 67
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

TUN5                              00000005
TWOPROBE                          ADVANCED,7
TWOPROBECALC                      000003A3
TX9                               00000006
TX9D                              00000000
TXBYTE                            0000003F
TXCKSEL                           00000002
TXCOUNT                           0000003D
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             0000019A
TXSTA                             0000019E
TXSTAset                          00000024
TX_PORTA                          00000000
TX_PORTC                          00000004
TYPE                              00000076
UA                                00000001
UADD3216A                         0000024D
UADD3216B                         0000025B
UDIV3216L                         00000234
UOK3216A                          0000024E
UOK3216B                          0000025C
W                                 00000000
WCOL                              00000007
WDTCON                            00000097
WDTCONset                         0000001C
WDTPS0                            00000001
WDTPS1                            00000002
WDTPS2                            00000003
WDTPS3                            00000004
WDTPS4                            00000005
WPUA                              0000020C
WPUA0                             00000000
WPUA1                             00000001
WPUA2                             00000002
WPUA3                             00000003
WPUA4                             00000004
WPUA5                             00000005
WPUAset                           00000003
WPUC                              0000020E
WPUC0                             00000000
WPUC1                             00000001
WPUC2                             00000002
WPUC3                             00000003
WPUC4                             00000004
WPUC5                             00000005
WPUCset                           00000000
WR                                00000001
WREG                              00000009
WREG_SHAD                         00000FE5
WREN                              00000002
WRERR                             00000003
WRITE232                          FLAGS232,0
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 68
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

WRITE232DO                        0000006E
WRITE232DOa                       00000077
WRITECHECK                        00000047
WRITESTART                        0000004B
WUE                               00000001
Z                                 00000002
ZEROTEST                          00000511
Z_SHAD                            00000002
_BOREN_NSLEEP                     0000FDFF
_BOREN_OFF                        0000F9FF
_BOREN_ON                         0000FFFF
_BOREN_SBODEN                     0000FBFF
_BORV_HI                          0000FBFF
_BORV_LO                          0000FFFF
_C                                STATUS,C
_CLKOUTEN_OFF                     0000FFFF
_CLKOUTEN_ON                      0000F7FF
_CONFIG1                          00008007
_CONFIG2                          00008008
_CPD_OFF                          0000FFFF
_CPD_ON                           0000FEFF
_CP_OFF                           0000FFFF
_CP_ON                            0000FF7F
_DEVID1                           00008006
_FCMEN_OFF                        0000DFFF
_FCMEN_ON                         0000FFFF
_FOSC_ECH                         0000FFFF
_FOSC_ECL                         0000FFFD
_FOSC_ECM                         0000FFFE
_FOSC_EXTRC                       0000FFFB
_FOSC_HS                          0000FFFA
_FOSC_INTOSC                      0000FFFC
_FOSC_LP                          0000FFF8
_FOSC_XT                          0000FFF9
_IDLOC0                           00008000
_IDLOC1                           00008001
_IDLOC2                           00008002
_IDLOC3                           00008003
_IESO_OFF                         0000EFFF
_IESO_ON                          0000FFFF
_LVP_OFF                          0000DFFF
_LVP_ON                           0000FFFF
_MCLRE_OFF                        0000FFBF
_MCLRE_ON                         0000FFFF
_PLLEN_OFF                        0000FEFF
_PLLEN_ON                         0000FFFF
_PWRTE_OFF                        0000FFFF
_PWRTE_ON                         0000FFDF
_STVREN_OFF                       0000FDFF
_STVREN_ON                        0000FFFF
_WDTE_NSLEEP                      0000FFF7
_WDTE_OFF                         0000FFE7
_WDTE_ON                          0000FFFF
_WDTE_SWDTEN                      0000FFEF
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 69
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

_WRT_ALL                          0000FFFC
_WRT_BOOT                         0000FFFE
_WRT_HALF                         0000FFFD
_WRT_OFF                          0000FFFF
__16F1823                         00000001
advanced                          0000002A
boo                               000F4240
caldiv12H                         0000000D
caldiv12L                         0000000C
calstatus                         00000001
const1                            0000E666
const2                            0000711F
const3                            000064D0
currdiv12H                        00000013
currdiv12L                        00000012
defaultn                          00000002
defp1df                           00000166
defp2df                           0000010D
emptydone                         00000001
enP1                              00000008
enref_P2                          00000004
lowoffset                         00000000
m12H                              00000011
m12L                              00000010
minpwm                            00000000
n_av                              00000036
onepdivH                          00000010
onepdivL                          00000000
simdiv                            000010CD
spandone                          00000003
tmr1shift                         00000004
type                              00000023
uncalpwm                          00000000


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XX--XXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.50           CA0520 TLL35X ISS8T.ASM   5-2-2023  15:43:26         PAGE 70
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
02C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
03C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
04C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0580 : XXX------------- ---------------- ---------------- ----------------
8000 : -------XX------- ---------------- ---------------- ----------------
F000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXX-- XXXXXXXXXXXXXXXX XXXXXXX---------

All other memory blocks unused.

Program Memory Words Used:  1411
Program Memory Words Free:   637


Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     0 reported,   223 suppressed

