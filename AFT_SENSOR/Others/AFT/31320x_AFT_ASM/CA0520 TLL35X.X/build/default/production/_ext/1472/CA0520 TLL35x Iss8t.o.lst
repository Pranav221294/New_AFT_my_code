MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001         TITLE     "PA240-16F1823 (c) 1/3/2011 P.R.GORTON"
                      00002         LIST      C=130,N=60
                      00003 
                      00004 ;*****************************************************************************;
                      00005 ; This program is protected as an unpublished work under the Copyright Act of ;
                      00006 ; 1975 & the Computer Program Act of 1980. It may not be copied or disclosed  ;
                      00007 ; to any third party without the express permission in writing of the author. ;
                      00008 ;*****************************************************************************;
                      00009 
  00000000            00010 SETFORTEST      EQU     0
  00000001            00011 SWAPPROBEPINS   EQU     1       ;0 = no change, 1 = swap pins
                      00012 
                      00013 ;Saved as : PA240 - 16F1823 V8m.asm
                      00014 ;Device/Oscillator : 16F1823/Ext.Osc 20MHz
                      00015 ;Last update : 20/10/11
                      00016 
                      00017 ;Notes: #1 normal PWM slowed to 4.88KHz
                      00018 ;#2 extra bits to allow manual testing of D.Resistive output from MPLab with PICkit3. REM out for norm
                            al use.
                      00019 ;V4 - CCPR1L set to zero in setup
                      00020 ;V5 - Use pulse frequency modulation for digistal resistive output ###3
                      00021 ;V6 - Level alarm output added ###4. OP pin not designated yet
                      00022 ;CV6 - For revision C of PCB - pins altered ###5
                      00023 ;CV7 - Use advanced setting for count and interval between samples ###6
                      00024 ;###7 use alarm OP to indicate calibration state
                      00025 ;CV8 start of conversion for 2 probe ###8
                      00026 ;###A correction
                      00027 ;Version 8b ###B calculated divisor y = mx -c (pointer at cal send out as zero).
                      00028 ;Version 8c ###C for use with 0V08 diagnostic software.
                      00029 ;Divisor at calibration now stored and sent out in diagnostic extrended EEPROM query with m, c & divis
                            or lower limit
                      00030 ;New EEPROM write routine for changing divisor calculation parameters 
                      00031 ;Version 8d - minor correction to send of divisor at calibration ###D
                      00032 ;Version 8e - calculation routines changed - variable names changed to suit 2 probe
                      00033 ;###9 no probe value calculation (P0)
                      00034 ;###10 calibration routines altered
                      00035 ;###11 changes to EE values sent
                      00036 ;temp boo
                      00037 ;Send params now 1 shot
                      00038 
                      00039 ;NOTE: DISABLE GETFALSEDATA FOR REAL TESTING & SET EE CALIBRATION DATA TO 0
                      00040 
                      00041 ;Disable done in version g onwards
                      00042 ;###h Alterations to averaging. If average<div@cal then use div@cal in P1 calcs.
                      00043 
                      00044 ;###m Controlled shift for TMR1U/H/L to speed up acquisition time
                      00045 ;###n no averaging if under 20% of calspan
                      00046 ;###p (no version o) default n changed to 2 from 4
                      00047 ;###q single probe version works like 2 probe version except that divisor is held at 1
                      00048 ;###r change to correct 'under empty' start up error
                      00049 ;when in D RESISTIVE mode the resistance multiplier is sent out instead of PWM
                      00050 ;###s negative check corrected
                      00051 ;###t modifications requested by Dave Burton
                      00052 
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE  2
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00053 ;NOTE: MAKE RESISTIVE PWM SLOW TO CHANGE,
                      00054 
                      00055 
                      00056 ;Use MOVLB for BSR setting & MOVLP fOR PCLATH setting or use BANKSEL 'regname' to select bank & PAGESE
                            L 'routine name' to select page.
                      00057 
                      00058                 IFDEF __12F1822
                      00059         #INCLUDE P12F1822.INC           
                      00060         ENDIF
                      00061 
                      00062                 IFDEF __12L1822
                      00063         #INCLUDE P12LF1822.INC          
                      00064         ENDIF
                      00065 
                      00066                 IFDEF __16F1823
                      00067         #INCLUDE P16F1823.INC           
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Jan 06 2020
                      00005 ;  MPASM PIC16F1823 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2020 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      01154         LIST
                      00068         ENDIF
                      00069         
                      00070                 IFDEF __16LF1823
                      00071         #INCLUDE P16L1823.INC           
                      00072         ENDIF
                      00073         
                      00074         
                      00075         
                      00076         ERRORLEVEL      1
                      00077 
                      00078 ;    __CONFIG _CONFIG1, _FOSC_ECH & _WDTE_ON & _PWRTE_ON & _MCLRE_ON & _CP_ON & _CPD_OFF & _BOREN_ON &
                             _CLKOUTEN_OFF & _IESO_OFF & _FCMEN_OFF
                      00079 ;    __CONFIG _CONFIG2, _WRT_ALL & _PLLEN_OFF & _STVREN_ON & _BORV_25 & _LVP_OFF
                      00080 
8007   0FA2           00081     __CONFIG _CONFIG1, _FOSC_HS & _WDTE_OFF & _PWRTE_OFF & _MCLRE_OFF & _CP_OFF & _CPD_OFF & _BOREN_ON
                             & _CLKOUTEN_OFF & _IESO_OFF & _FCMEN_OFF
8008   1EFF           00082     __CONFIG _CONFIG2, _WRT_OFF & _PLLEN_OFF & _STVREN_ON & _BORV_LO & _LVP_OFF
                      00083 
                      00084 
                      00085 ;register labels (20-7F + 0AF-0BF)
                      00086 
  00000020            00087 GENSTA0 EQU     20
  00000021            00088 FLASHER EQU     21
  00000022            00089 SWTIMER EQU     22
                      00090 
  00000023            00091 PWML    EQU     23
  00000024            00092 PWMH    EQU     24
  00000025            00093 PWMTEMP EQU     25
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE  3
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00094 
  00000026            00095 DIVATCALL       EQU     26
  00000027            00096 DIVATCALH       EQU     27
                      00097 
  00000028            00098 AVDIVL_OVER20   EQU     28
  00000029            00099 AVDIVH_OVER20   EQU     29
                      00100 
  0000002A            00101 P1SPANATCALL    EQU     2A
  0000002B            00102 P1SPANATCALH    EQU     2B
                      00103 
  0000002C            00104 DIVUSEDL        EQU     2C      ;for diagnostics only
  0000002D            00105 DIVUSEDH        EQU     2D      ;for diagnostics only
                      00106 
  0000002F            00107 TEST    EQU     2F      ;for test only
                      00108 
  00000030            00109 TMR1U   EQU     30
  00000031            00110 TMR1UP1 EQU     31
  00000032            00111 TMR1HP1 EQU     32
  00000033            00112 TMR1LP1 EQU     33
  00000034            00113 TMR1UP2 EQU     34
  00000035            00114 TMR1HP2 EQU     35
  00000036            00115 TMR1LP2 EQU     36
  00000037            00116 TMR1UP0 EQU     37
  00000038            00117 TMR1HP0 EQU     38
  00000039            00118 TMR1LP0 EQU     39
                      00119 
  0000003A            00120 P1EMPTYL        EQU     3A
  0000003B            00121 P1EMPTYH        EQU     3B
                      00122 
  0000003C            00123 MULTCOUNT       EQU     3C
                      00124 
  0000003D            00125 TXCOUNT EQU     3D
  0000003E            00126 DELAY   EQU     3E
  0000003F            00127 TXBYTE  EQU     3F
                      00128 
  00000040            00129 AARGB0  EQU     40
  00000041            00130 AARGB1  EQU     41
  00000042            00131 AARGB2  EQU     42
  00000043            00132 AARGB3  EQU     43
                      00133 
  00000044            00134 DIVH    EQU     44
  00000045            00135 DIVL    EQU     45
                      00136 
  00000044            00137 M1H     EQU     44
  00000045            00138 M1L     EQU     45
                      00139 
  00000046            00140 REMB0   EQU     46
  00000047            00141 REMB1   EQU     47
                      00142 
  00000046            00143 M2H     EQU     46
  00000047            00144 M2L     EQU     47
                      00145 
  00000048            00146 MATHSTEMP       EQU     48
  00000049            00147 LOOPCOUNT       EQU     49
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE  4
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000004A            00148 OLOOPCOUNT      EQU     4A
                      00149 
  0000004B            00150 OPSPANHI        EQU     4B
  0000004C            00151 OPSPANLO        EQU     4C
  0000004D            00152 OPOFFSETHI      EQU     4D
  0000004E            00153 OPOFFSETLO      EQU     4E
  0000004F            00154 OPALARM EQU     4F
                      00155 
  00000050            00156 P2EMPTYL        EQU     50
  00000051            00157 P2EMPTYH        EQU     51
                      00158 
  00000052            00159 ALARMLEVHI      EQU     52
  00000053            00160 ALARMLEVLO      EQU     53
  00000054            00161 GENSTA1 EQU     54
                      00162 
  00000055            00163 CALCP1H EQU     55
  00000056            00164 CALCP1L EQU     56
  00000057            00165 CALCP2H EQU     57
  00000058            00166 CALCP2L EQU     58
                      00167 
  00000059            00168 CURRDIVH        EQU     59
  0000005A            00169 CURRDIVL        EQU     5A
  0000005B            00170 AVDIVU  EQU     5B
  0000005C            00171 AVDIVH  EQU     5C
  0000005D            00172 AVDIVL  EQU     5D
  0000005E            00173 AVREGU  EQU     5E
  0000005F            00174 AVREGH  EQU     5F
  00000060            00175 AVREGL  EQU     60
                      00176 
  00000061            00177 P0DFH   EQU     61
  00000062            00178 P0DFL   EQU     62
  00000063            00179 P0EMPTYL        EQU     63
  00000064            00180 P0EMPTYH        EQU     64
  00000065            00181 P1DFL   EQU     65
  00000066            00182 P1DFH   EQU     66
  00000067            00183 P2DFL   EQU     67
  00000068            00184 P2DFH   EQU     68
  00000069            00185 NAVCOUNT        EQU     69
  0000006A            00186 M12L    EQU     6A
  0000006B            00187 M12H    EQU     6B
  0000006C            00188 PROBE1H EQU     6C
  0000006D            00189 PROBE1L EQU     6D
                      00190 
  0000006E            00191 DIVATCAL97L     EQU     6E
  0000006F            00192 DIVATCAL97H     EQU     6F
                      00193 
                      00194 
                      00195 ;accessible from all banks (70-7F)
                      00196 
  00000070            00197 TASKFLAGS       equ     70
  00000071            00198 RXREG   EQU     71
  00000072            00199 RXTXCOUNT       EQU     72
  00000073            00200 FLAGS232        EQU     73
  00000074            00201 EEWRADDRESS     EQU     74
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE  5
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000075            00202 CALSTATUS       EQU     75
  00000076            00203 TYPE    EQU     76
                      00204 
  00000077            00205 ADVANCED        EQU     77
  00000078            00206 OPTCOUNT        EQU     78
                      00207 
  0000007E            00208 TEMPHI  EQU     7E
  0000007F            00209 TEMPLO  EQU     7F
                      00210 
                      00211 ;bank 1
                      00212 
  000000A0            00213 TIMEL   EQU     0A0
  000000A1            00214 TIMEH   EQU     0A1
  000000A2            00215 TIMEU   EQU     0A2
  000000A3            00216 TIMEUU  EQU     0A3
                      00217 
                      00218 ;definitions
                      00219 
                      00220 
                      00221 #DEFINE _C      STATUS,C
                      00222 
                      00223 #DEFINE ENABLEINT       INTCON,7
                      00224 
                      00225 #DEFINE INTDONE GENSTA0,0
                      00226 #DEFINE LCALWAIT        GENSTA0,1
                      00227 #DEFINE LCJUSTDONE      GENSTA0,2
                      00228 #DEFINE HCJUSTDONE      GENSTA0,3
                      00229 #DEFINE FAULT   GENSTA0,4
                      00230 #DEFINE DRESISTIVE      GENSTA0,5
                      00231 #DEFINE COMMSBEENON     GENSTA0,6
                      00232 #DEFINE OPREVERSE       GENSTA0,7       ;OP falls as level rises
                      00233 
                      00234 #DEFINE ALARMOPFLAG     GENSTA1,0       ;DO NOT MOVE!!!!
                      00235 #DEFINE ALARMONatHI     GENSTA1,1
                      00236 #DEFINE DRIFTNEG        GENSTA1,2
                      00237 #DEFINE SAVEFLAG        GENSTA1,3
                      00238 #DEFINE CDIVISLOW       GENSTA1,4       ;current division below div@cal
                      00239 #DEFINE OVER20PCCSPAN   GENSTA1,5
                      00240 #DEFINE SAVEINDICATOR   GENSTA1,6
                      00241 
                      00242 #DEFINE EMPTYCAL        CALSTATUS,0
                      00243 #DEFINE SPANCAL CALSTATUS,1
                      00244 
                      00245 #DEFINE ALARMOP PORTC,4 ;was PORTA,1 ###5
                      00246 
                      00247         IF      (SWAPPROBEPINS==0)
                      00248 #DEFINE ENPROBE PORTC,2 ;was 4 ###5
                      00249 #DEFINE ENREF_P2        PORTC,3
                      00250         ELSE
                      00251 #DEFINE ENPROBE PORTC,3
                      00252 #DEFINE ENREF_P2        PORTC,2
                      00253         ENDIF
                      00254 
                      00255 #DEFINE WRITE232        FLAGS232,0
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE  6
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00256 #DEFINE READ232 FLAGS232,1      
                      00257 #DEFINE GOTADDR FLAGS232,2
                      00258 
                      00259 #DEFINE GETTINGP0       TASKFLAGS,0
                      00260 #DEFINE GETTINGP1       TASKFLAGS,1
                      00261 #DEFINE GETTINGP2       TASKFLAGS,2
                      00262 #DEFINE T0COUNTING      TASKFLAGS,3
                      00263 #DEFINE T0WAITSTART     TASKFLAGS,4
                      00264 #DEFINE SENDPARAMS      TASKFLAGS,5
                      00265 
                      00266 #DEFINE TWOPROBE        ADVANCED,7
                      00267 
                      00268 ;constants
                      00269 
                      00270 
  000F4240            00271 boo     equ     .1000000
                      00272 
                      00273 ;BANK0 REGISTER SETTING
                      00274 
  000000C0            00275 INTCONset       EQU     B'11000000'
  00000001            00276 T1CONset        EQU     B'00000001'
  00000000            00277 T1GCONset       EQU     B'0'
  00000000            00278 PR2set  EQU     B'0'
  00000004            00279 T2CONsetPS1     EQU     B'00000100'             ;prescale 1, postscale 1
  00000005            00280 T2CONsetPS4     EQU     B'00000101'             ;prescale 4, postscale 1
  00000006            00281 T2CONsetPS16    EQU     B'00000110'             ;prescale 16, postscale 1
  00000007            00282 T2CONsetPS64    EQU     B'00000111'             ;prescale 64, postscale 1
  00000000            00283 CPSCON0set      EQU     B'0'
  00000000            00284 CPSCON1set      EQU     B'0'
                      00285 
                      00286 ;BANK1 REGISTER SETTING
                      00287 
  000000FE            00288 TRISAset        EQU             B'11111110'
                      00289 
  000000C3            00290 TRISCset        EQU     B'11000011'
                      00291 
  00000001            00292 PIE1set EQU     B'00000001'
  00000000            00293 PIE2set EQU     B'0'
                      00294 
  00000060            00295 OPTsetPS2       EQU     B'01100000'             ;pull up on. TMR0 PS=2
  00000061            00296 OPTsetPS4       EQU     B'01100001'             ;pull up on. TMR0 PS=4
  00000062            00297 OPTsetPS8       EQU     B'01100010'             ;pull up on. TMR0 PS=8
  00000063            00298 OPTsetPS16      EQU     B'01100011'             ;pull up on. TMR0 PS=16
  00000064            00299 OPTsetPS32      EQU     B'01100100'             ;pull up on. TMR0 PS=32
  00000065            00300 OPTsetPS64      EQU     B'01100101'             ;pull up on. TMR0 PS=64
  00000066            00301 OPTsetPS128     EQU     B'01100110'             ;pull up on. TMR0 PS=128
  00000067            00302 OPTsetPS512     EQU     B'01100111'             ;pull up on. TMR0 PS=256
                      00303 
  00000060            00304 OPTsetT0wait    EQU     B'01100000'             ;pull up on. TMR0 PS=2
  00000010            00305 PCONset EQU     B'00010000'             ;BOR enabled
  0000001C            00306 WDTCONset       EQU     B'00011100'             ;1:2^19 (16S)
                      00307 
  00000070            00308 OSCCONset       EQU     B'01110000'             ;8MHz
                      00309 
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE  7
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000000            00310 ADCON0set       EQU     B'0'
  00000011            00311 ADCON0setRV     EQU     B'00010001'
  000000A0            00312 ADCON1set       EQU     B'10100000'
                      00313 
                      00314 ;BANK2 REGISTER SETTING
                      00315 
  00000000            00316 CM1CON0set      EQU     B'0'
  00000000            00317 CM1CON1set      EQU     B'0'
  00000000            00318 CM2CON0set      EQU     B'0'
  00000000            00319 CM2CON1set      EQU     B'0'
                      00320 
  00000000            00321 BORCONset       EQU     B'0'
  00000000            00322 FVRCONset       EQU     B'0'
  00000000            00323 DACCON0set      EQU     B'0'
  00000000            00324 DACCON1set      EQU     B'0'
  00000000            00325 SRCON0set       EQU     B'0'
  00000000            00326 SRCON1set       EQU     B'0'
                      00327 
  00000084            00328 APFCONset       EQU     B'10000100'
                      00329 
                      00330 
                      00331 ;BANK3 REGISTER SETTING
                      00332 
  00000000            00333 ANSELAset       EQU     B'0'
                      00334         
  00000001            00335 ANSELCset       EQU     B'00000001'
                      00336 
  00000000            00337 EECON1set       EQU     B'0'
  00000000            00338 EECON2set       EQU     B'0'
                      00339 
  00000008            00340 SPBRGLset       EQU     LOW .520
  00000002            00341 SPBRGHset       EQU     HIGH .520
                      00342 
  00000090            00343 RCSTAset        EQU     B'10010000'
  00000024            00344 TXSTAset        EQU     B'00100100'
  00000008            00345 BAUDCONset      EQU     B'00001000'
                      00346 
                      00347 ;BANK4 REGISTER SETTING
                      00348 
  00000003            00349 WPUAset EQU     B'00000011'
                      00350 
  00000000            00351 WPUCset EQU     B'0'
                      00352 
  00000000            00353 SSP1ADDset      EQU     B'0'
  00000000            00354 SSP1MSKset      EQU     B'0'
                      00355 
  00000000            00356 SSP1STATset     EQU     B'0'
  00000000            00357 SSP1CON1set     EQU     B'0'
  00000000            00358 SSP1CON2set     EQU     B'0'
  00000000            00359 SSP1CON3set     EQU     B'0'
                      00360 
                      00361 ;BANK5 REGISTER SETTING
                      00362 
  0000000C            00363 CCP1CONset      EQU     B'00001100'
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE  8
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000000            00364 PWM1CONset      EQU     B'0'
  00000000            00365 CCP1AScon       EQU     B'0'
  00000001            00366 PSTR1CONset     EQU     B'00000001'
                      00367 
                      00368 ;BANK6 REGISTER SETTING
                      00369 
                      00370 ;BANK7 REGISTER SETTING
                      00371 
  00000000            00372 IOCAPset        EQU     B'0'
  00000000            00373 IOCANset        EQU     B'0'
                      00374 
  00000000            00375 CLRKRCON        EQU     B'0'
                      00376 
  00000000            00377 MDCONset        EQU     B'0'
  00000000            00378 MDSRCset        EQU     B'0'
  00000000            00379 MDCARLset       EQU     B'0'
  00000000            00380 MDCARHset       EQU     B'0'
                      00381 
                      00382 ;general constants
                      00383 
  00000000            00384 LSB     EQU     .0
  00000007            00385 MSB             EQU             .7
                      00386 
                      00387         IF      (SWAPPROBEPINS==0)
                      00388 enP1    EQU     B'00000100'
                      00389 enref_P2        EQU     B'00001000'
                      00390         ELSE
  00000008            00391 enP1    EQU     B'00001000'
  00000004            00392 enref_P2        EQU     B'00000100'
                      00393         ENDIF
                      00394 
  00000001            00395 emptydone       EQU     B'00000001'
  00000003            00396 spandone        EQU     B'00000011'
                      00397 
  00000000            00398 lowoffset       EQU     .0
  00000000            00399 minpwm  EQU     .0
  00000000            00400 uncalpwm        EQU     .0      ;.512
  00000004            00401 tmr1shift       EQU     .4
                      00402 
  00000006            00403 ADwait  EQU     .6      ;uSec @ 20MHz
                      00404 
                      00405 ;fudge factors
                      00406 
  00000166            00407 defp1df EQU     .358    ;1.40 x 2^8 ###t was 1.45
  0000010D            00408 defp2df EQU     .269    ;1.05 x 2^8
  00000002            00409 defaultn        EQU     .2
                      00410 
  0000E666            00411 const1          EQU     .58982  ;(14.4 x 2^12) ###t was 13
  0000711F            00412 const2  EQU     .28959  ;(7.07 x 2^12)rounded up ###t was 4.726
  000064D0            00413 const3  EQU     .25808  ;(6.3 x 2^12)rounded up ###t was 7.43
                      00414 
  00000010            00415 onepdivH        EQU     HIGH .4096      ;2^12
  00000000            00416 onepdivL        EQU     LOW .4096
                      00417 
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE  9
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00418 
                      00419 ;EE Addresses
                      00420 
  00000001            00421 calstatus       EQU     .1
  00000002            00422 P1emptyL        EQU     .2
  00000003            00423 P1emptyH        EQU     .3
  00000004            00424 P2emptyL        EQU     .4
  00000005            00425 P2emptyH        EQU     .5
  00000006            00426 P0emptyL        EQU     .6
  00000007            00427 P0emptyH        EQU     .7
                      00428 
  00000008            00429 P1fullL EQU     .8
  00000009            00430 P1fullH EQU     .9
  0000000A            00431 P2fullL EQU     .10
  0000000B            00432 P2fullH EQU     .11
                      00433 
  0000000C            00434 caldiv12L       EQU     .12
  0000000D            00435 caldiv12H       EQU     .13
                      00436 
  0000000E            00437 P1calspanL      EQU     .14
  0000000F            00438 P1calspanH      EQU     .15
                      00439 
  00000010            00440 m12L    EQU     .16
  00000011            00441 m12H    EQU     .17
                      00442 
  00000012            00443 currdiv12L      EQU     .18
  00000013            00444 currdiv12H      EQU     .19
                      00445 
  00000023            00446 type    EQU     .35
  00000024            00447 OPspanH EQU     .36
  00000025            00448 OPspanL EQU     .37
  00000026            00449 OPminoffsetH    EQU     .38
  00000027            00450 OPminoffsetL    EQU     .39
  00000028            00451 OPalarmH        EQU     .40
  00000029            00452 OPalarmL        EQU     .41
  0000002A            00453 advanced        EQU     .42
                      00454 
  00000032            00455 P1dfL   EQU     .50
  00000033            00456 P1dfH   EQU     .51
  00000034            00457 P2dfL   EQU     .52
  00000035            00458 P2dfH   EQU     .53
  00000036            00459 n_av    EQU     .54
                      00460 
                      00461 
                      00462 
                      00463 ;power up entry *************************************************************
                      00464 
0000                  00465         ORG     00
                      00466 
                      00467         PAGESEL         CSTART
                      00468         PAGESEL CSTART
0000   2CA8           00469         GOTO            CSTART  ; When using debug header, first inst.
                      00470                                 ; may be passed over by ICD2.
0001   2CA8           00471         GOTO            CSTART
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 10
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00472 
                      00473 
                      00474 ;interrupt vector ***********************************************************
                      00475 
                      00476 ; Note the 16F1826/27 family automatically handles context restoration for 
                      00477 ; W, STATUS, BSR, FSR, and PCLATH
                      00478 
0004                  00479         ORG       04
                      00480         
0004   0020           00481         BANKSEL 0
Warning[203]: Found opcode in column 1. (BTFSC)
0005   180E           00482 BTFSC   PORTC, 0    ; Check the status of RC0 (bit 0 of PORTC)
0006   2809           00483         GOTO    RC0_IS_HIGH ; If RC0 is high, jump to RC0_IS_HIGH
0007   140E           00484         BSF     PORTC, 0    ; If RC0 is low, set it high
0008   280A           00485         GOTO    CONTINUE
                      00486 
0009                  00487 RC0_IS_HIGH:
0009   100E           00488         BCF     PORTC, 0    ; If RC0 is high, clear it to make it low
                      00489 
000A                  00490 CONTINUE:
000A   19F0           00491         BTFSC   T0COUNTING
000B   1D0B           00492         BTFSS   INTCON,TMR0IF
000C   281E           00493         GOTO    NOTT0INT        
000D   1018           00494         BCF     T1CON,TMR1ON    ;stop timer     
                      00495 
000E   1811           00496         BTFSC   PIR1,TMR1IF     ;check for overflow
000F   0AB0           00497         INCF    TMR1U   
0010   11F0           00498         BCF     T0COUNTING
                      00499 
0011   128B           00500         BCF     INTCON,TMR0IE   ;disable interrupt      ;###m moved
0012   2481           00501         CALL    ADDTOTIMEp                      ;###m moved
                      00502 
0013   2475           00503         CALL    TIMESHIFT                       ;###m new
                      00504 
0014   18F0           00505         BTFSC   GETTINGP1
0015   234A           00506         CALL    TRANSFERP1
0016   1970           00507         BTFSC   GETTINGP2
0017   2339           00508         CALL    TRANSFERP2
0018   1870           00509         BTFSC   GETTINGP0
0019   2359           00510         CALL    TRANSFERP0
                      00511 
                      00512 ;       BCF     INTCON,TMR0IE   ;disable interrupt      ;###m
                      00513 ;       CALL    ADDTOTIMEp                      ;###m
                      00514                 
001A   1C11           00515         BTFSS   PIR1,TMR1IF
001B   2887           00516         GOTO    INTENDNOFLAG
001C   1011           00517         BCF     PIR1,TMR1IF
001D   2884           00518         GOTO    INTEND
                      00519 
001E   1011           00520 NOTT0INT        BCF     PIR1,TMR1IF
001F   19F0           00521         BTFSC   T0COUNTING
0020   0AB0           00522         INCF    TMR1U
0021   1DF0           00523         BTFSS   T0COUNTING
0022   249C           00524         CALL    ADDTOTIMEt
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 11
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00525         
0023   08F2           00526 COMMSTIMEOUT    TSTF    RXTXCOUNT
0024   1D03           00527         SKPZ
0025   03F2           00528         DECF    RXTXCOUNT
                      00529 
0026   1A91           00530 COMMTEST        BTFSC   PIR1,RCIF
0027   2842           00531         GOTO    DOCOMMS
                      00532 
0028   1E70           00533         BTFSS   T0WAITSTART     ;ready to start cycle?
0029   2884           00534         GOTO    INTEND  ;no
                      00535         
002A   1018           00536 T0SYNCH BCF     T1CON,TMR1ON            ;stop TMR1
002B   0196           00537         CLRF    TMR1L
002C   0197           00538         CLRF    TMR1H
002D   01B0           00539         CLRF    TMR1U
                      00540 
002E   3095           00541         MOVLW   LOW OPTION_REG  ;for INDF0
002F   0084           00542         MOVWF   FSR0L
0030   3000           00543         MOVLW   HIGH OPTION_REG
0031   0085           00544         MOVWF   FSR0H
                      00545 
0032   3060           00546         MOVLW   OPTsetT0wait
0033   0080           00547         MOVWF   INDF0
                      00548         
0034   30FF           00549         MOVLW   0FF
0035   0095           00550         MOVWF   TMR0
0036   110B           00551         BCF     INTCON,TMR0IF
0037   1D0B           00552         BTFSS   INTCON,T0IF
0038   2837           00553         GOTO    ($-1)   ;loop until rollover
                      00554 ;       MOVLW   OPTset  ;ready
0039   0878           00555         MOVFW   OPTCOUNT        ;###6
003A   0195           00556         CLRF    TMR0    ;clear timer
003B   0080           00557         MOVWF   INDF0   ;change prescale
003C   1418           00558         BSF     T1CON,TMR1ON    ;start TMR1
003D   110B           00559         BCF     INTCON,TMR0IF   ;clear flag
003E   168B           00560         BSF     INTCON,TMR0IE   ;enable interrupt
003F   1270           00561         BCF     T0WAITSTART     ;signal wait over
0040   15F0           00562         BSF     T0COUNTING      ;signal T0 running
0041   2884           00563         GOTO    INTEND  ;exit
                      00564 
0042   1720           00565 DOCOMMS BSF     COMMSBEENON     ;signal comms activity - no PWM update
                      00566 
0043   0023           00567         BANKSEL RCREG
0044   0819           00568         MOVFW   RCREG
0045   0020           00569         BANKSEL 0
0046   00F1           00570         MOVWF   RXREG
0047   12F0           00571         BCF     SENDPARAMS      ;flag off
                      00572 
0048   08F2           00573         TSTF    RXTXCOUNT
0049   1D03 286B      00574         BNZ     PROCESS232
004B   01F3           00575         CLRF    FLAGS232
                      00576 
004C   0871           00577 WRITECHECK      MOVFW   RXREG
004D   3AAA           00578         XORLW   .170    ;is it 170 (write)
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 12
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004E   1D03 2856      00579         BNZ     READCHECK
0050   0971           00580 WRITESTART      COMF    RXREG,W
0051   209D           00581         CALL    SENDTXW ;send back inverted
0052   1473           00582         BSF     WRITE232
0053   300B           00583         MOVLW   .11
0054   00F2           00584         MOVWF   RXTXCOUNT
0055   2884           00585         GOTO    INTEND
                      00586 
0056   0871           00587 READCHECK       MOVFW   RXREG
0057   3A55           00588         XORLW   .85     ;is it 85 (read)
0058   1D03 2860      00589         BNZ     DIAGNCHECK
005A   0971           00590 READSTART       COMF    RXREG,W
005B   209D           00591         CALL    SENDTXW ;send back inverted
005C   14F3           00592         BSF     READ232
005D   300B           00593         MOVLW   .11     ;WAS 11
005E   00F2           00594         MOVWF   RXTXCOUNT
005F   2884           00595         GOTO    INTEND
                      00596 
0060   0871           00597 DIAGNCHECK      MOVFW   RXREG
0061   3AA5           00598         XORLW   0A5     ;is it 0A5 (get P1/P2/PWM)
0062   1D03 2866      00599         BNZ     GETEESTORE
0064   16F0           00600         BSF     SENDPARAMS      ;flag to send at every update   
0065   2884           00601         GOTO    INTEND
                      00602 
0066   0871           00603 GETEESTORE      MOVFW   RXREG
0067   3A5A           00604         XORLW   05A     ;is it 05A (get EEstore)
0068   1903           00605         SKPNZ
0069   20A3           00606         CALL    SENDEESTORE
006A   2884           00607         GOTO    INTEND
                      00608 
006B   3005           00609 PROCESS232      MOVLW   .5      ;was 5
006C   00F2           00610         MOVWF   RXTXCOUNT
                      00611 
006D   1873           00612         BTFSC   WRITE232
006E   2873           00613         GOTO    WRITE232DO
006F   0871           00614 READ232DO       MOVFW   RXREG   ;address
0070   2155           00615         CALL    EEREADADRW
0071   209D           00616         CALL    SENDTXW ;send back data
0072   2884           00617         GOTO    INTEND
                      00618 
                      00619 
0073   1973           00620 WRITE232DO      BTFSC   GOTADDR
0074   287C           00621         GOTO    WRITE232DOa
0075   0871           00622         MOVFW   RXREG
0076   00F4           00623         MOVWF   EEWRADDRESS
0077   0971           00624         COMF    RXREG,W
0078   209D           00625         CALL    SENDTXW ;send address back inverted     
                      00626         ;DECF   RXREG,W ;allows use of EEWRITEWNEXT
                      00627         ;BANKSEL        EEADRL
                      00628         ;MOVLW  .31
                      00629         ;MOVWF  EEADRL
0079   0020           00630         BANKSEL 0
007A   1573           00631         BSF     GOTADDR
007B   2884           00632         GOTO    INTEND
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 13
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00633 
007C   0871           00634 WRITE232DOa     MOVFW   RXREG
007D   2165           00635         CALL    EEWRITEW
007E   0023           00636         BANKSEL EEDATL
007F   0993           00637         COMF    EEDATL  ;invert for test to see if it's restored
0080   0020           00638         BANKSEL 0
                      00639         
0081   2157           00640         CALL    EEREADSAME
0082   209D           00641         CALL    SENDTXW ;send EE data back
0083   0AF4           00642         INCF    EEWRADDRESS     ;next
                      00643 
0084                  00644 MAININT
                      00645         
                      00646         
                      00647         
0084   0AA1           00648 INTEND  INCF    FLASHER
0085   0020           00649         BANKSEL 0
0086   1420           00650         BSF     INTDONE
0087   1418           00651 INTENDNOFLAG    BSF     T1CON,TMR1ON    ;make sure timer running        
0088   0009           00652         RETFIE  
                      00653         
                      00654 
                      00655 ;tables/vectors *************************************************************
                      00656 
0089   0877           00657 COUNTTABLE      MOVFW   ADVANCED        ;all ###6
008A   3907           00658         ANDLW   B'00000111'
008B   0782           00659         ADDWF   PCL
008C   3460           00660         RETLW   OPTsetPS2
008D   3461           00661         RETLW   OPTsetPS4
008E   3462           00662         RETLW   OPTsetPS8
008F   3463           00663         RETLW   OPTsetPS16
0090   3464           00664         RETLW   OPTsetPS32
0091   3465           00665         RETLW   OPTsetPS64
0092   3466           00666         RETLW   OPTsetPS128
0093   3467           00667         RETLW   OPTsetPS512
                      00668 
0094   0E77           00669 INTERVALTABLE   SWAPF   ADVANCED,W      ;all ###6
0095   3903           00670         ANDLW   B'00000011'
0096   0782           00671         ADDWF   PCL
0097   341F           00672         RETLW   B'00011111'
0098   343F           00673         RETLW   B'00111111'
0099   347F           00674         RETLW   B'01111111'
009A   34FF           00675         RETLW   B'11111111'
                      00676 
                      00677 ;subroutines ****************************************************************
                      00678 
009B   1EF0           00679 TESTSENDTXW     BTFSS   SENDPARAMS
009C   0008           00680         RETURN
                      00681 
009D   1E11           00682 SENDTXW BTFSS   PIR1,TXIF       ;high if empty
009E   289D           00683         GOTO    ($-1)   ;loop is not empty
009F   0023           00684         BANKSEL TXREG
00A0   009A           00685         MOVWF   TXREG
00A1   0020           00686         BANKSEL 0
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 14
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00A2   0008           00687         RETURN
                      00688 
00A3   3001           00689 SENDEESTORE     MOVLW   calstatus       ;###11 additions/notes
00A4   2155           00690         CALL    EEREADADRW
00A5   209D           00691         CALL    SENDTXW ;calstat
00A6   2153           00692         CALL    EEREADNEXT
00A7   209D           00693         CALL    SENDTXW ;p1ecalL
00A8   2153           00694         CALL    EEREADNEXT
00A9   209D           00695         CALL    SENDTXW ;p1ecalH
00AA   2153           00696         CALL    EEREADNEXT
00AB   209D           00697         CALL    SENDTXW ;p2ecalL
00AC   2153           00698         CALL    EEREADNEXT
00AD   209D           00699         CALL    SENDTXW ;p2ecalH
00AE   2153           00700         CALL    EEREADNEXT
00AF   209D           00701         CALL    SENDTXW ;p0calL
00B0   2153           00702         CALL    EEREADNEXT
00B1   209D           00703         CALL    SENDTXW ;p0calH
00B2   2153           00704         CALL    EEREADNEXT
00B3   209D           00705         CALL    SENDTXW ;p1fcalL
00B4   2153           00706         CALL    EEREADNEXT
00B5   209D           00707         CALL    SENDTXW ;p1fcalH
00B6   2153           00708         CALL    EEREADNEXT
00B7   209D           00709         CALL    SENDTXW ;p2fcalL
00B8   2153           00710         CALL    EEREADNEXT
00B9   209D           00711         CALL    SENDTXW ;p2fcalH        
00BA   2153           00712         CALL    EEREADNEXT      
00BB   209D           00713         CALL    SENDTXW ;divcalL
00BC   2153           00714         CALL    EEREADNEXT      
00BD   209D           00715         CALL    SENDTXW ;divcalH
00BE   2153           00716         CALL    EEREADNEXT      
00BF   209D           00717         CALL    SENDTXW ;spancalL
00C0   2153           00718         CALL    EEREADNEXT      
00C1   209D           00719         CALL    SENDTXW ;spancalH
                      00720 
00C2   3032           00721         MOVLW   P1dfL   ;sends five bytes of calculation parameters
00C3   2155           00722         CALL    EEREADADRW
00C4   209D           00723         CALL    SENDTXW ;p1dfL
00C5   2153           00724         CALL    EEREADNEXT
00C6   209D           00725         CALL    SENDTXW ;p1dfH
00C7   2153           00726         CALL    EEREADNEXT
00C8   209D           00727         CALL    SENDTXW ;p2dfL
00C9   2153           00728         CALL    EEREADNEXT
00CA   209D           00729         CALL    SENDTXW ;p2dfH
00CB   2153           00730         CALL    EEREADNEXT
00CC   209D           00731         CALL    SENDTXW ;n
                      00732         
00CD   3012           00733         MOVLW   currdiv12L
00CE   2155           00734         CALL    EEREADADRW
00CF   209D           00735         CALL    SENDTXW ;currdiv12L
00D0   2153           00736         CALL    EEREADNEXT
00D1   209D           00737         CALL    SENDTXW ;currdiv12H
                      00738                 
00D2   0008           00739         RETURN
                      00740         
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 15
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00D3   3004           00741 T2SETUP MOVLW   T2CONsetPS1
00D4   1A76           00742         BTFSC   TYPE,4  ;ResD1
00D5   3005           00743         MOVLW   T2CONsetPS4
00D6   1AF6           00744         BTFSC   TYPE,5  ;ResD2
00D7   3006           00745         MOVLW   T2CONsetPS16
00D8   1B76           00746         BTFSC   TYPE,6  ;ResD3
00D9   3007           00747         MOVLW   T2CONsetPS64
00DA   009C           00748         MOVWF   T2CON   ;setup T2
00DB   0008           00749         RETURN
                      00750 
00DC                  00751 SETUP
00DC   0020           00752 SETUPB0 MOVLB   0       ;set bank 0
00DD   30C0           00753         MOVLW   INTCONset       
00DE   008B           00754         MOVWF   INTCON
00DF   3001           00755         MOVLW   T1CONset        
00E0   0098           00756         MOVWF   T1CON   
00E1   3000           00757         MOVLW   T1GCONset       
00E2   0099           00758         MOVWF   T1GCON  
00E3   3000           00759         MOVLW   PR2set  
00E4   009B           00760         MOVWF   PR2     
                      00761 ;       MOVLW   T2CONsetPS4     ;#1     
00E5   3000           00762         MOVLW   0
00E6   009C           00763         MOVWF   T2CON   
00E7   3000           00764         MOVLW   CPSCON0set      
00E8   009E           00765         MOVWF   CPSCON0 
00E9   3000           00766         MOVLW   CPSCON1set      
00EA   009F           00767         MOVWF   CPSCON1 
                      00768 
                      00769 
00EB   0021           00770 SETUPB1 MOVLB   .1      ;bank 1
00EC   30FE           00771         MOVLW   TRISAset        
00ED   008C           00772         MOVWF   TRISA
                      00773 
                      00774         IFDEF __16F1823
00EE   30C3           00775         MOVLW   TRISCset 
00EF   008E           00776         MOVWF   TRISC
                      00777         ENDIF
                      00778         
                      00779         IFDEF __16LF1823
                      00780         MOVLW   TRISCset 
                      00781         MOVWF   TRISC
                      00782         ENDIF
                      00783                 
00F0   3001           00784         MOVLW   PIE1set
00F1   0091           00785         MOVWF   PIE1
00F2   3000           00786         MOVLW   PIE2set
00F3   0092           00787         MOVWF   PIE2
                      00788 
00F4   3065           00789         MOVLW   OPTsetPS64      
00F5   0095           00790         MOVWF   OPTION_REG
                      00791         
00F6   3010           00792         MOVLW   PCONset
00F7   0096           00793         MOVWF   PCON
00F8   301C           00794         MOVLW   WDTCONset
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 16
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00F9   0097           00795         MOVWF   WDTCON
00FA   3070           00796         MOVLW   OSCCONset
00FB   0099           00797         MOVWF   OSCCON
00FC   3000           00798         MOVLW   ADCON0set
00FD   009D           00799         MOVWF   ADCON0
00FE   30A0           00800         MOVLW   ADCON1set
00FF   009E           00801         MOVWF   ADCON1
                      00802 
                      00803 
0100   0022           00804 SETUPB2 MOVLB   .2      ;bank 2 
0101   3000           00805         MOVLW   CM1CON0set
0102   0091           00806         MOVWF   CM1CON0
0103   3000           00807         MOVLW   CM1CON1set
0104   0092           00808         MOVWF   CM1CON1 
                      00809         
                      00810         IFDEF __16F1823
0105   3000           00811         MOVLW   CM2CON0set      
0106   0093           00812         MOVWF   CM2CON0
0107   3000           00813         MOVLW   CM2CON1set
0108   0094           00814         MOVWF   CM2CON1
                      00815         ENDIF
                      00816 
                      00817         IFDEF __16LF1823
                      00818         MOVLW   CM2CON0set      
                      00819         MOVWF   CM2CON0
                      00820         MOVLW   CM2CON1set
                      00821         MOVWF   CM2CON1
                      00822         ENDIF
                      00823 
0109   3000           00824         MOVLW   BORCONset
010A   0096           00825         MOVWF   BORCON
010B   3000           00826         MOVLW   FVRCONset
010C   0097           00827         MOVWF   FVRCON
010D   3000           00828         MOVLW   DACCON0set
010E   0098           00829         MOVWF   DACCON0
010F   3000           00830         MOVLW   DACCON1set
0110   0099           00831         MOVWF   DACCON1
0111   3000           00832         MOVLW   SRCON0set
0112   009A           00833         MOVWF   SRCON0
0113   3000           00834         MOVLW   SRCON1set
0114   009B           00835         MOVWF   SRCON1
                      00836         
0115   3084           00837         MOVLW   APFCONset
0116   009D           00838         MOVWF   APFCON
                      00839         
0117   0023           00840 SETUPB3 MOVLB   .3      ;bank 3
0118   3000           00841         MOVLW   ANSELAset
0119   008C           00842         MOVWF   ANSELA
                      00843 
                      00844         IFDEF __16F1823
011A   3001           00845         MOVLW   ANSELCset
011B   008E           00846         MOVWF   ANSELC
                      00847         ENDIF
                      00848 
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 17
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00849         IFDEF __16LF1823
                      00850         MOVLW   ANSELCset
                      00851         MOVWF   ANSELC
                      00852         ENDIF
                      00853 
011C   3000           00854         MOVLW   EECON1set
011D   0095           00855         MOVWF   EECON1
011E   3000           00856         MOVLW   EECON2set
011F   0096           00857         MOVWF   EECON2
0120   3008           00858         MOVLW   SPBRGLset
0121   009B           00859         MOVWF   SPBRGL
0122   3002           00860         MOVLW   SPBRGHset
0123   009C           00861         MOVWF   SPBRGH
0124   3090           00862         MOVLW   RCSTAset
0125   009D           00863         MOVWF   RCSTA
0126   3024           00864         MOVLW   TXSTAset
0127   009E           00865         MOVWF   TXSTA
0128   3008           00866         MOVLW   BAUDCONset
0129   009F           00867         MOVWF   BAUDCON
                      00868 
012A   0024           00869 SETUPB4 MOVLB   .4      ;bank 4
012B   3003           00870         MOVLW   WPUAset
012C   008C           00871         MOVWF   WPUA
                      00872 
                      00873         IFDEF __16F1823
012D   3000           00874         MOVLW   WPUCset
012E   008E           00875         MOVWF   WPUC
                      00876         ENDIF
                      00877         
                      00878         IFDEF __16LF1823
                      00879         MOVLW   WPUCset
                      00880         MOVWF   WPUC
                      00881         ENDIF
                      00882 
                      00883 
012F   3000           00884         MOVLW   SSP1ADDset
0130   0092           00885         MOVWF   SSP1ADD
0131   3000           00886         MOVLW   SSP1MSKset
0132   0093           00887         MOVWF   SSP1MSK
                      00888 
0133   3000           00889         MOVLW   SSP1STATset
0134   0094           00890         MOVWF   SSP1STAT
0135   3000           00891         MOVLW   SSP1CON1set
0136   0095           00892         MOVWF   SSP1CON1
0137   3000           00893         MOVLW   SSP1CON2set
0138   0096           00894         MOVWF   SSP1CON2
0139   3000           00895         MOVLW   SSP1CON3set
013A   0097           00896         MOVWF   SSP1CON3
                      00897 
                      00898 
013B   0025           00899 SETUPB5 MOVLB   .5      ;bank 5
013C   0191           00900         CLRF    CCPR1L
013D   300C           00901         MOVLW   CCP1CONset
013E   0093           00902         MOVWF   CCP1CON
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 18
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

013F   3000           00903         MOVLW   PWM1CONset
0140   0094           00904         MOVWF   PWM1CON
0141   3000           00905         MOVLW   CCP1AScon
0142   0095           00906         MOVWF   CCP1AS
0143   3001           00907         MOVLW   PSTR1CONset
0144   0096           00908         MOVWF   PSTR1CON
0145   0191           00909                 CLRF    CCPR1L
                      00910 ;no SETUPB6     
                      00911 
0146   0027           00912 SETUPB7 MOVLB   .7      ;bank 7
0147   3000           00913         MOVLW   IOCAPset
0148   0091           00914         MOVWF   IOCAP
0149   3000           00915         MOVLW   IOCANset
014A   0092           00916         MOVWF   IOCAN
                      00917 
014B   0020           00918         MOVLB   0       ;bank 0
014C   0008           00919         RETURN
                      00920 
014D   0196           00921 INITMR1 CLRF    TMR1L
014E   0197           00922         CLRF    TMR1H
014F   3001           00923         MOVLW   T1CONset
0150   0098           00924         MOVWF   T1CON
0151   1011           00925         BCF     PIR1,TMR1IF
0152   0008           00926         RETURN
                      00927 
0153                  00928 EEREADNEXT      
0153   0023           00929         BANKSEL EEADRL
0154   0A11           00930         INCF    EEADRL,W
0155                  00931 EEREADADRW                      ;get data from EEPROM, addr in W
0155   0023           00932         BANKSEL EEADRL
0156   0091           00933         MOVWF   EEADRL
                      00934         
0157                  00935 EEREADSAME
0157   0023           00936         BANKSEL EECON1
0158   1895           00937         BTFSC   EECON1,WR
0159   2958           00938         GOTO    ($-1)
015A   0193           00939         CLRF    EEDATL  ;
015B   1315           00940         BCF     EECON1,CFGS
015C   1395           00941         BCF     EECON1,EEPGD
015D   1415           00942         BSF     EECON1,RD
015E   0813           00943         MOVFW   EEDATL  ;result in W
015F   0020           00944         BANKSEL 0
0160   0008           00945         RETURN
                      00946 
                      00947 
0161                  00948 EEWRITEWNEXT    
0161   0023           00949         BANKSEL EECON1
0162   0093           00950         MOVWF   EEDATL
0163   0A91           00951         INCF    EEADRL
0164   2969           00952         GOTO    EEWRSETUP
                      00953 
0165                  00954 EEWRITEW                        ;data in W, address in EEWRADDRESS
0165   0023           00955         BANKSEL EECON1
0166   0093           00956         MOVWF   EEDATL  
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 19
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0167   0874           00957         MOVFW   EEWRADDRESS
0168   0091           00958         MOVWF   EEADRL
                      00959 
0169   1895           00960 EEWRSETUP       BTFSC   EECON1,WR
016A   2969           00961         GOTO    ($-1)
016B   1315           00962         BCF     EECON1,CFGS
016C   1395           00963         BCF     EECON1,EEPGD
016D   1515           00964         BSF     EECON1,WREN
                      00965         
016E   1F8B           00966         BTFSS   INTCON,GIE      ;int enabled?
016F   2976           00967         GOTO    EEWRITEMAIN     ;int already off, exit through this
                      00968 
0170   138B           00969         BCF     INTCON,GIE      ;interrupt off
0171   1B8B           00970         BTFSC   INTCON,GIE      ;check
0172   2970           00971         GOTO    ($-2)
0173   2176           00972         CALL    EEWRITEMAIN
0174   178B           00973         BSF     INTCON,GIE      ;interrupt on
0175   0008           00974         RETURN
                      00975 
0176   3055           00976 EEWRITEMAIN     MOVLW   55
0177   0096           00977         MOVWF   EECON2
0178   30AA           00978         MOVLW   0AA
0179   0096           00979         MOVWF   EECON2
017A   1495           00980         BSF     EECON1,WR
017B   1115           00981         BCF     EECON1,WREN
                      00982 
017C   1895           00983         BTFSC   EECON1,WR
017D   297C           00984         GOTO    ($-1)
                      00985 
017E   0020           00986         BANKSEL 0
017F   0008           00987         RETURN
                      00988 
0180   0E23           00989 PWMSET  SWAPF   PWML,W
0181   3930           00990         ANDLW   B'00110000'
0182   00A5           00991         MOVWF   PWMTEMP ;store lower bits in correct position
0183   0CA4           00992         RRF     PWMH
0184   0CA3           00993         RRF     PWML
0185   0CA4           00994         RRF     PWMH
0186   0C23           00995         RRF     PWML,W  ;MS 8-bits in W
0187   0025           00996         BANKSEL CCPR1L
0188   0091           00997         MOVWF   CCPR1L
0189   0020           00998         BANKSEL 0
018A   0825           00999         MOVFW   PWMTEMP
018B   0025           01000         BANKSEL CCP1CON
018C   1213           01001         BCF     CCP1CON,4
018D   1293           01002         BCF     CCP1CON,5
018E   0493           01003         IORWF   CCP1CON
018F   0020           01004         BANKSEL 0
0190   0008           01005         RETURN
                      01006 
0191   01C4           01007 CALCPERCENT     CLRF    M1H     ;all ###4
0192   3064           01008         MOVLW   .100
0193   00C5           01009         MOVWF   M1L
0194   21C7           01010         CALL    CALCMAIN
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 20
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0195   1BC3           01011         BTFSC   AARGB3,7        ;negative? ###s
0196   01C3           01012         CLRF    AARGB3  ;yes, value 0   ###j here
                      01013 
                      01014 
0197   3028           01015 CALCPERCENTa    MOVLW   OPalarmH        ;get alarm parameters
0198   2155           01016         CALL    EEREADADRW
0199   00D2           01017         MOVWF   ALARMLEVHI
019A   2153           01018         CALL    EEREADNEXT
019B   00D3           01019         MOVWF   ALARMLEVLO
                      01020 
019C   10D4           01021         BCF     ALARMONatHI     ;extract alarm flag
019D   1BD2           01022         BTFSC   ALARMLEVHI,7
019E   14D4           01023         BSF     ALARMONatHI
                      01024 
019F   307F           01025         MOVLW   B'01111111'
01A0   05D2           01026         ANDWF   ALARMLEVHI      ;remove alarm flag
                      01027 
01A1   0843           01028 SETALOPFLAG     MOVFW   AARGB3
01A2   0252           01029         SUBWF   ALARMLEVHI,W
01A3   1C03           01030         SKPC
01A4   1454           01031         BSF     ALARMOPFLAG
                      01032         
01A5   0853           01033         MOVFW   ALARMLEVLO
01A6   0243           01034         SUBWF   AARGB3,W
01A7   1C03           01035         SKPC
01A8   1054           01036         BCF     ALARMOPFLAG     
                      01037 
01A9   1CD4           01038         BTFSS   ALARMONatHI
01AA   29B0           01039         GOTO    SETALARMOPLO
                      01040 
01AB   1854           01041 SETALARMOPHI    BTFSC   ALARMOPFLAG     ;###5 here
01AC   160E           01042         BSF     ALARMOP
01AD   1C54           01043         BTFSS   ALARMOPFLAG
01AE   120E           01044         BCF     ALARMOP ;###5 to here
01AF   0008           01045         RETURN
                      01046         
01B0   1854           01047 SETALARMOPLO    BTFSC   ALARMOPFLAG     ;###5 here
01B1   120E           01048         BCF     ALARMOP
01B2   1C54           01049         BTFSS   ALARMOPFLAG
01B3   160E           01050         BSF     ALARMOP ;###5 to here
01B4   0008           01051         RETURN
                      01052 
                      01053                 
                      01054 ;**********************************************************************
                      01055 ;(CAP RESULT x  OPSPAN)/SPAN 
                      01056 ;Multiplication by output span in PWM terms
                      01057 
                      01058 
                      01059 ;CALCULATE      ###r    
01B5   3024           01060 GETOPPARAM      MOVLW   OPspanH ;get op parameters
01B6   2155           01061         CALL    EEREADADRW
01B7   00CB           01062         MOVWF   OPSPANHI
                      01063 
01B8   13A0           01064         BCF     OPREVERSE       ;extract reverse flag
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 21
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01B9   1BCB           01065         BTFSC   OPSPANHI,7
01BA   17A0           01066         BSF     OPREVERSE
                      01067 
01BB   3007           01068         MOVLW   B'00000111'
01BC   05CB           01069         ANDWF   OPSPANHI        ;remove reverse flag
01BD   084B           01070         MOVFW   OPSPANHI
01BE   00C4           01071         MOVWF           M1H
                      01072 
01BF   2153           01073         CALL    EEREADNEXT
01C0   00CC           01074         MOVWF   OPSPANLO
01C1   00C5           01075         MOVWF           M1L
01C2   2153           01076         CALL    EEREADNEXT
01C3   00CD           01077         MOVWF   OPOFFSETHI
01C4   2153           01078         CALL    EEREADNEXT
01C5   00CE           01079         MOVWF   OPOFFSETLO
01C6   0008           01080         RETURN
                      01081         
01C7   086C           01082 CALCMAIN        MOVFW   PROBE1H
01C8   00C6           01083         MOVWF           M2H
01C9   086D           01084         MOVFW   PROBE1L
01CA   00C7           01085         MOVWF           M2L
                      01086 
01CB   221E           01087         CALL            MULT16X16       ;result in AARGB0-4
                      01088 
01CC   082A           01089         MOVFW   P1SPANATCALL    ;get SPAN into divisor
01CD   00C5           01090         MOVWF   DIVL
01CE   082B           01091         MOVFW   P1SPANATCALH
01CF   00C4           01092         MOVWF   DIVH
                      01093                 
01D0   2239           01094         CALL    UDIV3216L       ;result in AARGB3(L) & AARGB2(H)
01D1   0008           01095         RETURN
                      01096 
01D2   084C           01097 SPANCHECK       MOVFW   OPSPANLO                ;MAXSPAN - SPANCALCRESULT
01D3   0243           01098         SUBWF   AARGB3,W        
01D4   084B           01099         MOVFW   OPSPANHI                
01D5   3B42           01100         SUBWFB  AARGB2,W
01D6   1C03           01101         SKPC
01D7   0008           01102         RETURN
                      01103         
01D8   084C           01104 SETMAXSPAN      MOVFW   OPSPANLO        ;if calculated span too great, set to max
01D9   00C3           01105         MOVWF   AARGB3
01DA   084B           01106         MOVFW   OPSPANHI
01DB   00C2           01107         MOVWF   AARGB2
01DC   0008           01108         RETURN
                      01109 
                      01110 ;16-Bit subtract with valid carry-out (zero flag invalid after subtraction)
                      01111 
01DD   0843           01112 REVERSEPWM      MOVFW   AARGB3  ;DEST = DEST-SOURCE
01DE   024C           01113         SUBWF   OPSPANLO,W      ;
01DF   00C3           01114         MOVWF   AARGB3  ;return to AARG
01E0   0842           01115         MOVFW   AARGB2  ;
01E1   1C03           01116         SKPC            ;
01E2   0A42           01117         INCF    AARGB2,W        ;was INCFSZ
01E3   024B           01118         SUBWF   OPSPANHI,W
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 22
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01E4   00C2           01119         MOVWF   AARGB2  ;return to AARG
01E5   0008           01120         RETURN
                      01121 
                      01122 ;*******************************************************************
                      01123 
                      01124 ;Primes average with stored average
                      01125 
01E6   3036           01126 AVPRIME MOVLW   n_av
01E7   2155           01127         CALL    EEREADADRW
01E8   00E9           01128         MOVWF   NAVCOUNT
01E9   00C9           01129         MOVWF   LOOPCOUNT
01EA   01DE           01130         CLRF    AVREGU
                      01131 
01EB   3012           01132         MOVLW   currdiv12L
01EC   2155           01133         CALL    EEREADADRW
01ED   00E0           01134         MOVWF   AVREGL
01EE   00DA           01135         MOVWF   CURRDIVL
01EF   00A8           01136         MOVWF   AVDIVL_OVER20   ;###j
                      01137 
01F0   2153           01138         CALL    EEREADNEXT
01F1   00DF           01139         MOVWF   AVREGH
01F2   00D9           01140         MOVWF   CURRDIVH
01F3   00A9           01141         MOVWF   AVDIVH_OVER20   ;###j
                      01142 
01F4   1003           01143 PRIMELOOP       CLRC    
01F5   0DE0           01144         RLF     AVREGL
01F6   0DDF           01145         RLF     AVREGH
01F7   0DDE           01146         RLF     AVREGU
01F8   0BC9           01147         DECFSZ  LOOPCOUNT
01F9   29F4           01148         GOTO    PRIMELOOP
01FA   0008           01149         RETURN
                      01150 
                      01151 ;*******************************************************************
                      01152 
                      01153 ;16 BIT WINDOW AVERAGE with window controlled by n_av (2 to 8)
                      01154 
01FB   0869           01155 EXTRACTAVDIV    MOVFW   NAVCOUNT        ;###h alterations made
01FC   00C9           01156         MOVWF   LOOPCOUNT
                      01157 
01FD   085E           01158         MOVFW   AVREGU
01FE   00DB           01159         MOVWF   AVDIVU
01FF   085F           01160         MOVFW   AVREGH
0200   00DC           01161         MOVWF   AVDIVH
0201   0860           01162         MOVFW   AVREGL
0202   00DD           01163         MOVWF   AVDIVL
                      01164 
0203   1003           01165 EXTRACTLOOP     CLRC
0204   0CDB           01166         RRF     AVDIVU
0205   0CDC           01167         RRF     AVDIVH
0206   0CDD           01168         RRF     AVDIVL  ;divide by 2
0207   0BC9           01169         DECFSZ  LOOPCOUNT
0208   2A03           01170         GOTO    EXTRACTLOOP
0209   0008           01171         RETURN
                      01172         
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 23
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

020A   21FB           01173 DOAVERAGE       CALL    EXTRACTAVDIV
                      01174 
                      01175         
020B   1ED4           01176 TRANSIFOVER20   BTFSS   OVER20PCCSPAN   ;###j - over 20% of spancal?    
020C   2A11           01177         GOTO    DOAVERAGEa      ;no, move on
020D   085D           01178         MOVFW   AVDIVL
020E   00A8           01179         MOVWF   AVDIVL_OVER20
020F   085C           01180         MOVFW   AVDIVH
0210   00A9           01181         MOVWF   AVDIVH_OVER20
                      01182         
0211   085A           01183 DOAVERAGEa      MOVFW   CURRDIVL        ;add in new
0212   07E0           01184         ADDWF   AVREGL
0213   0859           01185         MOVFW   CURRDIVH
                      01186         
0214   3DDF           01187         ADDWFC  AVREGH
0215   0103           01188         CLRW
0216   3DDE           01189         ADDWFC  AVREGU
                      01190 
0217   085D           01191         MOVFW   AVDIVL  ;subtract old
0218   02E0           01192         SUBWF   AVREGL
0219   085C           01193         MOVFW   AVDIVH
021A   3BDF           01194         SUBWFB  AVREGH
021B   085B           01195         MOVFW   AVDIVU
021C   3BDE           01196         SUBWFB  AVREGU
                      01197         
021D   0008           01198         RETURN
                      01199 
                      01200                 
                      01201 ;*******************************************************************
                      01202 
                      01203 ;16x16 FIXED POINT MULTIPLICATION ROUTINE (PM: 26, DM: 11)
                      01204 ;Input:  fixed point arguments in M1H/L and M2H/L
                      01205 ;Output: AARG0-4 (AARGB0 is most significant byte)
                      01206 
                      01207 
021E   01C0           01208 MULT16X16       CLRF    AARGB0
021F   01C1           01209         CLRF    AARGB1
0220   01C2           01210         CLRF    AARGB2
0221   01C3           01211         CLRF    AARGB3
                      01212         
0222   3010           01213         MOVLW   .16
0223   00CA           01214         MOVWF   OLOOPCOUNT
                      01215         
0224   0DC5           01216 MULT16X16LOOP   RLF     M1L
0225   0DC4           01217         RLF     M1H
0226   1C03 2A30      01218         BNC     ROTATE32
                      01219 
0228   0847           01220 ADDM2TOTOTAL    MOVFW   M2L
0229   07C3           01221         ADDWF   AARGB3
022A   0846           01222         MOVFW   M2H
022B   3DC2           01223         ADDWFC  AARGB2
022C   0103           01224         CLRW    
022D   3DC1           01225         ADDWFC  AARGB1
022E   0103           01226         CLRW    
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 24
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

022F   3DC0           01227         ADDWFC  AARGB0
                      01228 
0230   0BCA           01229 ROTATE32        DECFSZ  OLOOPCOUNT
0231   2A33           01230         GOTO    ROTATE32a
0232   0008           01231         RETURN
                      01232 
0233   1003           01233 ROTATE32a       CLRC
0234   0DC3           01234         RLF     AARGB3
0235   0DC2           01235         RLF     AARGB2
0236   0DC1           01236         RLF     AARGB1
0237   0DC0           01237         RLF     AARGB0
0238   2A24           01238         GOTO    MULT16X16LOOP
                      01239         
                      01240 
                      01241 ;start of division *********************************************************************
                      01242 
                      01243 ;32/16 FIXED POINT DIVIDE ROUTINE (PM: 68, DM: 11)
                      01244 ;Input:  fixed point arguments in AARG and DIVH/L (AARGB0 is most significant byte)
                      01245 ;Output: quotient AARG/DIV followed by remainder in REM
                      01246 
                      01247 ;AARGB0-3 can be anywhere in data memory but must be in one bank and in the order shown
                      01248 
0239   0844           01249 UDIV3216L       MOVFW   DIVH            ;test & exit if zero divisor
023A   0445           01250         IORWF   DIVL,W
023B   1903           01251         SKPNZ
023C   0008           01252         RETURN
                      01253 
023D   01C6           01254         CLRF    REMB0
023E   01C7           01255         CLRF    REMB1
                      01256 
023F   3000           01257         MOVLW   HIGH AARGB0             ;set up address pointer
0240   0085           01258         MOVWF   FSR0H
0241   3040           01259         MOVLW   LOW AARGB0
0242   0084           01260         MOVWF   FSR0L
                      01261 
0243   01C8           01262         CLRF    MATHSTEMP
0244   0D00           01263         RLF     INDF0,W         ;#0
0245   0DC7           01264         RLF     REMB1
0246   0845           01265         MOVFW   DIVL
                      01266 
0247   2270           01267         CALL    SUB1
                      01268 
0248   0D80           01269         RLF     INDF0           ;#0
                      01270 
0249   3004           01271         MOVLW   .4
024A   00CA           01272         MOVWF   OLOOPCOUNT              ;set outer loop
                      01273 
024B   3007           01274 INNERLOOP       MOVLW           7
024C   00C9           01275         MOVWF           LOOPCOUNT
                      01276 
024D   226A           01277 LOOPU3216A      CALL    ROTATE1         ;###X
024E   1C00           01278         BTFSS   INDF0,LSB               ;#0
024F   2A52           01279         GOTO    UADD3216A
                      01280 
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 25
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0250   2270           01281         CALL    SUB1
0251   2A53           01282         GOTO    UOK3216A
                      01283 
0252   2276           01284 UADD3216A       CALL    ADD1
                      01285         
0253   0D80           01286 UOK3216A        RLF     INDF0           ;#0
                      01287 
0254   0BC9           01288               DECFSZ    LOOPCOUNT
0255   2A4D           01289         GOTO    LOOPU3216A
                      01290 
0256   0B4A           01291         DECFSZ  OLOOPCOUNT,W            ;if last part of loop, miss next part
0257   2A59           01292         GOTO    INCPOINTER
0258   2A65           01293         GOTO    LASTPART
                      01294 
0259   0A84           01295 INCPOINTER      INCF    FSR0L           ;point to next byte
                      01296 
025A   226A           01297         CALL    ROTATE1
025B   0384           01298         DECF    FSR0L           ;back to previous
                      01299                 
025C   1C00           01300         BTFSS   INDF0,LSB               ;#0
025D   2A60           01301         GOTO    UADD3216B
                      01302 
025E   2270           01303         CALL    SUB1
025F   2A61           01304         GOTO    UOK3216B
                      01305 
0260   2276           01306 UADD3216B       CALL    ADD1
                      01307         
0261   0A84           01308 UOK3216B        INCF    FSR0L
0262   0D80           01309         RLF     INDF0           ;##1
                      01310 
0263   0BCA           01311         DECFSZ  OLOOPCOUNT
0264   2A4B           01312         GOTO    INNERLOOP
                      01313 
0265   1800           01314 LASTPART        BTFSC   INDF0,LSB               ;####3
0266   0008           01315         RETURN
0267   0845           01316         MOVF    DIVL,W
0268   2276           01317         CALL    ADD1            ;with extra un-needed bits
0269   0008           01318         RETURN
                      01319 
                      01320 ;division subroutines
                      01321 
026A   0D00           01322 ROTATE1         RLF     INDF0,W         ;#0
026B   0DC7           01323                 RLF     REMB1
026C   0DC6           01324         RLF     REMB0
026D   0DC8           01325         RLF     MATHSTEMP
026E   0845           01326         MOVFW   DIVL
026F   0008           01327         RETURN
                      01328 
0270   02C7           01329 SUB1    SUBWF   REMB1
0271   0844           01330         MOVFW   DIVH
0272   3BC6           01331         SUBWFB  REMB0
0273   0103           01332         CLRW
0274   3BC8           01333         SUBWFB  MATHSTEMP
0275   0008           01334         RETURN
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 26
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01335 
                      01336 
0276   07C7           01337 ADD1    ADDWF   REMB1
0277   0844           01338         MOVFW   DIVH
0278   3DC6           01339         ADDWFC  REMB0
0279   0103           01340         CLRW
027A   3DC8           01341         ADDWFC  MATHSTEMP
027B   0008           01342         RETURN
                      01343 
                      01344         
                      01345 ;end of division ***********************************************************************
                      01346 
                      01347 
027C   3002           01348 MT_DF_M_N_DVC   MOVLW   P1emptyL        ;get stored empty values
027D   2155           01349         CALL    EEREADADRW
027E   00BA           01350         MOVWF   P1EMPTYL
027F   2153           01351         CALL    EEREADNEXT
0280   00BB           01352         MOVWF   P1EMPTYH        
                      01353 ;       BTFSS   TWOPROBE        ;###8 HERE
                      01354 ;       RETURN          ;miss next if single probe
                      01355 
0281   2153           01356         CALL    EEREADNEXT
0282   00D0           01357         MOVWF   P2EMPTYL
0283   2153           01358         CALL    EEREADNEXT
0284   00D1           01359         MOVWF   P2EMPTYH
                      01360 
0285   2153           01361         CALL    EEREADNEXT
0286   00E3           01362         MOVWF   P0EMPTYL
0287   2153           01363         CALL    EEREADNEXT
0288   00E4           01364         MOVWF   P0EMPTYH
                      01365 
0289   3032           01366         MOVLW   P1dfL   ;get stored drift values 
028A   2155           01367         CALL    EEREADADRW
028B   00E5           01368         MOVWF   P1DFL
028C   2153           01369         CALL    EEREADNEXT
028D   00E6           01370         MOVWF   P1DFH
028E   2153           01371         CALL    EEREADNEXT
028F   00E7           01372         MOVWF   P2DFL
0290   2153           01373         CALL    EEREADNEXT
0291   00E8           01374         MOVWF   P2DFH
                      01375 
0292   3010           01376         MOVLW   m12L    ;get M value
0293   2155           01377         CALL    EEREADADRW
0294   00EA           01378         MOVWF   M12L
0295   2153           01379         CALL    EEREADNEXT
0296   00EB           01380         MOVWF   M12H
                      01381 
0297   3036           01382         MOVLW   n_av    
0298   2155           01383         CALL    EEREADADRW
0299   00E9           01384         MOVWF   NAVCOUNT
                      01385         
029A   300C           01386         MOVLW   caldiv12L       ;get div @ cal value
029B   2155           01387         CALL    EEREADADRW
029C   00A6           01388         MOVWF   DIVATCALL
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 27
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

029D   2153           01389         CALL    EEREADNEXT
029E   00A7           01390         MOVWF   DIVATCALH       
029F   2153           01391         CALL    EEREADNEXT      ;###j here
02A0   00AA           01392         MOVWF   P1SPANATCALL
02A1   2153           01393         CALL    EEREADNEXT
02A2   00AB           01394         MOVWF   P1SPANATCALH    ;###j to here   
02A3   0008           01395         RETURN          ;###8 to here
                      01396 
02A4   01A3           01397 GETSPANCAL      CLRF    PWML
02A5   01A4           01398         CLRF    PWMH
02A6   2180           01399         CALL    PWMSET
                      01400 
                      01401 ;       CLRF    EEWRADDRESS     ;###10
                      01402 
02A7   160E           01403 GETHIGHLEVEL    BSF     ALARMOP ;###7
                      01404         ;CALL   GETCOMPPROBE    ;###10
02A8   2330           01405         CALL    GETP2
02A9   2341           01406         CALL    GETP1
                      01407 
                      01408         IF (SETFORTEST==1)
                      01409         CALL    GETFALSEDATA
                      01410         ENDIF
                      01411 
02AA   3008           01412 SAVEP12FULL     MOVLW   P1fullL ;store full values
02AB   00F4           01413         MOVWF   EEWRADDRESS
02AC   0832           01414         MOVFW   TMR1HP1
02AD   2165           01415         CALL    EEWRITEW
02AE   0831           01416         MOVFW   TMR1UP1
02AF   2161           01417         CALL    EEWRITEWNEXT
02B0   0835           01418         MOVFW   TMR1HP2
02B1   2161           01419         CALL    EEWRITEWNEXT
02B2   0834           01420         MOVFW   TMR1UP2
02B3   2161           01421         CALL    EEWRITEWNEXT    ;###10 to here
                      01422 
                      01423 
02B4   227C           01424 GETLOWLEVEL     CALL    MT_DF_M_N_DVC
                      01425 
                      01426 ;###q   BTFSS   TWOPROBE
                      01427 ;###q   GOTO    ONEPSPANCAL
                      01428 
02B5   083A           01429 RAWP1SPANCAL    MOVFW   P1EMPTYL        ;P1 RAW SPAN = P1-P1EMPTY 
02B6   02B2           01430         SUBWF   TMR1HP1 ;
02B7   083B           01431         MOVFW   P1EMPTYH        ;
02B8   3BB1           01432         SUBWFB  TMR1UP1
                      01433 
02B9   0850           01434 RAWP2SPANCAL    MOVFW   P2EMPTYL        ;P2 RAW SPAN = P2-P2EMPTY 
02BA   02B5           01435         SUBWF   TMR1HP2 ;
02BB   0851           01436         MOVFW   P2EMPTYH        ;
02BC   3BB4           01437         SUBWFB  TMR1UP2
                      01438 
                      01439 ;Calculate M12 = ((const1) - (((const2) x P1 RAW SPAN)/P2 RAW SPAN))
                      01440 ;where const1 = (13 x 2^12) and const2 = (4.726 x 2^12)
                      01441 
02BD   0832           01442 M12CAL  MOVFW   TMR1HP1
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 28
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02BE   00C5           01443         MOVWF   M1L
02BF   0831           01444         MOVFW   TMR1UP1
02C0   00C4           01445         MOVWF   M1H     ;P1 RAW SPAN to M1
                      01446         
02C1   301F           01447         MOVLW   LOW const2
02C2   00C7           01448         MOVWF   M2L
02C3   3071           01449         MOVLW   HIGH const2
02C4   00C6           01450         MOVWF   M2H     ;const2 to M2
                      01451         
02C5   221E           01452         CALL    MULT16X16       ;multiply
                      01453 
02C6   0835           01454         MOVFW   TMR1HP2
02C7   00C5           01455         MOVWF   DIVL
02C8   0834           01456         MOVFW   TMR1UP2
02C9   00C4           01457         MOVWF   DIVH    ;P2 RAW SPAN to DIV
                      01458         
02CA   2239           01459         CALL    UDIV3216L       ;divide - result in lower 2 bytes of AARG       
                      01460 
02CB   30E6           01461         MOVLW   HIGH const1
02CC   00C6           01462         MOVWF   M2H
02CD   3066           01463         MOVLW   LOW const1
02CE   00C7           01464         MOVWF   M2L     ;const1 in M2H
                      01465 
02CF   0843           01466         MOVFW   AARGB3
02D0   02C7           01467         SUBWF   M2L
02D1   0842           01468         MOVFW   AARGB2
02D2   3BC6           01469         SUBWFB  M2H     ;const1-result in M2
                      01470 
02D3   3010           01471 STOREM12        MOVLW   m12L
02D4   00F4           01472         MOVWF   EEWRADDRESS
02D5   0847           01473         MOVFW   M2L
02D6   2165           01474         CALL    EEWRITEW
02D7   0846           01475         MOVFW   M2H
02D8   2161           01476         CALL    EEWRITEWNEXT
                      01477 
02D9   0832           01478 CALCDIVATCAL    MOVFW   TMR1HP1
02DA   00C5           01479         MOVWF   M1L
02DB   0831           01480         MOVFW   TMR1UP1
02DC   00C4           01481         MOVWF   M1H     ;P1 RAW SPAN to M1 (M12 still in M2)            
                      01482 
02DD   221E           01483         CALL    MULT16X16       ;RAW P1 SPAN x M12 result in AARG
                      01484 
02DE   0835           01485         MOVFW   TMR1HP2
02DF   00C5           01486         MOVWF   DIVL
02E0   0834           01487         MOVFW   TMR1UP2
02E1   00C4           01488         MOVWF   DIVH    ;P2 RAW SPAN to DIV
                      01489         
02E2   2239           01490         CALL    UDIV3216L       ;((RAW P1 SPAN x M12)/RAW P2 SPAN) - result in lower 2 bytes of AARG  
                              
                      01491 
02E3   30D0           01492         MOVLW   LOW const3      ;subtract const3 (7.43 x 2^12)= div@cal
02E4   02C3           01493         SUBWF   AARGB3
02E5   3064           01494         MOVLW   HIGH const3
02E6   3BC2           01495         SUBWFB  AARGB2
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 29
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01496         
02E7   300C           01497 STOREDIVATCAL   MOVLW   caldiv12L
02E8   00F4           01498         MOVWF   EEWRADDRESS
02E9   3000           01499         MOVLW   onepdivL        ;###q
02EA   1BF7           01500         BTFSC   TWOPROBE        ;###q
02EB   0843           01501         MOVFW   AARGB3
02EC   00DA           01502         MOVWF   CURRDIVL
02ED   00A6           01503         MOVWF   DIVATCALL
02EE   2165           01504         CALL    EEWRITEW
02EF   3010           01505         MOVLW   onepdivH        ;###q
02F0   1BF7           01506         BTFSC   TWOPROBE        ;###q
02F1   0842           01507         MOVFW   AARGB2
02F2   00D9           01508         MOVWF   CURRDIVH
02F3   00A7           01509         MOVWF   DIVATCALH
02F4   2161           01510         CALL    EEWRITEWNEXT    ;store div@cal x 2^12   
                      01511 
02F5   2329           01512         CALL    STOREAVDIV
                      01513 
02F6   0832           01514 CALCP1SPAN      MOVFW   TMR1HP1
02F7   00C5           01515         MOVWF   M1L
02F8   0831           01516         MOVFW   TMR1UP1
02F9   00C4           01517         MOVWF   M1H     ;P1 RAW SPAN to M1      
                      01518 
02FA   01C7           01519         CLRF    M2L
02FB   3010           01520         MOVLW   HIGH .4096
02FC   00C6           01521         MOVWF   M2H     ;2^12 to M2
                      01522         
02FD   221E           01523         CALL    MULT16X16
                      01524 
                      01525 ;       MOVLW   caldiv12L
                      01526 ;       CALL    EEREADADRW
02FE   0826           01527         MOVFW   DIVATCALL
02FF   00C5           01528         MOVWF   DIVL    ;###h was remmed
                      01529 ;       CALL    EEREADNEXT
0300   0827           01530         MOVFW   DIVATCALH
0301   00C4           01531         MOVWF   DIVH
                      01532         
0302   2239           01533         CALL    UDIV3216L       ;P1 SPAN = (2^12 x P1 RAW SPAN)/CALDIV12
                      01534 
0303   300E           01535 STOREP1SPAN     MOVLW   P1calspanL
0304   00F4           01536         MOVWF   EEWRADDRESS
0305   0843           01537         MOVFW   AARGB3
0306   2165           01538         CALL    EEWRITEW
0307   0842           01539         MOVFW   AARGB2
0308   2161           01540         CALL    EEWRITEWNEXT    ;store P1 SPAN@cal
                      01541         
0309   3001           01542 SAVESPANEND     MOVLW   calstatus
030A   00F4           01543         MOVWF   EEWRADDRESS
030B   3003           01544         MOVLW   spandone
030C   00F5           01545         MOVWF   CALSTATUS
030D   2165           01546         CALL    EEWRITEW
                      01547                         
030E   120E           01548 SAVESPANENDa    BCF     ALARMOP ;###7
030F   01A1           01549         CLRF    FLASHER ;###7 ensure wait
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 30
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0310   0AA1           01550         INCF    FLASHER ;###7 before main
0311   0008           01551         RETURN
                      01552 
                      01553 ;###q here
                      01554 ;ONEPSPANCAL    MOVFW   P1EMPTYL        ;P1 RAW SPAN = P1-P1EMPTY 
                      01555 ;       SUBWF   TMR1HP1 ;
                      01556 ;       MOVFW   P1EMPTYH        ;
                      01557 ;       SUBWFB  TMR1UP1
                      01558 
                      01559 ;STORERAWSPAN   MOVLW   P1calspanL      ;use same location as 2-probe
                      01560 ;       MOVWF   EEWRADDRESS
                      01561 ;       MOVFW   TMR1HP1
                      01562 ;       CALL    EEWRITEW
                      01563 ;       MOVFW   TMR1UP1
                      01564 ;       CALL    EEWRITEWNEXT    ;store P1 SPAN@cal
                      01565 
                      01566 ;       GOTO    SAVESPANEND
                      01567 ;###q to here
                      01568 
                      01569 
0312   160E           01570 GETLCAL BSF     ALARMOP ;###7
                      01571         ;CLRF   EEWRADDRESS     ;###10 here
                      01572         ;CALL   GETCOMPPROBE
0313   2330           01573         CALL    GETP2
0314   2341           01574         CALL    GETP1
0315   2352           01575         CALL    GETP0   ;###10 to here
                      01576         
0316   3001           01577 SAVELCAL        MOVLW   calstatus
0317   00F4           01578         MOVWF   EEWRADDRESS     
0318   3001           01579         MOVLW   emptydone
0319   00F5           01580         MOVWF   CALSTATUS
031A   2165           01581         CALL    EEWRITEW
031B   0832           01582         MOVFW   TMR1HP1
031C   2161           01583         CALL    EEWRITEWNEXT
031D   0831           01584         MOVFW   TMR1UP1 ;save P1E
031E   2161           01585         CALL    EEWRITEWNEXT            
                      01586 ;###q   BTFSS   TWOPROBE        ;###8 HERE
                      01587 ;###q   GOTO    SAVELCALa
031F   0835           01588         MOVFW   TMR1HP2
0320   2161           01589         CALL    EEWRITEWNEXT
0321   0834           01590         MOVFW   TMR1UP2 ;save P2E
0322   2161           01591         CALL    EEWRITEWNEXT    ;###8 TO HERE
0323   0838           01592         MOVFW   TMR1HP0 ;###10 here
0324   2161           01593         CALL    EEWRITEWNEXT
0325   0837           01594         MOVFW   TMR1UP0 ;save P0E
0326   2161           01595         CALL    EEWRITEWNEXT    ;###10 to here
                      01596 
0327   120E           01597 SAVELCALa       BCF     ALARMOP ;###7
0328   0008           01598         RETURN
                      01599 
0329   3012           01600 STOREAVDIV      MOVLW   currdiv12L
032A   00F4           01601         MOVWF   EEWRADDRESS
032B   0828           01602         MOVFW   AVDIVL_OVER20
032C   2165           01603         CALL    EEWRITEW
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 31
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

032D   0829           01604         MOVFW   AVDIVH_OVER20
032E   2161           01605         CALL    EEWRITEWNEXT
032F   0008           01606         RETURN
                      01607 
0330   30F3           01608 GETP2   MOVLW   B'11110011'             ;both probes disabled
0331   058E           01609         ANDWF   PORTC
0332   3004           01610         MOVLW   enref_P2                ;set ref/probe2 connection
0333   048E           01611         IORWF   PORTC
0334   1570           01612         BSF     GETTINGP2
0335   1670           01613         BSF     T0WAITSTART
0336   1970           01614         BTFSC   GETTINGP2
0337   2B36           01615         GOTO    ($-1)
0338   0008           01616         RETURN  
                      01617         
0339   0816           01618 TRANSFERP2      MOVFW   TMR1L
033A   00B6           01619         MOVWF   TMR1LP2
033B   0817           01620         MOVFW   TMR1H
033C   00B5           01621         MOVWF   TMR1HP2 
033D   0830           01622         MOVFW   TMR1U
033E   00B4           01623         MOVWF   TMR1UP2
033F   1170           01624         BCF     GETTINGP2
0340   0008           01625         RETURN
                      01626 
                      01627 
0341   30F3           01628 GETP1   MOVLW   B'11110011'             ;both probes disabled
0342   058E           01629         ANDWF   PORTC
0343   3008           01630         MOVLW   enP1            ;set probe connection
0344   048E           01631         IORWF   PORTC           
0345   14F0           01632         BSF     GETTINGP1
0346   1670           01633         BSF     T0WAITSTART
0347   18F0           01634         BTFSC   GETTINGP1
0348   2B47           01635         GOTO    ($-1)
0349   0008           01636         RETURN
                      01637 
034A   0816           01638 TRANSFERP1      MOVFW   TMR1L
034B   00B3           01639         MOVWF   TMR1LP1
034C   0817           01640         MOVFW   TMR1H
034D   00B2           01641         MOVWF   TMR1HP1 
034E   0830           01642         MOVFW   TMR1U
034F   00B1           01643         MOVWF   TMR1UP1
0350   10F0           01644         BCF     GETTINGP1
0351   0008           01645         RETURN
                      01646         
0352   30F3           01647 GETP0   MOVLW   B'11110011'     ;###9 here
0353   058E           01648         ANDWF   PORTC   ;both probes de-selected
                      01649                 
0354   1470           01650         BSF     GETTINGP0
0355   1670           01651         BSF     T0WAITSTART
0356   1870           01652         BTFSC   GETTINGP0
0357   2B56           01653         GOTO    ($-1)
0358   0008           01654         RETURN
                      01655 
0359   0816           01656 TRANSFERP0      MOVFW   TMR1L
035A   00B9           01657         MOVWF   TMR1LP0
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 32
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

035B   0817           01658         MOVFW   TMR1H
035C   00B8           01659         MOVWF   TMR1HP0 
035D   0830           01660         MOVFW   TMR1U
035E   00B7           01661         MOVWF   TMR1UP0
035F   1070           01662         BCF     GETTINGP0
0360   0008           01663         RETURN          ;###9 to here
                      01664 
                      01665 
0361   1EF0           01666 SENDDIAGDATA    BTFSS   SENDPARAMS
0362   0008           01667         RETURN
                      01668 
0363   0837           01669         MOVFW   TMR1UP0 ;send P0 data
0364   209B           01670         CALL    TESTSENDTXW
0365   0838           01671         MOVFW   TMR1HP0
0366   209B           01672         CALL    TESTSENDTXW
                      01673 ;       MOVFW   TMR1LP0
                      01674 ;       CALL    TESTSENDTXW
                      01675 
0367   0831           01676         MOVFW   TMR1UP1 ;send PROBE1 data
0368   209B           01677         CALL    TESTSENDTXW
0369   0832           01678         MOVFW   TMR1HP1
036A   209B           01679         CALL    TESTSENDTXW
                      01680 ;       MOVFW   TMR1LP1
                      01681 ;       CALL    TESTSENDTXW
                      01682 
036B   0834           01683         MOVFW   TMR1UP2 ;send PROBE2 data
036C   209B           01684         CALL    TESTSENDTXW
036D   0835           01685         MOVFW   TMR1HP2
036E   209B           01686         CALL    TESTSENDTXW
                      01687 ;       MOVFW   TMR1LP2
                      01688 ;       CALL    TESTSENDTXW
                      01689 
036F   0855           01690         MOVFW   CALCP1H ;send CALCP1
0370   209B           01691         CALL    TESTSENDTXW     
0371   0856           01692         MOVFW   CALCP1L
0372   209B           01693         CALL    TESTSENDTXW
                      01694         
0373   0857           01695         MOVFW   CALCP2H ;send CALCP2
0374   209B           01696         CALL    TESTSENDTXW     
0375   0858           01697         MOVFW   CALCP2L
0376   209B           01698         CALL    TESTSENDTXW
                      01699 
0377   0859           01700         MOVFW   CURRDIVH        ;send DIVISOR
0378   209B           01701         CALL    TESTSENDTXW     
0379   085A           01702         MOVFW   CURRDIVL
037A   209B           01703         CALL    TESTSENDTXW
                      01704         
037B   085C           01705         MOVFW   AVDIVH  ;send AVDIV
037C   209B           01706         CALL    TESTSENDTXW     
037D   085D           01707         MOVFW   AVDIVL
037E   209B           01708         CALL    TESTSENDTXW
                      01709 
037F   1EA0           01710         BTFSS   DRESISTIVE      ;### r here
0380   2B89           01711         GOTO    CONVPWMTOSEND
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 33
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01712 
0381   01FE           01713         CLRF    TEMPHI  ;send PR2+1 = R Multiplier
0382   081B           01714         MOVFW   PR2
0383   00FF           01715         MOVWF   TEMPLO
0384   3001           01716         MOVLW   .1
0385   07FF           01717         ADDWF   TEMPLO
0386   0103           01718         CLRW
0387   3DFE           01719         ADDWFC  TEMPHI
                      01720         
0388   2B94           01721         GOTO    SENDPWM_PR2     ;### to here
                      01722 
0389                  01723 CONVPWMTOSEND
0389   0025           01724         BANKSEL CCPR1L
038A   3511           01725         LSLF    CCPR1L,W        ;put 10-bit PWM into TEMPLO/HI
038B   00FF           01726         MOVWF   TEMPLO
038C   01FE           01727         CLRF    TEMPHI
038D   0DFE           01728         RLF     TEMPHI
038E   35FF           01729         LSLF    TEMPLO
038F   0DFE           01730         RLF     TEMPHI          
0390   0E13           01731         SWAPF   CCP1CON,W
0391   3903           01732         ANDLW   B'00000011'
0392   04FF           01733         IORWF   TEMPLO
0393   0020           01734         BANKSEL 0
                      01735         
0394   087E           01736 SENDPWM_PR2     MOVFW   TEMPHI  ;send last PWM
0395   209B           01737         CALL    TESTSENDTXW
0396   087F           01738         MOVFW   TEMPLO
0397   209B           01739         CALL    TESTSENDTXW
                      01740 
0398   082D           01741         MOVFW   DIVUSEDH        ;send divisor used in calc ###j
0399   209B           01742         CALL    TESTSENDTXW
039A   082C           01743         MOVFW   DIVUSEDL
039B   209B           01744         CALL    TESTSENDTXW
                      01745 
039C   30FF           01746         MOVLW   0FF
039D   1F54           01747         BTFSS   SAVEINDICATOR
039E   3000           01748         MOVLW   0
039F   209B           01749         CALL    TESTSENDTXW
03A0   1354           01750         BCF     SAVEINDICATOR
                      01751         
03A1   12F0           01752         BCF     SENDPARAMS      ;one shot only
                      01753         
03A2   0008           01754         RETURN
                      01755 
03A3   1320           01756 GETCOMPPROBE    BCF     COMMSBEENON     ;clear flag
03A4   2330           01757         CALL    GETP2   
03A5   2341           01758         CALL    GETP1
03A6   2352           01759         CALL    GETP0
03A7   0008           01760         RETURN
                      01761 
                      01762         IF (SETFORTEST==1)
                      01763 
                      01764 GETFALSEDATA    MOVLW   HIGH .2320
                      01765         MOVWF   TMR1UP0
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 34
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01766         MOVLW   LOW .2320       ;negative value
                      01767         MOVWF   TMR1HP0
                      01768         
                      01769 INJECT1 BTFSC   TEST,0
                      01770         GOTO    INJECT1B
                      01771         BTFSC   TEST,1
                      01772         GOTO    INJECT1C
                      01773 
                      01774 INJECT1A        MOVLW   HIGH .28354
                      01775         MOVWF   TMR1UP1
                      01776         MOVLW   LOW .28354      ;30568
                      01777         MOVWF   TMR1HP1
                      01778         GOTO    INJECT2
                      01779 
                      01780 INJECT1B        MOVLW   HIGH .34354
                      01781         MOVWF   TMR1UP1
                      01782         MOVLW   LOW .34354      ;30568
                      01783         MOVWF   TMR1HP1
                      01784         GOTO    INJECT2
                      01785         
                      01786 INJECT1C        MOVLW   HIGH .3354
                      01787         MOVWF   TMR1UP1
                      01788         MOVLW   LOW .3354       ;30568
                      01789         MOVWF   TMR1HP1
                      01790 
                      01791 INJECT2 BTFSC   TEST,4
                      01792         GOTO    INJECT2B
                      01793         BTFSC   TEST,5
                      01794         GOTO    INJECT2C
                      01795 
                      01796 INJECT2A        MOVLW   HIGH .29477
                      01797         MOVWF   TMR1UP2
                      01798         MOVLW   LOW .29477      ;31561
                      01799         MOVWF   TMR1HP2
                      01800         RETURN
                      01801 
                      01802 INJECT2B        MOVLW   HIGH .35477
                      01803         MOVWF   TMR1UP2
                      01804         MOVLW   LOW .35477      ;31561
                      01805         MOVWF   TMR1HP2
                      01806         RETURN
                      01807         
                      01808 INJECT2C        MOVLW   HIGH .3477
                      01809         MOVWF   TMR1UP2
                      01810         MOVLW   LOW .3477       ;31561
                      01811         MOVWF   TMR1HP2
                      01812         RETURN
                      01813 
                      01814         ENDIF
                      01815 
03A8                  01816 TWOPROBECALC    
                      01817         IF (SETFORTEST==1)
                      01818         CALL    GETFALSEDATA
                      01819         ENDIF
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 35
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01820 
03A8   0837           01821 ONEPDRIFTCALC   MOVFW   TMR1UP0 ;entry point for one probe calcs
03A9   00E1           01822         MOVWF   P0DFH
03AA   0838           01823         MOVFW   TMR1HP0
03AB   00E2           01824         MOVWF   P0DFL   ;transfer current P0
                      01825         
03AC   1154           01826         BCF     DRIFTNEG        ;clear flag
03AD   0863           01827         MOVFW   P0EMPTYL
03AE   02E2           01828         SUBWF   P0DFL
03AF   0864           01829         MOVFW   P0EMPTYH
03B0   3BE1           01830         SUBWFB  P0DFH   ;P0-P0_empty
                      01831         
03B1   1803           01832         SKPNC           ;no carry indicates negative
03B2   2BBA           01833         GOTO    P1DFCALC
                      01834         
03B3   1554           01835 P0DFNEGATIVE    BSF     DRIFTNEG
03B4   09E2           01836         COMF    P0DFL
03B5   09E1           01837         COMF    P0DFH   ;complement
03B6   3001           01838         MOVLW   .1
03B7   07E2           01839         ADDWF   P0DFL
03B8   0103           01840         CLRW
03B9   3DE1           01841         ADDWFC  P0DFH   ;& add 1
                      01842         
03BA   0865           01843 P1DFCALC        MOVFW   P1DFL   ;constant from EEPROM
03BB   00C5           01844         MOVWF   M1L
03BC   0866           01845         MOVFW   P1DFH
03BD   00C4           01846         MOVWF   M1H
                      01847         
03BE   0862           01848         MOVFW   P0DFL
03BF   00C7           01849         MOVWF   M2L
03C0   0861           01850         MOVFW   P0DFH
03C1   00C6           01851         MOVWF   M2H
                      01852         
03C2   221E           01853         CALL    MULT16X16       ;Result - P1df * 2^8 IN AARGB1(H) & AARGB2(L)
                      01854 
                      01855 ;###q   BTFSS   TWOPROBE
                      01856 ;###q   RETURN          ;exit if one probe
                      01857         
03C3   083A           01858 P1CALC  MOVFW   P1EMPTYL        ;Current probe - empty = CALCPx
03C4   0232           01859         SUBWF   TMR1HP1,W
03C5   00D6           01860         MOVWF   CALCP1L
03C6   083B           01861         MOVFW   P1EMPTYH
03C7   3B31           01862         SUBWFB  TMR1UP1,W
03C8   00D5           01863         MOVWF   CALCP1H
                      01864 
03C9   1803           01865         SKPNC
03CA   2BCE           01866         GOTO    P1CALCa
03CB   01D5           01867         CLRF    CALCP1H ;if -VE set to zero
03CC   01D6           01868         CLRF    CALCP1L
03CD   2BDD           01869         GOTO    P1_20PCCALC     ;###j exit routine
                      01870 
03CE   1D54           01871 P1CALCa BTFSS   DRIFTNEG
03CF   2BD5           01872         GOTO    P1SUBDRIFT
03D0   0842           01873 P1ADDDRIFT      MOVFW   AARGB2
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 36
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03D1   07D6           01874         ADDWF   CALCP1L
03D2   0841           01875         MOVFW   AARGB1
03D3   3DD5           01876         ADDWFC  CALCP1H
03D4   2BDD           01877         GOTO    P1_20PCCALC     ;###j exit routine
                      01878 
03D5   0842           01879 P1SUBDRIFT      MOVFW   AARGB2
03D6   02D6           01880         SUBWF   CALCP1L
03D7   0841           01881         MOVFW   AARGB1
03D8   3BD5           01882         SUBWFB  CALCP1H 
                      01883 
03D9   1803           01884         SKPNC
03DA   2BDD           01885         GOTO    P1_20PCCALC     ;###j
03DB   01D5           01886         CLRF    CALCP1H ;if -VE set to zero
03DC   01D6           01887         CLRF    CALCP1L
                      01888 
03DD   12D4           01889 P1_20PCCALC     BCF     OVER20PCCSPAN   ;###j here
03DE   082A           01890         MOVFW   P1SPANATCALL    ;SPAN@CAL/5 (20%)
03DF   00C3           01891         MOVWF   AARGB3
03E0   082B           01892         MOVFW   P1SPANATCALH
03E1   00C2           01893         MOVWF   AARGB2
03E2   01C1           01894         CLRF    AARGB1
03E3   01C0           01895         CLRF    AARGB0
03E4   01C4           01896         CLRF    DIVH
03E5   3005           01897         MOVLW   .5
03E6   00C5           01898         MOVWF   DIVL    
03E7   2239           01899         CALL    UDIV3216L       ;result in AARGB2/3 (H/L)
03E8   0843           01900         MOVFW   AARGB3  ;subract 20% span from current span
03E9   0256           01901         SUBWF   CALCP1L,W
03EA   0842           01902         MOVFW   AARGB2
03EB   3B55           01903         SUBWFB  CALCP1H,W
03EC   1803           01904         SKPNC
03ED   16D4           01905         BSF     OVER20PCCSPAN   ;###j to here
                      01906 
03EE   0867           01907 P2DFCALC        MOVFW   P2DFL   ;constant from EEPROM
03EF   00C5           01908         MOVWF   M1L
03F0   0868           01909         MOVFW   P2DFH
03F1   00C4           01910         MOVWF   M1H
                      01911         
03F2   0862           01912         MOVFW   P0DFL
03F3   00C7           01913         MOVWF   M2L
03F4   0861           01914         MOVFW   P0DFH
03F5   00C6           01915         MOVWF   M2H
                      01916         
03F6   221E           01917         CALL    MULT16X16       ;Result - P1df/2^8 IN AARGB1(H) & AARGB2(L)
                      01918         
03F7   0850           01919 P2CALC  MOVFW   P2EMPTYL        ;Current probe - empty = CALCPx
03F8   0235           01920         SUBWF   TMR1HP2,W
03F9   00D8           01921         MOVWF   CALCP2L
03FA   0851           01922         MOVFW   P2EMPTYH
03FB   3B34           01923         SUBWFB  TMR1UP2,W
03FC   00D7           01924         MOVWF   CALCP2H
                      01925 
03FD   1803           01926         SKPNC
03FE   2C02           01927         GOTO    P2CALCa
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 37
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03FF   01D7           01928         CLRF    CALCP2H ;if -VE set to zero
0400   01D8           01929         CLRF    CALCP2L
0401   2C11           01930         GOTO    P2DFCALCEND     ;exit routine
                      01931 
0402   1D54           01932 P2CALCa BTFSS   DRIFTNEG
0403   2C09           01933         GOTO    P2SUBDRIFT
0404   0842           01934 P2ADDDRIFT      MOVFW   AARGB2
0405   07D8           01935         ADDWF   CALCP2L
0406   0841           01936         MOVFW   AARGB1
0407   3DD7           01937         ADDWFC  CALCP2H
0408   2C11           01938         GOTO    P2DFCALCEND
                      01939 
0409   0842           01940 P2SUBDRIFT      MOVFW   AARGB2
040A   02D8           01941         SUBWF   CALCP2L
040B   0841           01942         MOVFW   AARGB1
040C   3BD7           01943         SUBWFB  CALCP2H 
                      01944 
040D   1803           01945         SKPNC
040E   2C11           01946         GOTO    P2DFCALCEND
040F   01D7           01947         CLRF    CALCP2H ;if -VE set to zero
0410   01D8           01948         CLRF    CALCP2L
                      01949 
0411   1FF7           01950 P2DFCALCEND     BTFSS   TWOPROBE        ;###q
0412   2C2F           01951         GOTO    SETCURRDIV      ;###q
0413   0857           01952 P2DFCANCENDa    MOVFW   CALCP2H
0414   0458           01953         IORWF   CALCP2L,W
0415   1D03 2C1D      01954         BNZ     CALC_CURRDIV
                      01955 
0417   300C           01956 P2ZERO  MOVLW   caldiv12L       ;if P2 zero, use div@cal
0418   2155           01957         CALL    EEREADADRW
0419   00DA           01958         MOVWF   CURRDIVL
041A   2153           01959         CALL    EEREADNEXT
041B   00D9           01960         MOVWF   CURRDIVH
041C   2C37           01961         GOTO    DIVAVERAGE
                      01962 
041D   0856           01963 CALC_CURRDIV    MOVFW   CALCP1L
041E   00C5           01964         MOVWF   M1L
041F   0855           01965         MOVFW   CALCP1H
0420   00C4           01966         MOVWF   M1H     ;CALCP1 to M1           
                      01967 
0421   086A           01968         MOVFW   M12L
0422   00C7           01969         MOVWF   M2L
0423   086B           01970         MOVFW   M12H
0424   00C6           01971         MOVWF   M2H     ;M12 in M2      
                      01972         
0425   221E           01973         CALL    MULT16X16       ;P1 CALC SPAN x M12 result in AARG
                      01974 
0426   0858           01975         MOVFW   CALCP2L
0427   00C5           01976         MOVWF   DIVL
0428   0857           01977         MOVFW   CALCP2H
0429   00C4           01978         MOVWF   DIVH    ;P2 CALC SPAN to DIV
                      01979         
042A   2239           01980         CALL    UDIV3216L       ;((CALC P1 SPAN x M12)/CALC P2 SPAN) - result in lower 2 bytes of AARG
                              
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 38
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01981 
042B   30D0           01982         MOVLW   LOW const3      ;subtract const3 (7.43 x 2^12)= current div
042C   02C3           01983         SUBWF   AARGB3
042D   3064           01984         MOVLW   HIGH const3
042E   3BC2           01985         SUBWFB  AARGB2
                      01986         
042F   3000           01987 SETCURRDIV      MOVLW   onepdivL        ;###q
0430   1BF7           01988         BTFSC   TWOPROBE        ;###q
0431   0843           01989         MOVFW   AARGB3
0432   00DA           01990         MOVWF   CURRDIVL
                      01991 
0433   3010           01992         MOVLW   onepdivH        ;###q
0434   1BF7           01993         BTFSC   TWOPROBE        ;###q
0435   0842           01994         MOVFW   AARGB2
0436   00D9           01995         MOVWF   CURRDIVH        ;move result to current div x 2^12      
                      01996 
0437   1ED4           01997 DIVAVERAGE      BTFSS   OVER20PCCSPAN   ;###h altered routine
0438   2497           01998         CALL    RESETSAVETIME   ;set full delay
0439   1AD4           01999         BTFSC   OVER20PCCSPAN   ;###n
043A   220A           02000         CALL    DOAVERAGE
                      02001                         
043B   0856           02002 CALCNEWP1       MOVFW   CALCP1L
043C   00C5           02003         MOVWF   M1L
043D   0855           02004         MOVFW   CALCP1H
043E   00C4           02005         MOVWF   M1H
                      02006         
043F   3000           02007         MOVLW   LOW .4096
0440   00C7           02008         MOVWF   M2L
0441   3010           02009         MOVLW   HIGH .4096
0442   00C6           02010         MOVWF   M2H
                      02011         
0443   221E           02012         CALL    MULT16X16       ;P1 x 2^12
                      02013 
0444   0826           02014 DIVATCAL97      MOVFW   DIVATCALL       ;transfer ###t here
0445   00EE           02015         MOVWF   DIVATCAL97L
0446   0827           02016         MOVFW   DIVATCALH
0447   00EF           02017         MOVWF   DIVATCAL97H
                      02018 
0448   0CEF           02019         RRF     DIVATCAL97H
0449   0CEE           02020         RRF     DIVATCAL97L
044A   0CEF           02021         RRF     DIVATCAL97H
044B   0CEE           02022         RRF     DIVATCAL97L
044C   0CEF           02023         RRF     DIVATCAL97H
044D   0CEE           02024         RRF     DIVATCAL97L
044E   0CEF           02025         RRF     DIVATCAL97H
044F   0CEE           02026         RRF     DIVATCAL97L
0450   0CEF           02027         RRF     DIVATCAL97H
0451   0CEE           02028         RRF     DIVATCAL97L     ;divide by 32   
0452   3007           02029         MOVLW   B'00000111'
0453   05EF           02030         ANDWF   DIVATCAL97H     ;remove any wrapped round bits
                      02031         
0454   086E           02032         MOVFW   DIVATCAL97L     ;subract from DIVATCAL. Result in DIVATCAL97
0455   0226           02033         SUBWF   DIVATCALL,W
0456   00EE           02034         MOVWF   DIVATCAL97L
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 39
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0457   086F           02035         MOVFW   DIVATCAL97H     
0458   3B27           02036         SUBWFB  DIVATCALH,W
0459   00EF           02037         MOVWF   DIVATCAL97H     ;###t to here
                      02038 
                      02039 
045A   1254           02040 TESTFORLOWDIV   BCF     CDIVISLOW
045B   086E           02041         MOVFW   DIVATCAL97L             ;###t
045C   0228           02042         SUBWF   AVDIVL_OVER20,W
045D   086F           02043         MOVFW   DIVATCAL97H             ;###t
045E   3B29           02044         SUBWFB  AVDIVH_OVER20,W
045F   1C03           02045         SKPC
0460   1654           02046         BSF     CDIVISLOW               
                      02047 
0461   0828           02048         MOVFW   AVDIVL_OVER20   ;###h alteration ###j altered from just AVDIVL
0462   1A54           02049         BTFSC   CDIVISLOW       ;substitute if current div low
0463   086E           02050         MOVFW   DIVATCAL97L     ;###t
                      02051 
0464   1FF7           02052         BTFSS   TWOPROBE        ;###q
0465   3000           02053         MOVLW   onepdivL        ;###q
                      02054 
0466   00AC           02055         MOVWF   DIVUSEDL
0467   00C5           02056         MOVWF   DIVL
                      02057 
0468   0829           02058         MOVFW   AVDIVH_OVER20   ;###j altered from just AVDIVH  
0469   1A54           02059         BTFSC   CDIVISLOW       ;substitute if current div low
046A   086F           02060         MOVFW   DIVATCAL97H     ;###t
                      02061 
046B   1FF7           02062         BTFSS   TWOPROBE        ;###q
046C   3010           02063         MOVLW   onepdivH        ;###q
                      02064 
046D   00AD           02065         MOVWF   DIVUSEDH
046E   00C4           02066         MOVWF   DIVH
                      02067         
046F   2239           02068         CALL    UDIV3216L       ;divide by av12
                      02069         
0470   0843           02070         MOVFW   AARGB3
0471   00ED           02071         MOVWF   PROBE1L         
0472   0842           02072         MOVFW   AARGB2
0473   00EC           02073         MOVWF   PROBE1H
                      02074                 
0474   0008           02075         RETURN
                      02076 
0475   3004           02077 TIMESHIFT       MOVLW   tmr1shift       ;shift selectively into upper bytes     
0476   00C9           02078         MOVWF   LOOPCOUNT
0477   08C9           02079         TSTF    LOOPCOUNT
0478   1903           02080         SKPNZ
0479   0008           02081         RETURN
                      02082         
047A   1003           02083 TSHIFTLOOP      CLRC
047B   0D96           02084         RLF     TMR1L
047C   0D97           02085         RLF     TMR1H
047D   0DB0           02086         RLF     TMR1U
047E   0BC9           02087         DECFSZ  LOOPCOUNT
047F   2C7A           02088         GOTO    TSHIFTLOOP      
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 40
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0480   0008           02089         RETURN
                      02090 
0481   0185           02091 ADDTOTIMEp      CLRF    FSR0H
0482   30A0           02092         MOVLW   TIMEL
0483   0084           02093         MOVWF   FSR0L
0484   0816           02094         MOVFW   TMR1L
0485   0780           02095         ADDWF   INDF0
0486   0A84           02096         INCF    FSR0L
0487   0817           02097         MOVFW   TMR1H
0488   3D80           02098         ADDWFC  INDF0
0489   0A84           02099         INCF    FSR0L
048A   0830           02100         MOVFW   TMR1U
048B   3D80           02101         ADDWFC  INDF0
048C   0A84           02102         INCF    FSR0L
048D   0103           02103         CLRW
048E   3D80           02104         ADDWFC  INDF0
048F   0880           02105         TSTF    INDF0
0490   1903           02106         SKPNZ
0491   15D4           02107         BSF     SAVEFLAG
0492   1DD4           02108         BTFSS   SAVEFLAG        ;may have been set elsewhere
0493   0008           02109         RETURN
0494   2329           02110         CALL    STOREAVDIV
0495   11D4           02111         BCF     SAVEFLAG
0496   1754           02112         BSF     SAVEINDICATOR   ;for diagnostics
0497                  02113 RESETSAVETIME   
0497   0021           02114         BANKSEL TIMEUU
0498   3001           02115         MOVLW   .1
0499   00A3           02116         MOVWF   TIMEUU
049A   0020           02117         BANKSEL 0       
049B   0008           02118         RETURN
                      02119 
049C   0185           02120 ADDTOTIMEt      CLRF    FSR0H
049D   30A2           02121         MOVLW   TIMEU
049E   0084           02122         MOVWF   FSR0L
049F   3001           02123         MOVLW   .1      ;add in 65536
04A0   0780           02124         ADDWF   INDF0
04A1   0A84           02125         INCF    FSR0L
04A2   0103           02126         CLRW
04A3   3D80           02127         ADDWFC  INDF0
04A4   0880           02128         TSTF    INDF0
04A5   1903           02129         SKPNZ
04A6   15D4           02130         BSF     SAVEFLAG
04A7   0008           02131         RETURN
                      02132         
                      02133 ;cold start *****************************************************************
                      02134 
04A8                  02135 CSTART          
04A8   0021           02136         BANKSEL OSCCON
04A9   3070           02137         MOVLW   OSCCONset
04AA   0099           02138         MOVWF   OSCCON  ;set clock
04AB   0020           02139         BANKSEL PORTA
                      02140         
04AC   018C           02141         CLRF    PORTA
                      02142 
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 41
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02143         IFDEF __16F1823
04AD   018E           02144         CLRF    PORTC
                      02145         ENDIF
                      02146         
                      02147         IFDEF __16LF1823
                      02148         CLRF    PORTC
                      02149         ENDIF
                      02150 
04AE   20DC           02151         CALL    SETUP
04AF   018C           02152         CLRF    PORTA
                      02153 
                      02154         IFDEF __16F1823
04B0   018E           02155         CLRF    PORTC
                      02156         ENDIF
                      02157         
                      02158         IFDEF __16LF1823
                      02159         CLRF    PORTC
                      02160         ENDIF
                      02161 
04B1   3020           02162         MOVLW           20                      ;clear registers
04B2   0084           02163         MOVWF           FSR0L
04B3   0185           02164         CLRF    FSR0H
04B4   0103           02165 INITLOOP        CLRW
04B5   001A           02166         MOVWI   FSR0++
                      02167 
04B6   307F           02168         MOVLW           B'01111111'             ;if 0 or 80 reached
04B7   0504           02169         ANDWF           FSR0L,W
04B8   1903           02170         SKPNZ
04B9   1684           02171         BSF     FSR0L,5         ;add 20
04BA   30F0           02172         MOVLW   B'11110000'
04BB   0505           02173         ANDWF   FSR0H,W         ;check for >bank 15
04BC   1903           02174         SKPNZ
04BD   2CB4           02175         GOTO    INITLOOP
                      02176         
04BE   20DC           02177         CALL    SETUP
04BF   0AA1           02178         INCF    FLASHER         ;set timer to 1
04C0   14A0           02179         BSF     LCALWAIT
04C1   214D           02180         CALL    INITMR1 
04C2   30C0           02181         MOVLW   INTCONset
04C3   008B           02182         MOVWF   INTCON
                      02183 
04C4   2497           02184         CALL    RESETSAVETIME
                      02185 
                      02186 ;       MOVLW   calstatus
                      02187 ;       MOVWF   EEWRADDRESS     
                      02188 ;       MOVLW   emptydone
                      02189 ;       CALL    EEWRITEW
                      02190 ;       CALL    EEREADSAME
                      02191 ;       MOVWF   CALSTATUS
                      02192 
                      02193 ;       MOVLW   OPspanH ;get op parameters ###j here (REMMING)
                      02194 ;       CALL    EEREADADRW
                      02195 ;       MOVWF   OPSPANHI
                      02196 
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 42
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02197 ;       BCF     OPREVERSE       ;extract reverse flag
                      02198 ;       BTFSC   OPSPANHI,7
                      02199 ;       BSF     OPREVERSE
                      02200         
                      02201 ;       MOVLW   B'00000011'
                      02202 ;       ANDWF   OPSPANHI        ;remove flag
                      02203         
                      02204 ;       CALL    EEREADNEXT
                      02205 ;       MOVWF   OPSPANLO
                      02206 ;       CALL    EEREADNEXT
                      02207 ;       MOVWF   OPOFFSETHI
                      02208 ;       CALL    EEREADNEXT
                      02209 ;       MOVWF   OPOFFSETLO      ;###j to here
                      02210         
04C5   21E6           02211         CALL    AVPRIME 
                      02212         
04C6   2352           02213         CALL    GETP0
04C7   23A3           02214         CALL    GETCOMPPROBE
                      02215 
                      02216 
                      02217 
                      02218 ;main ***********************************************************************
                      02219 
                      02220 
04C8   1C20           02221 IDLE    BTFSS   INTDONE
04C9   2CC8           02222         GOTO    IDLE
04CA   0064           02223         CLRWDT
04CB   1020           02224         BCF     INTDONE 
                      02225  
04CC   3023           02226         MOVLW   type    ;get op parameters
04CD   2155           02227         CALL    EEREADADRW
04CE   00F6           02228         MOVWF   TYPE
                      02229         
04CF   302A           02230         MOVLW   advanced        ;get advanced parameters ###6 HERE
04D0   2155           02231         CALL    EEREADADRW
04D1   00F7           02232         MOVWF   ADVANCED
04D2   2089           02233         CALL    COUNTTABLE
04D3   00F8           02234         MOVWF   OPTCOUNT        ;###6 TO HERE
                      02235 
04D4   20D3           02236         CALL    T2SETUP
                      02237 
04D5   12A0           02238         BCF     DRESISTIVE      ;###3 here
04D6   0876           02239         MOVFW   TYPE    ;resistive?
04D7   3978           02240         ANDLW   B'01111000'
04D8   1D03           02241         SKPZ
04D9   16A0           02242         BSF     DRESISTIVE      ;yes ###3 to here
                      02243 
04DA   3001           02244         MOVLW   calstatus
04DB   2155           02245         CALL    EEREADADRW
04DC   00F5           02246         MOVWF   CALSTATUS
                      02247 
                      02248 
04DD   1CA0           02249 LCWAITTEST      BTFSS   LCALWAIT
04DE   2CED           02250         GOTO    TESTFORHCAL
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 43
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02251 
04DF   080E           02252 TESTFORLCAL     MOVFW   PORTC           ;###USPVOP
04E0   3902           02253         ANDLW   B'00000010'             ;###USBVOP
                      02254         
04E1   1D03 2CED      02255         BNZ     TESTFORHCAL             ;if no press, goto HCAL test
04E3   08A1           02256         TSTF    FLASHER
04E4   1D03 2D71      02257         BNZ     SETUNCALOP              ;if switch pressed & LCAL not done, output uncalibrated level
04E6   2312           02258         CALL    GETLCAL
                      02259 
04E7   3000           02260         MOVLW   LOW minpwm              ;set empty level
04E8   00A3           02261         MOVWF   PWML
04E9   3000           02262         MOVLW   HIGH minpwm
04EA   00A4           02263         MOVWF   PWMH
04EB   2180           02264         CALL    PWMSET
04EC   1520           02265         BSF     LCJUSTDONE              ;avoids HCAL starting from LCAL
                      02266         
                      02267                 
04ED   10A0           02268 TESTFORHCAL     BCF     LCALWAIT        
04EE   1C75           02269         BTFSS   EMPTYCAL
04EF   2D71           02270         GOTO    SETUNCALOP              ;if LCAL not done
                      02271         
04F0   18F5           02272         BTFSC   SPANCAL
04F1   2CFF           02273         GOTO    RPTHCALTEST
                      02274 
04F2   080E           02275         MOVFW   PORTC           ;###USPVOP
04F3   3902           02276         ANDLW   B'00000010'             ;###USBVOP
                      02277 
04F4   1D03 2CFC      02278         BNZ     CLRJUSTDONE             ;if no press, clear JUSTDONE
04F6   1920           02279         BTFSC   LCJUSTDONE
04F7   2CC8           02280         GOTO    IDLE            ;goto idle if key not released
04F8   0AA2           02281         INCF    SWTIMER
04F9   1BA2           02282         BTFSC   SWTIMER,7
04FA   22A4           02283         CALL    GETSPANCAL
04FB   2D6A           02284         GOTO    SETMIN          ;maintain minimum
                      02285 
04FC   1120           02286 CLRJUSTDONE     BCF     LCJUSTDONE
04FD   01A2           02287 NOSPANCAL       CLRF    SWTIMER
04FE   2CC8           02288         GOTO    IDLE
                      02289 
04FF   080E           02290 RPTHCALTEST     MOVFW   PORTC           ;###USPVOP
0500   3902           02291         ANDLW   B'00000010'             ;###USBVOP
                      02292 
0501   1D03 2D0A      02293         BNZ     MAINCLRTMR              ;if no press, goto MAIN         
                      02294         
0503   0AA2           02295         INCF    SWTIMER
0504   1FA2           02296         BTFSS   SWTIMER,7
0505   2D71           02297         GOTO    SETUNCALOP              ;revert to uncalibrated value whilst switch is pressed
0506   1DA0           02298         BTFSS   HCJUSTDONE
0507   22A4           02299         CALL    GETSPANCAL
0508   15A0           02300         BSF     HCJUSTDONE
0509   2D0C           02301         GOTO    MAIN
                      02302         
050A   01A2           02303 MAINCLRTMR      CLRF    SWTIMER         ;clear if no press #
050B   11A0           02304         BCF     HCJUSTDONE
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 44
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

050C   10A0           02305 MAIN    BCF     LCALWAIT
050D   2094           02306         CALL    INTERVALTABLE           ;use programmed value   ###6
050E   0521           02307         ANDWF   FLASHER,W               ;###6
050F   1D03           02308         SKPZ
0510   2CC8           02309         GOTO    IDLE
0511   23A3           02310         CALL    GETCOMPPROBE
0512   1B20           02311         BTFSC   COMMSBEENON
0513   2CC8           02312         GOTO    IDLE    ;no update if comms interrupt
                      02313                         
0514   227C           02314         CALL    MT_DF_M_N_DVC
                      02315 
                      02316 ;###q   BTFSS   TWOPROBE        ;###8 HERE
                      02317 ;###q   GOTO    MAINa
                      02318 
0515   23A8           02319         CALL    TWOPROBECALC    
                      02320 
                      02321 ;###q here
                      02322 ;       GOTO    ZEROTEST        ;###8 TO HERE
                      02323 
                      02324 ;MAINa  CALL    ONEPDRIFTCALC ;drift factor in AARGB1(H) & AARGB2(L)    
                      02325 
                      02326 ;       MOVFW   P1EMPTYL        ;Current probe - empty = PROBE1x
                      02327 ;       SUBWF   TMR1HP1,W
                      02328 ;       MOVWF   PROBE1L
                      02329 ;       MOVFW   P1EMPTYH
                      02330 ;       SUBWFB  TMR1UP1,W
                      02331 ;       MOVWF   PROBE1H
                      02332 ;       SKPNC
                      02333 ;       GOTO    ONEP1CALCa
                      02334 ;       GOTO    ZEROANDEXIT     ;if -VE set to zero & #EXIT
                      02335 
                      02336 ;ONEP1CALCa     BTFSS   DRIFTNEG
                      02337 ;       GOTO    P1SUBDRIFT
                      02338 ;P1PLUSDRIFT    MOVFW   AARGB2
                      02339 ;       ADDWF   PROBE1L
                      02340 ;       MOVFW   AARGB1
                      02341 ;       ADDWFC  PROBE1H
                      02342 ;       GOTO    ZEROTEST
                      02343 
                      02344 ;P1MINUSDRIFT   MOVFW   AARGB2
                      02345 ;       SUBWF   PROBE1L
                      02346 ;       MOVFW   AARGB1
                      02347 ;       SUBWFB  PROBE1H 
                      02348 ;       SKPNC
                      02349 ;       GOTO    ZEROTEST
                      02350 
                      02351 ;ZEROANDEXIT    CLRF    PROBE1H ;if -VE set to zero
                      02352 ;       CLRF    PROBE1L         
                      02353 ;###q to here
                      02354 
0516   086D           02355 ZEROTEST        MOVFW   PROBE1L 
0517   046C           02356         IORWF   PROBE1H,W
0518   1D03           02357         SKPZ
0519   2D1E           02358         GOTO    SPANCALC
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 45
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02359 
051A   01C3           02360 SETSPANZERO     CLRF    AARGB3
051B   01C2           02361         CLRF    AARGB2
051C   21B5           02362         CALL    GETOPPARAM
051D   2D21           02363         GOTO    REVCHECK
                      02364 
051E   21B5           02365 SPANCALC        CALL    GETOPPARAM
051F   21C7           02366         CALL    CALCMAIN        ;###r was CALCULATE
0520   21D2           02367         CALL    SPANCHECK
                      02368 
0521   1BA0           02369 REVCHECK        BTFSC   OPREVERSE
0522   21DD           02370         CALL    REVERSEPWM
                      02371 
0523   084E           02372 ADDLOWOFFSET    MOVFW   OPOFFSETLO
0524   07C3           02373         ADDWF   AARGB3
0525   084D           02374         MOVFW   OPOFFSETHI
0526   3DC2           02375         ADDWFC  AARGB2
                      02376 
0527   1AA0           02377         BTFSC   DRESISTIVE
0528   2D3B           02378         GOTO    SETDRESPWM
                      02379 
0529   0842           02380         MOVFW   AARGB2
052A   00A4           02381         MOVWF   PWMH
052B   0843           02382         MOVFW   AARGB3
052C   00A3           02383         MOVWF   PWML
                      02384 
                      02385 ;GETEEMAX       CLRF    TEMPHI
                      02386 ;       MOVFW   OPSPANLO
                      02387 ;       MOVWF   TEMPLO
                      02388 ;       MOVFW   OPOFFSETLO
                      02389 ;       ADDWF   TEMPLO
                      02390 ;       SKPNC
                      02391 ;       INCF    TEMPHI
                      02392 
                      02393 ;       MOVFW   OPSPANHI
                      02394 ;       ADDWF   TEMPHI
                      02395 ;       MOVFW   OPOFFSETHI
                      02396 ;       ADDWF   TEMPHI
                      02397 
                      02398 ;MAXTEST        MOVFW   TEMPLO          ;VAR2-VAR1
                      02399 ;       SUBWF   PWML,W          ;Note that Z flag
                      02400 ;       MOVFW   TEMPHI          ;is invalid after
                      02401 ;       SKPC                    ;the subtraction.
                      02402 ;       INCFSZ  TEMPHI,W        
                      02403 ;       SUBWF   PWMH,W
                      02404 ;       SKPC
                      02405 ;       GOTO    ABSMAXTEST
                      02406 
                      02407 ;SETEEMAX       MOVFW   TEMPLO  ;set maximum
                      02408 ;       MOVWF   PWML
                      02409 ;       MOVFW   TEMPHI
                      02410 ;       MOVWF   PWMH
                      02411         
052D   0824           02412 ABSMAXTEST      MOVFW   PWMH    ;check for over 1023
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 46
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

052E   39FC           02413         ANDLW   B'11111100'
052F   1903 2D63      02414         BZ      SETPWM
0531   30FF           02415 SETABSMAX       MOVLW   0FF     ;set maximum
0532   00A3           02416         MOVWF   PWML
0533   3003           02417         MOVLW   03
0534   00A4           02418         MOVWF   PWMH
0535   2180           02419         CALL    PWMSET
0536   30FE           02420         MOVLW   0FE
0537   009B           02421         MOVWF   PR2
0538   2191           02422         CALL    CALCPERCENT     ;###4
0539   2361           02423         CALL    SENDDIAGDATA
053A   2CC8           02424         GOTO            IDLE
                      02425 
053B   08C2           02426 SETDRESPWM      TSTF    AARGB2  ;over 255?
053C   1D03           02427         SKPZ
053D   2D58           02428         GOTO    SETRESMAX       ;yes
                      02429         
053E   0843           02430         MOVFW   AARGB3
053F   39FE           02431         ANDLW   B'11111110'     ;check for 1 or 0
0540   1903           02432         SKPNZ                           ;###r was SKPNZ
0541   2D4D           02433         GOTO    SETRESMIN       ;for 1/0
                      02434 
                      02435 ;now do the calculation PWM=int(255/resistance multiplier) where resistance multiplier is
                      02436 ;in ACCb(LO/HI) and needs to be stored for later use in ACCd(LO/HI)
                      02437 
                      02438 ;###3   MOVFW   ACCbLO
                      02439 ;###3   MOVWF   ACCdLO
                      02440 ;###3   MOVWF   ACCaLO  ;for resistive div
                      02441 ;###3   MOVFW   ACCbHI
                      02442 ;###3   MOVWF   ACCdHI  ;store multiplier for later
                      02443         
                      02444 ;###3   CALL    RESISTIVEDIV    ;get PWM for CCPR1L     
                      02445 
                      02446 ;calculate PR2 = (PWM * CCPR1) -1
                      02447 
                      02448 ;###3   CALL    RESISTIVEMULT   ;(PWM * CCPR1)
                      02449 ;###3   DECF    ACCaLO  ;-1
                      02450         
                      02451 
                      02452 ;###3   MOVFW   ACCbLO
                      02453 ;###3   BANKSEL CCPR1L
                      02454 ;###3   MOVWF   CCPR1L
                      02455 ;###3   BCF     CCP1CON,4       ;PWM (1-255) in ACCbLO
                      02456 ;###3   BCF     CCP1CON,5
                      02457 ;###3   BANKSEL 0
                      02458 ;###3   MOVFW   ACCaLO
                      02459 ;###3   BANKSEL PR2
                      02460 ;###3   MOVWF   PR2
                      02461 ;###3   BANKSEL 0
                      02462 
0542   3001           02463         MOVLW   .1      ;###3 HERE
0543   0025           02464         BANKSEL CCPR1L
0544   0091           02465         MOVWF   CCPR1L
0545   1213           02466         BCF     CCP1CON,4       ;PWM (1-255) in AARGB3
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 47
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0546   1293           02467         BCF     CCP1CON,5
0547   0020           02468         BANKSEL 0
0548   0343           02469         DECF    AARGB3,W
0549   009B           02470         MOVWF   PR2     ;###3 TO HERE
054A   2191           02471         CALL    CALCPERCENT     ;###4
054B   2361           02472         CALL    SENDDIAGDATA
054C   2CC8           02473         GOTO    IDLE
                      02474 
054D   3064           02475 SETRESMIN       MOVLW   .100
054E   0025           02476         BANKSEL CCPR1L
054F   0091           02477         MOVWF   CCPR1L
0550   1213           02478         BCF     CCP1CON,4       ;PWM (1-255) in ACCbLO
0551   1293           02479         BCF     CCP1CON,5
0552   0020           02480         BANKSEL 0
0553   3063           02481         MOVLW   .99
0554   009B           02482         MOVWF   PR2
                      02483 ;       BANKSEL 0
0555   2191           02484         CALL    CALCPERCENT     ;###4
0556   2361           02485         CALL    SENDDIAGDATA
0557   2CC8           02486         GOTO    IDLE
                      02487 
0558   3001           02488 SETRESMAX       MOVLW   .1
0559   0025           02489         BANKSEL CCPR1L
055A   0091           02490         MOVWF   CCPR1L
055B   1213           02491         BCF     CCP1CON,4       ;PWM (1-255) in ACCbLO
055C   1293           02492         BCF     CCP1CON,5
055D   0020           02493         BANKSEL 0
055E   30FF           02494         MOVLW   .255    ;was 254 ###3
055F   009B           02495         MOVWF   PR2
                      02496 ;       BANKSEL 0
0560   2191           02497         CALL    CALCPERCENT     ;###4
0561   2361           02498         CALL    SENDDIAGDATA
0562   2CC8           02499         GOTO    IDLE
                      02500         
                      02501 
                      02502 
0563   2180           02503 SETPWM  CALL    PWMSET  ;normal range
0564   0020           02504         BANKSEL 0
0565   30FF           02505         MOVLW   0FF
0566   009B           02506         MOVWF   PR2
                      02507 ;       BANKSEL 0
0567   2191           02508         CALL    CALCPERCENT     ;###4
0568   2361           02509         CALL    SENDDIAGDATA
0569   2CC8           02510         GOTO            IDLE    
                      02511 
056A   1AA0           02512 SETMIN  BTFSC   DRESISTIVE
056B   2D4D           02513         GOTO    SETRESMIN       ;different minimum if resistive
056C   084E           02514         MOVFW   OPOFFSETLO      ;set minimum
056D   00A3           02515         MOVWF   PWML
056E   084D           02516         MOVFW   OPOFFSETHI
056F   00A4           02517         MOVWF   PWMH
0570   2D63           02518         GOTO    SETPWM
                      02519 
0571   3000           02520 SETUNCALOP      MOVLW   LOW uncalpwm    ;set for test
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 48
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0572   00A3           02521         MOVWF   PWML
0573   3000           02522         MOVLW   HIGH uncalpwm
0574   00A4           02523         MOVWF   PWMH
0575   2D63           02524         GOTO    SETPWM
                      02525 
                      02526                 
0576                  02527 GETRVOLTAGE                     ;voltage for resistive op
0576   0021           02528         BANKSEL ADCON0
0577   3011           02529         MOVLW   ADCON0setRV
0578   009D           02530         MOVWF   ADCON0
0579   3006           02531 ADCMAIN MOVLW   ADwait  ;delay in uSec (20MHz)
057A   00C9           02532         MOVWF   LOOPCOUNT
057B   2D7C           02533 DELAYLOOP       GOTO    ($+1)
057C   0BC9           02534         DECFSZ  LOOPCOUNT
057D   2D7B           02535         GOTO    DELAYLOOP
057E   149D           02536         BSF     ADCON0,ADGO     ;start conversion
057F   0063           02537         SLEEP           ;workaround for silicon Iss.6
0580   0000           02538         NOP
0581   1311           02539         BCF     PIE1,ADIE       ;clear interrupt
                      02540 
                      02541 ;       BTFSC   ADCON0,ADGO
                      02542 ;       GOTO    ($-1)
0582   081B           02543         MOVFW   ADRESL
0583   00FF           02544         MOVWF   TEMPLO
0584   081C           02545         MOVFW   ADRESH
0585   00FE           02546         MOVWF   TEMPHI
0586   0020           02547         BANKSEL 0
0587   0008           02548         RETURN
                      02549 
                      02550 ;init eeprom ****************************************************************
                      02551 
                      02552 ; The 12F1822 & 16F1823 have 256 bytes of non-volatile EEPROM, starting at address 0xF000
                      02553  
                      02554 
F000                  02555 DATAEE          ORG  0xF000
                      02556 
                      02557 
  000010CD            02558 simdiv  equ     .4301   ;1.05 x 4096
                      02559 
                      02560 ;       DE      0,03,0EC,0,00,00,37,06,LOW simdiv,HIGH simdiv   ;simulates programmed (LO-HI)for P1 on
                             emulator 8K
                      02561 
                      02562 ;       DE      0,03,92,0B,0A6,0A,37,06,LOW simdiv,HIGH simdiv  ;simulates programmed (LO-HI)for P2 on
                             emulator 8K
                      02563 
                      02564 ;       DE      0,3,.1,1,.2,1,.3,1,.4,1,.5,1,LOW simdiv,HIGH simdiv,.7,1
                      02565 
                      02566         IF (SETFORTEST==1)
                      02567 
                      02568         DE      0,03,75,69,0A,6E,14,09          ;EMPTY CAL
                      02569         DE      68,77,49,7B,4E,10,071,0E,5F,80,4E,10    ;SPANCAL
                      02570 
                      02571         ELSE
                      02572 
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 49
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

F000   0000 0000 0000 02573         DE      0,0,0,0,0,0,0,0,0,0
       0000 0000 0000 
       0000 0000 0000 
       0000 
F00A   0000 0000 0000 02574         DE      0,0,0,0,0,0,0,0,0,0
       0000 0000 0000 
       0000 0000 0000 
       0000 
                      02575         
                      02576         ENDIF
                      02577 
F014   0000 0000 0000 02578         DE      0,0,0,0,0,0,0,0,0,0
       0000 0000 0000 
       0000 0000 0000 
       0000 
                      02579 
F020                  02580         ORG     0xF000 + .32
                      02581 
F020   0000 0000 0000 02582         DE      0,0,0,0,0,0,0,0,0,0
       0000 0000 0000 
       0000 0000 0000 
       0000 
F02A   0000 0000 0000 02583         DE      0,0,0,0,0,0,0,0
       0000 0000 0000 
       0000 0000 
                      02584         
                      02585 ;       DE      0,0,0                   ;DATE
                      02586 ;       DE      .1                      ;TYPE - V=1, I=2, RA=4, RD1=8, RD2=16, RD3=32, RD4=64
                      02587 ;       DE      (HIGH .1000), LOW .1000         ;SPAN (add 128 to high for reverse)     
                      02588 ;       DE      HIGH .0, LOW .0         ;OFFSET MIN - 0V, 4mA
                      02589 
                      02590 ;       DE      (.128 + .75)                    ;ALARM LEVEL H (ON ABOVE 75%)
                      02591 ;       DE      .25                     ;ALARM LEVEL L (25%)    
                      02592 ;       DE      B'10010111'                     ;ADVANCED DATA BITS: 7(2probe=1), 5:4(samp.interval), 
                            0:2(count)
                      02593 
F032                  02594         ORG     0xF000 + .50
                      02595 
F032   0066 0001      02596         DE      LOW defp1df, HIGH defp1df
F034   000D 0001      02597         DE      LOW defp2df, HIGH defp2df
F036   0002           02598         DE      defaultn
                      02599 
                      02600         END
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 50
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

AARGB0                            00000040
AARGB1                            00000041
AARGB2                            00000042
AARGB3                            00000043
ABDEN                             00000000
ABDOVF                            00000007
ABSMAXTEST                        0000052D
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACKTIM                            00000007
ADCMAIN                           00000579
ADCON0                            0000009D
ADCON0set                         00000000
ADCON0setRV                       00000011
ADCON1                            0000009E
ADCON1set                         000000A0
ADCS0                             00000004
ADCS1                             00000005
ADCS2                             00000006
ADD1                              00000276
ADDEN                             00000003
ADDLOWOFFSET                      00000523
ADDM2TOTOTAL                      00000228
ADDTOTIMEp                        00000481
ADDTOTIMEt                        0000049C
ADFM                              00000007
ADFVR0                            00000000
ADFVR1                            00000001
ADGO                              00000001
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADPREF0                           00000000
ADPREF1                           00000001
ADRES                             0000009B
ADRESH                            0000009C
ADRESL                            0000009B
ADVANCED                          00000077
ADwait                            00000006
AHEN                              00000001
ALARMLEVHI                        00000052
ALARMLEVLO                        00000053
ALARMONatHI                       GENSTA1,1
ALARMOP                           PORTC,4
ALARMOPFLAG                       GENSTA1,0
AN0                               00000000
AN1                               00000001
AN2                               00000002
AN3                               00000004
AN4                               00000000
AN5                               00000001
AN6                               00000002
AN7                               00000003
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 51
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

ANSA0                             00000000
ANSA1                             00000001
ANSA2                             00000002
ANSA4                             00000004
ANSC0                             00000000
ANSC1                             00000001
ANSC2                             00000002
ANSC3                             00000003
ANSELA                            0000018C
ANSELAset                         00000000
ANSELC                            0000018E
ANSELCset                         00000001
APFCON                            0000011D
APFCON0                           0000011D
APFCONset                         00000084
AVDIVH                            0000005C
AVDIVH_OVER20                     00000029
AVDIVL                            0000005D
AVDIVL_OVER20                     00000028
AVDIVU                            0000005B
AVPRIME                           000001E6
AVREGH                            0000005F
AVREGL                            00000060
AVREGU                            0000005E
BAUDCON                           0000019F
BAUDCONset                        00000008
BCL1IE                            00000003
BCL1IF                            00000003
BF                                00000000
BOEN                              00000004
BORCON                            00000116
BORCONset                         00000000
BORRDY                            00000000
BRG16                             00000003
BRGH                              00000002
BSR                               00000008
BSR0                              00000000
BSR1                              00000001
BSR2                              00000002
BSR3                              00000003
BSR4                              00000004
BSR_SHAD                          00000FE6
C                                 00000000
C12IN0N                           00000001
C12IN1N                           00000001
C12IN2N                           00000002
C12IN3N                           00000003
C1HYS                             00000001
C1IE                              00000005
C1IF                              00000005
C1INP                             00000000
C1INTN                            00000006
C1INTP                            00000007
C1NCH0                            00000000
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 52
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

C1NCH1                            00000001
C1OE                              00000005
C1ON                              00000007
C1OUT_CM1CON0                     00000006
C1OUT_PORTA                       00000002
C1PCH0                            00000004
C1PCH1                            00000005
C1POL                             00000004
C1SP                              00000002
C1SYNC                            00000000
C2HYS                             00000001
C2IE                              00000006
C2IF                              00000006
C2INP                             00000000
C2INTN                            00000006
C2INTP                            00000007
C2NCH0                            00000000
C2NCH1                            00000001
C2OE                              00000005
C2ON                              00000007
C2OUT_CM2CON0                     00000006
C2OUT_PORTC                       00000004
C2PCH0                            00000004
C2PCH1                            00000005
C2POL                             00000004
C2SP                              00000002
C2SYNC                            00000000
CALCDIVATCAL                      000002D9
CALCMAIN                          000001C7
CALCNEWP1                         0000043B
CALCP1H                           00000055
CALCP1L                           00000056
CALCP1SPAN                        000002F6
CALCP2H                           00000057
CALCP2L                           00000058
CALCPERCENT                       00000191
CALCPERCENTa                      00000197
CALC_CURRDIV                      0000041D
CALSTATUS                         00000075
CCP1                              00000005
CCP1AS                            00000295
CCP1AS0                           00000004
CCP1AS1                           00000005
CCP1AS2                           00000006
CCP1ASE                           00000007
CCP1AScon                         00000000
CCP1CON                           00000293
CCP1CONset                        0000000C
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 53
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

CCPR1                             00000291
CCPR1H                            00000292
CCPR1L                            00000291
CDAFVR0                           00000002
CDAFVR1                           00000003
CDIVISLOW                         GENSTA1,4
CFGS                              00000006
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CHS4                              00000006
CKE                               00000006
CKP                               00000004
CK_PORTA                          00000000
CK_PORTC                          00000004
CLKIN                             00000005
CLKOUT                            00000004
CLKR                              00000004
CLKRCON                           0000039A
CLKRDC0                           00000003
CLKRDC1                           00000004
CLKRDIV0                          00000000
CLKRDIV1                          00000001
CLKRDIV2                          00000002
CLKREN                            00000007
CLKROE                            00000006
CLKRSLR                           00000005
CLRJUSTDONE                       000004FC
CLRKRCON                          00000000
CM1CON0                           00000111
CM1CON0set                        00000000
CM1CON1                           00000112
CM1CON1set                        00000000
CM2CON0                           00000113
CM2CON0set                        00000000
CM2CON1                           00000114
CM2CON1set                        00000000
CMOUT                             00000115
COMMSBEENON                       GENSTA0,6
COMMSTIMEOUT                      00000023
COMMTEST                          00000026
CONTINUE                          0000000A
CONVPWMTOSEND                     00000389
COUNTTABLE                        00000089
CPS0                              00000000
CPS1                              00000001
CPS2                              00000002
CPS3                              00000004
CPS4                              00000000
CPS5                              00000001
CPS6                              00000002
CPS7                              00000003
CPSCH0                            00000000
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 54
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

CPSCH1                            00000001
CPSCH2                            00000002
CPSCH3                            00000003
CPSCON0                           0000001E
CPSCON0set                        00000000
CPSCON1                           0000001F
CPSCON1set                        00000000
CPSON                             00000007
CPSOUT                            00000001
CPSRM                             00000006
CPSRNG0                           00000002
CPSRNG1                           00000003
CREN                              00000004
CSRC                              00000007
CSTART                            000004A8
CURRDIVH                          00000059
CURRDIVL                          0000005A
C_SHAD                            00000000
DACCON0                           00000118
DACCON0set                        00000000
DACCON1                           00000119
DACCON1set                        00000000
DACEN                             00000007
DACLPS                            00000006
DACOE                             00000005
DACOUT                            00000000
DACPSS0                           00000002
DACPSS1                           00000003
DACR0                             00000000
DACR1                             00000001
DACR2                             00000002
DACR3                             00000003
DACR4                             00000004
DATAEE                            0000F000
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC_SHAD                           00000001
DELAY                             0000003E
DELAYLOOP                         0000057B
DHEN                              00000000
DIAGNCHECK                        00000060
DIVATCAL97                        00000444
DIVATCAL97H                       0000006F
DIVATCAL97L                       0000006E
DIVATCALH                         00000027
DIVATCALL                         00000026
DIVAVERAGE                        00000437
DIVH                              00000044
DIVL                              00000045
DIVUSEDH                          0000002D
DIVUSEDL                          0000002C
DOAVERAGE                         0000020A
DOAVERAGEa                        00000211
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 55
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

DOCOMMS                           00000042
DRESISTIVE                        GENSTA0,5
DRIFTNEG                          GENSTA1,2
DT_PORTA                          00000001
DT_PORTC                          00000005
D_NOT_A                           00000005
ECCP1AS                           00000295
EEADR                             00000191
EEADRH                            00000192
EEADRL                            00000191
EECON1                            00000195
EECON1set                         00000000
EECON2                            00000196
EECON2set                         00000000
EEDAT                             00000193
EEDATH                            00000194
EEDATL                            00000193
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
EEREADADRW                        00000155
EEREADNEXT                        00000153
EEREADSAME                        00000157
EEWRADDRESS                       00000074
EEWRITEMAIN                       00000176
EEWRITEW                          00000165
EEWRITEWNEXT                      00000161
EEWRSETUP                         00000169
EMPTYCAL                          CALSTATUS,0
ENABLEINT                         INTCON,7
ENPROBE                           PORTC,3
ENREF_P2                          PORTC,2
EXTRACTAVDIV                      000001FB
EXTRACTLOOP                       00000203
F                                 00000001
FAULT                             GENSTA0,4
FERR                              00000002
FLAGS232                          00000073
FLASHER                           00000021
FLT0                              00000002
FREE                              00000004
FSR0                              00000004
FSR0H                             00000005
FSR0H_SHAD                        00000FE9
FSR0L                             00000004
FSR0L_SHAD                        00000FE8
FSR1                              00000006
FSR1H                             00000007
FSR1H_SHAD                        00000FEB
FSR1L                             00000006
FSR1L_SHAD                        00000FEA
FVRCON                            00000117
FVRCONset                         00000000
FVREN                             00000007
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 56
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

FVRRDY                            00000006
GCEN                              00000007
GENSTA0                           00000020
GENSTA1                           00000054
GETCOMPPROBE                      000003A3
GETEESTORE                        00000066
GETHIGHLEVEL                      000002A7
GETLCAL                           00000312
GETLOWLEVEL                       000002B4
GETOPPARAM                        000001B5
GETP0                             00000352
GETP1                             00000341
GETP2                             00000330
GETRVOLTAGE                       00000576
GETSPANCAL                        000002A4
GETTINGP0                         TASKFLAGS,0
GETTINGP1                         TASKFLAGS,1
GETTINGP2                         TASKFLAGS,2
GIE                               00000007
GO                                00000001
GOTADDR                           FLAGS232,2
GO_NOT_DONE                       00000001
HCJUSTDONE                        GENSTA0,3
HFIOFL                            00000003
HFIOFR                            00000004
HFIOFS                            00000000
IDLE                              000004C8
INCPOINTER                        00000259
INDF0                             00000000
INDF1                             00000001
INITLOOP                          000004B4
INITMR1                           0000014D
INNERLOOP                         0000024B
INTCON                            0000000B
INTCONset                         000000C0
INTDONE                           GENSTA0,0
INTE                              00000004
INTEDG                            00000006
INTEND                            00000084
INTENDNOFLAG                      00000087
INTERVALTABLE                     00000094
INTF                              00000001
IOCAF                             00000393
IOCAF0                            00000000
IOCAF1                            00000001
IOCAF2                            00000002
IOCAF3                            00000003
IOCAF4                            00000004
IOCAF5                            00000005
IOCAN                             00000392
IOCAN0                            00000000
IOCAN1                            00000001
IOCAN2                            00000002
IOCAN3                            00000003
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 57
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

IOCAN4                            00000004
IOCAN5                            00000005
IOCANset                          00000000
IOCAP                             00000391
IOCAP0                            00000000
IOCAP1                            00000001
IOCAP2                            00000002
IOCAP3                            00000003
IOCAP4                            00000004
IOCAP5                            00000005
IOCAPset                          00000000
IOCIE                             00000003
IOCIF                             00000000
IRCF0                             00000003
IRCF1                             00000004
IRCF2                             00000005
IRCF3                             00000006
LASTPART                          00000265
LATA                              0000010C
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA4                             00000004
LATA5                             00000005
LATC                              0000010E
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC3                             00000003
LATC4                             00000004
LATC5                             00000005
LCALWAIT                          GENSTA0,1
LCJUSTDONE                        GENSTA0,2
LCWAITTEST                        000004DD
LFIOFR                            00000001
LOOPCOUNT                         00000049
LOOPU3216A                        0000024D
LSB                               00000000
LWLO                              00000005
M12CAL                            000002BD
M12H                              0000006B
M12L                              0000006A
M1H                               00000044
M1L                               00000045
M2H                               00000046
M2L                               00000047
MAIN                              0000050C
MAINCLRTMR                        0000050A
MAININT                           00000084
MATHSTEMP                         00000048
MC1OUT                            00000000
MC2OUT                            00000001
MDBIT                             00000000
MDCARH                            0000039F
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 58
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

MDCARHset                         00000000
MDCARL                            0000039E
MDCARLset                         00000000
MDCH0                             00000000
MDCH1                             00000001
MDCH2                             00000002
MDCH3                             00000003
MDCHODIS                          00000007
MDCHPOL                           00000006
MDCHSYNC                          00000005
MDCIN1                            00000002
MDCIN2                            00000005
MDCL0                             00000000
MDCL1                             00000001
MDCL2                             00000002
MDCL3                             00000003
MDCLODIS                          00000007
MDCLPOL                           00000006
MDCLSYNC                          00000005
MDCON                             0000039C
MDCONset                          00000000
MDEN                              00000007
MDMIN                             00000003
MDMS0                             00000000
MDMS1                             00000001
MDMS2                             00000002
MDMS3                             00000003
MDMSODIS                          00000007
MDOE                              00000006
MDOPOL                            00000004
MDOUT_MDCON                       00000003
MDOUT_PORTC                       00000004
MDSLR                             00000005
MDSRC                             0000039D
MDSRCset                          00000000
MFIOFR                            00000002
MSB                               00000007
MT_DF_M_N_DVC                     0000027C
MULT16X16                         0000021E
MULT16X16LOOP                     00000224
MULTCOUNT                         0000003C
NAVCOUNT                          00000069
NOSPANCAL                         000004FD
NOTT0INT                          0000001E
NOT_BOR                           00000000
NOT_DONE                          00000001
NOT_MCLR                          00000003
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RI                            00000002
NOT_RMCLR                         00000003
NOT_SS                            00000003
NOT_T1SYNC                        00000002
NOT_TO                            00000004
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 59
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

NOT_WPUEN                         00000007
OERR                              00000001
OLOOPCOUNT                        0000004A
ONEPDRIFTCALC                     000003A8
OPALARM                           0000004F
OPOFFSETHI                        0000004D
OPOFFSETLO                        0000004E
OPREVERSE                         GENSTA0,7
OPSPANHI                          0000004B
OPSPANLO                          0000004C
OPTCOUNT                          00000078
OPTION_REG                        00000095
OPTsetPS128                       00000066
OPTsetPS16                        00000063
OPTsetPS2                         00000060
OPTsetPS32                        00000064
OPTsetPS4                         00000061
OPTsetPS512                       00000067
OPTsetPS64                        00000065
OPTsetPS8                         00000062
OPTsetT0wait                      00000060
OPalarmH                          00000028
OPalarmL                          00000029
OPminoffsetH                      00000026
OPminoffsetL                      00000027
OPspanH                           00000024
OPspanL                           00000025
OSC1                              00000005
OSC2                              00000004
OSCCON                            00000099
OSCCONset                         00000070
OSCSTAT                           0000009A
OSCTUNE                           00000098
OSFIE                             00000007
OSFIF                             00000007
OSTS                              00000005
OVER20PCCSPAN                     GENSTA1,5
P                                 00000004
P0DFH                             00000061
P0DFL                             00000062
P0DFNEGATIVE                      000003B3
P0EMPTYH                          00000064
P0EMPTYL                          00000063
P0emptyH                          00000007
P0emptyL                          00000006
P1A                               00000005
P1ADDDRIFT                        000003D0
P1B                               00000004
P1C                               00000003
P1CALC                            000003C3
P1CALCa                           000003CE
P1D                               00000002
P1DC0                             00000000
P1DC1                             00000001
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 60
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

P1DC2                             00000002
P1DC3                             00000003
P1DC4                             00000004
P1DC5                             00000005
P1DC6                             00000006
P1DFCALC                          000003BA
P1DFH                             00000066
P1DFL                             00000065
P1EMPTYH                          0000003B
P1EMPTYL                          0000003A
P1M0                              00000006
P1M1                              00000007
P1RSEN                            00000007
P1SPANATCALH                      0000002B
P1SPANATCALL                      0000002A
P1SUBDRIFT                        000003D5
P1_20PCCALC                       000003DD
P1calspanH                        0000000F
P1calspanL                        0000000E
P1dfH                             00000033
P1dfL                             00000032
P1emptyH                          00000003
P1emptyL                          00000002
P1fullH                           00000009
P1fullL                           00000008
P2ADDDRIFT                        00000404
P2CALC                            000003F7
P2CALCa                           00000402
P2DFCALC                          000003EE
P2DFCALCEND                       00000411
P2DFCANCENDa                      00000413
P2DFH                             00000068
P2DFL                             00000067
P2EMPTYH                          00000051
P2EMPTYL                          00000050
P2SUBDRIFT                        00000409
P2ZERO                            00000417
P2dfH                             00000035
P2dfL                             00000034
P2emptyH                          00000005
P2emptyL                          00000004
P2fullH                           0000000B
P2fullL                           0000000A
PCIE                              00000006
PCL                               00000002
PCLATH                            0000000A
PCLATH_SHAD                       00000FE7
PCON                              00000096
PCONset                           00000010
PEIE                              00000006
PEN                               00000002
PIE1                              00000091
PIE1set                           00000001
PIE2                              00000092
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 61
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

PIE2set                           00000000
PIR1                              00000011
PIR2                              00000012
PLLR                              00000006
PORTA                             0000000C
PORTC                             0000000E
PR2                               0000001B
PR2set                            00000000
PRIMELOOP                         000001F4
PROBE1H                           0000006C
PROBE1L                           0000006D
PROCESS232                        0000006B
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSS1AC0                           00000002
PSS1AC1                           00000003
PSS1BD0                           00000000
PSS1BD1                           00000001
PSTR1CON                          00000296
PSTR1CONset                       00000001
PWM1CON                           00000294
PWM1CONset                        00000000
PWMH                              00000024
PWML                              00000023
PWMSET                            00000180
PWMTEMP                           00000025
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RAWP1SPANCAL                      000002B5
RAWP2SPANCAL                      000002B9
RC0                               00000000
RC0_IS_HIGH                       00000009
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RCEN                              00000003
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCREG                             00000199
RCSTA                             0000019D
RCSTAset                          00000090
RD                                00000000
READ232                           FLAGS232,1
READ232DO                         0000006F
READCHECK                         00000056
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 62
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

READSTART                         0000005A
REMB0                             00000046
REMB1                             00000047
RESETSAVETIME                     00000497
REVCHECK                          00000521
REVERSEPWM                        000001DD
ROTATE1                           0000026A
ROTATE32                          00000230
ROTATE32a                         00000233
RPTHCALTEST                       000004FF
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
RXDTSEL                           00000007
RXREG                             00000071
RXTXCOUNT                         00000072
RX_PORTA                          00000001
RX_PORTC                          00000005
R_NOT_W                           00000002
S                                 00000003
SAVEFLAG                          GENSTA1,3
SAVEINDICATOR                     GENSTA1,6
SAVELCAL                          00000316
SAVELCALa                         00000327
SAVEP12FULL                       000002AA
SAVESPANEND                       00000309
SAVESPANENDa                      0000030E
SBCDE                             00000002
SBOREN                            00000007
SCIE                              00000005
SCK                               00000000
SCKP                              00000004
SCL                               00000000
SCS0                              00000000
SCS1                              00000001
SDA                               00000001
SDAHT                             00000003
SDI                               00000001
SDO1SEL                           00000006
SDOSEL                            00000006
SDO_PORTA                         00000004
SDO_PORTC                         00000002
SEN                               00000000
SENDB                             00000003
SENDDIAGDATA                      00000361
SENDEESTORE                       000000A3
SENDPARAMS                        TASKFLAGS,5
SENDPWM_PR2                       00000394
SENDTXW                           0000009D
SETABSMAX                         00000531
SETALARMOPHI                      000001AB
SETALARMOPLO                      000001B0
SETALOPFLAG                       000001A1
SETCURRDIV                        0000042F
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 63
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

SETDRESPWM                        0000053B
SETFORTEST                        00000000
SETMAXSPAN                        000001D8
SETMIN                            0000056A
SETPWM                            00000563
SETRESMAX                         00000558
SETRESMIN                         0000054D
SETSPANZERO                       0000051A
SETUNCALOP                        00000571
SETUP                             000000DC
SETUPB0                           000000DC
SETUPB1                           000000EB
SETUPB2                           00000100
SETUPB3                           00000117
SETUPB4                           0000012A
SETUPB5                           0000013B
SETUPB7                           00000146
SMP                               00000007
SP1BRG                            0000019B
SP1BRGH                           0000019C
SP1BRGL                           0000019B
SPANCAL                           CALSTATUS,1
SPANCALC                          0000051E
SPANCHECK                         000001D2
SPBRG                             0000019B
SPBRGH                            0000019C
SPBRGHset                         00000002
SPBRGL                            0000019B
SPBRGLset                         00000008
SPEN                              00000007
SPLLEN                            00000007
SRCLK0                            00000004
SRCLK1                            00000005
SRCLK2                            00000006
SRCON0                            0000011A
SRCON0set                         00000000
SRCON1                            0000011B
SRCON1set                         00000000
SREN                              00000005
SRI                               00000001
SRLEN                             00000007
SRNQ                              00000004
SRNQEN                            00000002
SRPR                              00000000
SRPS                              00000001
SRQ                               00000002
SRQEN                             00000003
SRRC1E                            00000000
SRRC2E                            00000001
SRRCKE                            00000002
SRRPE                             00000003
SRSC1E                            00000004
SRSC2E                            00000005
SRSCKE                            00000006
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 64
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

SRSPE                             00000007
SS1SEL                            00000005
SSP1ADD                           00000212
SSP1ADDset                        00000000
SSP1BUF                           00000211
SSP1CON1                          00000215
SSP1CON1set                       00000000
SSP1CON2                          00000216
SSP1CON2set                       00000000
SSP1CON3                          00000217
SSP1CON3set                       00000000
SSP1IE                            00000003
SSP1IF                            00000003
SSP1MSK                           00000213
SSP1MSKset                        00000000
SSP1STAT                          00000214
SSP1STATset                       00000000
SSPADD                            00000212
SSPBUF                            00000211
SSPCON                            00000215
SSPCON1                           00000215
SSPCON2                           00000216
SSPCON3                           00000217
SSPEN                             00000005
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPMSK                            00000213
SSPOV                             00000006
SSPSTAT                           00000214
SSSEL                             00000005
STATUS                            00000003
STATUS_SHAD                       00000FE4
STKOVF                            00000007
STKPTR                            00000FED
STKUNF                            00000006
STOREAVDIV                        00000329
STOREDIVATCAL                     000002E7
STOREM12                          000002D3
STOREP1SPAN                       00000303
STR1A                             00000000
STR1B                             00000001
STR1C                             00000002
STR1D                             00000003
STR1SYNC                          00000004
SUB1                              00000270
SWAPPROBEPINS                     00000001
SWDTEN                            00000000
SWTIMER                           00000022
SYNC                              00000004
T0CKI                             00000002
T0COUNTING                        TASKFLAGS,3
T0CS                              00000005
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 65
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T0SYNCH                           0000002A
T0WAITSTART                       TASKFLAGS,4
T0XCS                             00000000
T1CKI                             00000005
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000018
T1CONset                          00000001
T1GCON                            00000019
T1GCONset                         00000000
T1GGO                             00000003
T1GGO_NOT_DONE                    00000003
T1GPOL                            00000006
T1GSEL                            00000003
T1GSPM                            00000004
T1GSS0                            00000000
T1GSS1                            00000001
T1GTM                             00000005
T1GVAL                            00000002
T1OSCEN                           00000003
T1OSCR                            00000007
T1OSI                             00000005
T1OSO                             00000004
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             0000001C
T2CONsetPS1                       00000004
T2CONsetPS16                      00000006
T2CONsetPS4                       00000005
T2CONsetPS64                      00000007
T2OUTPS0                          00000003
T2OUTPS1                          00000004
T2OUTPS2                          00000005
T2OUTPS3                          00000006
T2SETUP                           000000D3
TASKFLAGS                         00000070
TEMPHI                            0000007E
TEMPLO                            0000007F
TEST                              0000002F
TESTFORHCAL                       000004ED
TESTFORLCAL                       000004DF
TESTFORLOWDIV                     0000045A
TESTSENDTXW                       0000009B
TIMEH                             000000A1
TIMEL                             000000A0
TIMESHIFT                         00000475
TIMEU                             000000A2
TIMEUU                            000000A3
TMR0                              00000015
TMR0CS                            00000005
TMR0IE                            00000005
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 66
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

TMR0IF                            00000002
TMR0SE                            00000004
TMR1                              00000016
TMR1CS0                           00000006
TMR1CS1                           00000007
TMR1GE                            00000007
TMR1GIE                           00000007
TMR1GIF                           00000007
TMR1H                             00000017
TMR1HP0                           00000038
TMR1HP1                           00000032
TMR1HP2                           00000035
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             00000016
TMR1LP0                           00000039
TMR1LP1                           00000033
TMR1LP2                           00000036
TMR1ON                            00000000
TMR1U                             00000030
TMR1UP0                           00000037
TMR1UP1                           00000031
TMR1UP2                           00000034
TMR2                              0000001A
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOSH                              00000FEF
TOSL                              00000FEE
TRANSFERP0                        00000359
TRANSFERP1                        0000034A
TRANSFERP2                        00000339
TRANSIFOVER20                     0000020B
TRISA                             0000008C
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISAset                          000000FE
TRISC                             0000008E
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISCset                          000000C3
TRMT                              00000001
TSEN                              00000005
TSHIFTLOOP                        0000047A
TSRNG                             00000004
TUN0                              00000000
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 67
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TUN5                              00000005
TWOPROBE                          ADVANCED,7
TWOPROBECALC                      000003A8
TX9                               00000006
TX9D                              00000000
TXBYTE                            0000003F
TXCKSEL                           00000002
TXCOUNT                           0000003D
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             0000019A
TXSTA                             0000019E
TXSTAset                          00000024
TX_PORTA                          00000000
TX_PORTC                          00000004
TYPE                              00000076
UA                                00000001
UADD3216A                         00000252
UADD3216B                         00000260
UDIV3216L                         00000239
UOK3216A                          00000253
UOK3216B                          00000261
W                                 00000000
WCOL                              00000007
WDTCON                            00000097
WDTCONset                         0000001C
WDTPS0                            00000001
WDTPS1                            00000002
WDTPS2                            00000003
WDTPS3                            00000004
WDTPS4                            00000005
WPUA                              0000020C
WPUA0                             00000000
WPUA1                             00000001
WPUA2                             00000002
WPUA3                             00000003
WPUA4                             00000004
WPUA5                             00000005
WPUAset                           00000003
WPUC                              0000020E
WPUC0                             00000000
WPUC1                             00000001
WPUC2                             00000002
WPUC3                             00000003
WPUC4                             00000004
WPUC5                             00000005
WPUCset                           00000000
WR                                00000001
WREG                              00000009
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 68
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

WREG_SHAD                         00000FE5
WREN                              00000002
WRERR                             00000003
WRITE232                          FLAGS232,0
WRITE232DO                        00000073
WRITE232DOa                       0000007C
WRITECHECK                        0000004C
WRITESTART                        00000050
WUE                               00000001
Z                                 00000002
ZEROTEST                          00000516
Z_SHAD                            00000002
_BOREN_NSLEEP                     00003DFF
_BOREN_OFF                        000039FF
_BOREN_ON                         00003FFF
_BOREN_SBODEN                     00003BFF
_BORV_HI                          00003BFF
_BORV_LO                          00003FFF
_C                                STATUS,C
_CLKOUTEN_OFF                     00003FFF
_CLKOUTEN_ON                      000037FF
_CONFIG1                          00008007
_CONFIG2                          00008008
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_OFF                           00003FFF
_CP_ON                            00003F7F
_DEVID1                           00008006
_FCMEN_OFF                        00001FFF
_FCMEN_ON                         00003FFF
_FOSC_ECH                         00003FFF
_FOSC_ECL                         00003FFD
_FOSC_ECM                         00003FFE
_FOSC_EXTRC                       00003FFB
_FOSC_HS                          00003FFA
_FOSC_INTOSC                      00003FFC
_FOSC_LP                          00003FF8
_FOSC_XT                          00003FF9
_IDLOC0                           00008000
_IDLOC1                           00008001
_IDLOC2                           00008002
_IDLOC3                           00008003
_IESO_OFF                         00002FFF
_IESO_ON                          00003FFF
_LVP_OFF                          00001FFF
_LVP_ON                           00003FFF
_MCLRE_OFF                        00003FBF
_MCLRE_ON                         00003FFF
_PLLEN_OFF                        00003EFF
_PLLEN_ON                         00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FDF
_STVREN_OFF                       00003DFF
_STVREN_ON                        00003FFF
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 69
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

SYMBOL TABLE
  LABEL                             VALUE 

_WDTE_NSLEEP                      00003FF7
_WDTE_OFF                         00003FE7
_WDTE_ON                          00003FFF
_WDTE_SWDTEN                      00003FEF
_WRT_ALL                          00003FFC
_WRT_BOOT                         00003FFE
_WRT_HALF                         00003FFD
_WRT_OFF                          00003FFF
__16F1823                         00000001
advanced                          0000002A
boo                               000F4240
caldiv12H                         0000000D
caldiv12L                         0000000C
calstatus                         00000001
const1                            0000E666
const2                            0000711F
const3                            000064D0
currdiv12H                        00000013
currdiv12L                        00000012
defaultn                          00000002
defp1df                           00000166
defp2df                           0000010D
emptydone                         00000001
enP1                              00000008
enref_P2                          00000004
lowoffset                         00000000
m12H                              00000011
m12L                              00000010
minpwm                            00000000
n_av                              00000036
onepdivH                          00000010
onepdivL                          00000000
simdiv                            000010CD
spandone                          00000003
tmr1shift                         00000004
type                              00000023
uncalpwm                          00000000


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XX--XXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM 5.87           CA0520 TLL35X ISS8T.ASM   10-20-2023  15:41:16         PAGE 70
PA240-16F1823 (c) 1/3/2011 P.R.GORTON

MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
02C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
03C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
04C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0580 : XXXXXXXX-------- ---------------- ---------------- ----------------
8000 : -------XX------- ---------------- ---------------- ----------------
F000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXX-- XXXXXXXXXXXXXXXX XXXXXXX---------

All other memory blocks unused.

Program Memory Words Used:  1416
Program Memory Words Free:   632


Errors   :     0
Warnings :     1 reported,     0 suppressed
Messages :     0 reported,   219 suppressed

